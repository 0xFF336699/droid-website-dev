{"version":3,"file":"static/chunks/pages/im/room/room-settings/permission-b9b32fec773637a2.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAwC;AAOjB;AACuD;AAC1C;AAEO;AACD;AACU;AAE7C,MAAMY,4BAA4B;QAAC,EAAEC,MAAM,EAAsB;QASlDC,8BACNA,+BACFA,+BACDA,+BACSA;IAZlB,MAAM,EAAEC,CAAC,EAAE,GAAGN,sBAAcA,CAAC;IAC7B,MAAM,CAACO,SAASC,WAAW,GAAGhB,kBAAQA,CAAC;IACvC,MAAM,CAACa,gBAAgB,GAAGJ,sCAAaA,CACnCC,oBAAQA,CAACO,YAAY,CAACC,QAAQ,EAC9B;QAACN;KAAO,EACRF,oBAAQA,CAACO,YAAY,CAACC,QAAQ,CAACN,OAAO;QAGxBC,2CACNA,qCACFA,mCACDA,kCACSA;IALlB,MAAM,CAACM,UAAUC,YAAY,GAAGpB,kBAAQA,CAAmB;QACvDqB,cAAcR,CAAAA,4CAAAA,4BAAAA,uCAAAA,+BAAAA,gBAAiBS,WAAW,cAA5BT,mDAAAA,6BAA8BQ,YAAY,cAA1CR,uDAAAA,4CAA8C;QAC5DU,QAAQV,CAAAA,sCAAAA,4BAAAA,uCAAAA,gCAAAA,gBAAiBS,WAAW,cAA5BT,oDAAAA,8BAA8BU,MAAM,cAApCV,iDAAAA,sCAAwC;QAChDW,MAAMX,CAAAA,oCAAAA,4BAAAA,uCAAAA,gCAAAA,gBAAiBS,WAAW,cAA5BT,oDAAAA,8BAA8BW,IAAI,cAAlCX,+CAAAA,oCAAsC;QAC5CY,KAAKZ,CAAAA,mCAAAA,4BAAAA,uCAAAA,gCAAAA,gBAAiBS,WAAW,cAA5BT,oDAAAA,8BAA8BY,GAAG,cAAjCZ,8CAAAA,mCAAqC;QAC1CI,cAAcJ,CAAAA,4CAAAA,4BAAAA,uCAAAA,gCAAAA,gBAAiBS,WAAW,cAA5BT,oDAAAA,8BAA8BI,YAAY,cAA1CJ,uDAAAA,4CAA8C;IAChE;IAEA,MAAMa,eAAe,OAAOC;QACxBA,EAAEC,cAAc;QAChB,IAAI;YACAZ,WAAW;YACX,MAAMV,8CAAmBA,CAACuB,qBAAqB,CAACjB,QAAQO;YACxDZ,oBAAKA,CAACuB,OAAO,CAAChB,EAAE;QACpB,EAAE,OAAOiB,OAAY;YACjBxB,oBAAKA,CAACwB,KAAK,CAACA,MAAMC,OAAO,IAAIlB,EAAE;QACnC,SAAU;YACNE,WAAW;QACf;IACJ;IAEA,MAAMiB,eAAe,CAACN;QAClB,MAAM,EAAEO,IAAI,EAAEC,KAAK,EAAE,GAAGR,EAAES,MAAM;QAChChB,YAAYiB,CAAAA,OAAS;gBACjB,GAAGA,IAAI;gBACP,CAACH,KAAK,EAAEI,OAAOH;YACnB;IACJ;IAEA,qBACI,qBAAClC,kBAAGA;QAACsC,WAAU;QAAOC,UAAUd;QAAce,IAAI;YAAE,SAAS;gBAAEC,IAAI;YAAE;QAAE;;0BACnE,oBAACtC,sBAAOA;gBAACuC,OAAO7B,EAAE;0BACd,kCAACZ,wBAASA;oBACN0C,SAAS;oBACTC,MAAK;oBACLC,OAAOhC,EAAE;oBACToB,MAAK;oBACLC,OAAOhB,SAASE,YAAY;oBAC5B0B,UAAUd;oBACVe,UAAUjC;oBACVkC,YAAY;wBACRC,YAAY;4BAAEC,KAAK;4BAAGC,KAAK;wBAAI;oBACnC;;;0BAIR,oBAAChD,sBAAOA;gBAACuC,OAAO7B,EAAE;0BACd,kCAACZ,wBAASA;oBACN0C,SAAS;oBACTC,MAAK;oBACLC,OAAOhC,EAAE;oBACToB,MAAK;oBACLC,OAAOhB,SAASI,MAAM;oBACtBwB,UAAUd;oBACVe,UAAUjC;oBACVkC,YAAY;wBACRC,YAAY;4BAAEC,KAAK;4BAAGC,KAAK;wBAAI;oBACnC;;;0BAIR,oBAAChD,sBAAOA;gBAACuC,OAAO7B,EAAE;0BACd,kCAACZ,wBAASA;oBACN0C,SAAS;oBACTC,MAAK;oBACLC,OAAOhC,EAAE;oBACToB,MAAK;oBACLC,OAAOhB,SAASK,IAAI;oBACpBuB,UAAUd;oBACVe,UAAUjC;oBACVkC,YAAY;wBACRC,YAAY;4BAAEC,KAAK;4BAAGC,KAAK;wBAAI;oBACnC;;;0BAIR,oBAAChD,sBAAOA;gBAACuC,OAAO7B,EAAE;0BACd,kCAACZ,wBAASA;oBACN0C,SAAS;oBACTC,MAAK;oBACLC,OAAOhC,EAAE;oBACToB,MAAK;oBACLC,OAAOhB,SAASM,GAAG;oBACnBsB,UAAUd;oBACVe,UAAUjC;oBACVkC,YAAY;wBACRC,YAAY;4BAAEC,KAAK;4BAAGC,KAAK;wBAAI;oBACnC;;;0BAIR,oBAAChD,sBAAOA;gBAACuC,OAAO7B,EAAE;0BACd,kCAACZ,wBAASA;oBACN0C,SAAS;oBACTC,MAAK;oBACLC,OAAOhC,EAAE;oBACToB,MAAK;oBACLC,OAAOhB,SAASF,YAAY;oBAC5B8B,UAAUd;oBACVe,UAAUjC;oBACVkC,YAAY;wBACRC,YAAY;4BAAEC,KAAK;4BAAGC,KAAK;wBAAI;oBACnC;;;0BAIR,oBAAC/C,yBAAUA;gBAACgD,SAAQ;gBAAUC,OAAM;gBAAiBb,IAAI;oBAAEc,SAAS;oBAASb,IAAI;gBAAE;0BAC9E5B,EAAE;;0BAGP,oBAACX,qBAAMA;gBACH0C,MAAK;gBACLQ,SAAQ;gBACRL,UAAUjC;0BAETD,EAAE;;;;AAInB,EAAE;;;;AC9IsC;AACN;AACS;AACS;AAC8D;AAEnG,SAAS8C;IACtB,MAAM,EAAE9C,CAAC,EAAE,GAAGN,sBAAcA,CAAC;IAC7B,MAAMqD,SAASL,yBAASA;IACxB,MAAM,EAAEM,IAAIlD,MAAM,EAAE,GAAGiD,OAAOE,KAAK;IAEnCN,mBAASA,CAAC;QACR,sBAAsB;QACtB,IAAI,CAAC7C,UAAUiD,OAAOG,OAAO,EAAE;YAC7BH,OAAOI,IAAI,CAAC;QACd;IACF,GAAG;QAACrD;QAAQiD;KAAO;IAEnBK,QAAQC,GAAG,CAAC,UAAUrD,EAAE;IACxB,qBACE,oBAAC6C,wBAAQA;kBACP,kCAACD,6BAAeA;YAACU,aAAa;gBAAEzB,OAAO7B,EAAE;gBAAkBuD,MAAM;YAAK;sBACpE,kCAAC1D,yBAAyBA;gBAACC,QAAQA;;;;AAI3C;;;;;;;;;ACzBA;AACA;AACA;AACA,eAAe,mBAAO,CAAC,KAA+D;AACtF;AACA;AACA,OAAO,KAAU,EAAE,EAId;AACL","sources":["webpack://_N_E/./src/im/components/room-settings/permission/PermissionSettingsContent.tsx","webpack://_N_E/./src/pages/im/room/room-settings/permission/index.tsx","webpack://_N_E/?d1c6"],"sourcesContent":["import React, { useState } from 'react';\r\nimport {\r\n    Box,\r\n    TextField,\r\n    Button,\r\n    Tooltip,\r\n    Typography\r\n} from '@mui/material';\r\nimport { roomSettingsService } from '@src/im/client/room/roomSettingsService';\r\nimport toast from 'react-hot-toast';\r\nimport type { IRoomSettings, IRoomPermissions } from '@src/im/client/room/types';\r\nimport { useTranslation } from '@fanfanlo';\r\nimport { useProxyWatch } from '@fanfanlo';\r\nimport { roomData } from '@src/im/client/room/data';\r\n\r\nexport const PermissionSettingsContent = ({ roomId }: { roomId: string }) => {\r\n    const { t } = useTranslation('homepage/im/components/room-settings/permission/content');\r\n    const [loading, setLoading] = useState(false);\r\n    const [currentSettings] = useProxyWatch(\r\n        roomData.roomSettings.settings,\r\n        [roomId],\r\n        roomData.roomSettings.settings[roomId]\r\n    );\r\n    const [formData, setFormData] = useState<IRoomPermissions>({\r\n        sendMessages: currentSettings?.permissions?.sendMessages ?? 0,\r\n        invite: currentSettings?.permissions?.invite ?? 50,\r\n        kick: currentSettings?.permissions?.kick ?? 50,\r\n        ban: currentSettings?.permissions?.ban ?? 50,\r\n        roomSettings: currentSettings?.permissions?.roomSettings ?? 50,\r\n    });\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        try {\r\n            setLoading(true);\r\n            await roomSettingsService.updateRoomPermissions(roomId, formData);\r\n            toast.success(t('PermissionSettingsContent.toast.success'));\r\n        } catch (error: any) {\r\n            toast.error(error.message || t('PermissionSettingsContent.toast.error'));\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const { name, value } = e.target;\r\n        setFormData(prev => ({\r\n            ...prev,\r\n            [name]: Number(value)\r\n        }));\r\n    };\r\n\r\n    return (\r\n        <Box component=\"form\" onSubmit={handleSubmit} sx={{ '& > *': { mb: 2 } }}>\r\n            <Tooltip title={t('PermissionSettingsContent.form.sendMessages.tooltip')}>\r\n                <TextField\r\n                    fullWidth\r\n                    type=\"number\"\r\n                    label={t('PermissionSettingsContent.form.sendMessages.label')}\r\n                    name=\"sendMessages\"\r\n                    value={formData.sendMessages}\r\n                    onChange={handleChange}\r\n                    disabled={loading}\r\n                    InputProps={{\r\n                        inputProps: { min: 0, max: 100 }\r\n                    }}\r\n                />\r\n            </Tooltip>\r\n\r\n            <Tooltip title={t('PermissionSettingsContent.form.invite.tooltip')}>\r\n                <TextField\r\n                    fullWidth\r\n                    type=\"number\"\r\n                    label={t('PermissionSettingsContent.form.invite.label')}\r\n                    name=\"invite\"\r\n                    value={formData.invite}\r\n                    onChange={handleChange}\r\n                    disabled={loading}\r\n                    InputProps={{\r\n                        inputProps: { min: 0, max: 100 }\r\n                    }}\r\n                />\r\n            </Tooltip>\r\n\r\n            <Tooltip title={t('PermissionSettingsContent.form.kick.tooltip')}>\r\n                <TextField\r\n                    fullWidth\r\n                    type=\"number\"\r\n                    label={t('PermissionSettingsContent.form.kick.label')}\r\n                    name=\"kick\"\r\n                    value={formData.kick}\r\n                    onChange={handleChange}\r\n                    disabled={loading}\r\n                    InputProps={{\r\n                        inputProps: { min: 0, max: 100 }\r\n                    }}\r\n                />\r\n            </Tooltip>\r\n\r\n            <Tooltip title={t('PermissionSettingsContent.form.ban.tooltip')}>\r\n                <TextField\r\n                    fullWidth\r\n                    type=\"number\"\r\n                    label={t('PermissionSettingsContent.form.ban.label')}\r\n                    name=\"ban\"\r\n                    value={formData.ban}\r\n                    onChange={handleChange}\r\n                    disabled={loading}\r\n                    InputProps={{\r\n                        inputProps: { min: 0, max: 100 }\r\n                    }}\r\n                />\r\n            </Tooltip>\r\n\r\n            <Tooltip title={t('PermissionSettingsContent.form.roomSettings.tooltip')}>\r\n                <TextField\r\n                    fullWidth\r\n                    type=\"number\"\r\n                    label={t('PermissionSettingsContent.form.roomSettings.label')}\r\n                    name=\"roomSettings\"\r\n                    value={formData.roomSettings}\r\n                    onChange={handleChange}\r\n                    disabled={loading}\r\n                    InputProps={{\r\n                        inputProps: { min: 0, max: 100 }\r\n                    }}\r\n                />\r\n            </Tooltip>\r\n\r\n            <Typography variant=\"caption\" color=\"text.secondary\" sx={{ display: 'block', mb: 2 }}>\r\n                {t('PermissionSettingsContent.description')}\r\n            </Typography>\r\n\r\n            <Button\r\n                type=\"submit\"\r\n                variant=\"contained\"\r\n                disabled={loading}\r\n            >\r\n                {t('PermissionSettingsContent.form.submit')}\r\n            </Button>\r\n        </Box>\r\n    );\r\n}; ","import { useRouter } from 'next/router';\r\nimport { useEffect } from 'react';\r\nimport { useTranslation } from \"@fanfanlo\";\r\nimport { AppbarContainer, AppShell } from \"@app/ui\";\r\nimport { PermissionSettingsContent } from '@src/im/components/room-settings/permission/PermissionSettingsContent';\r\n\r\nexport default function PermissionSettingsPage() {\r\n  const { t } = useTranslation(\"homepage/pages/im/room/room-settings/permission/content\");\r\n  const router = useRouter();\r\n  const { id: roomId } = router.query;\r\n\r\n  useEffect(() => {\r\n    // 如果没有roomId，重定向到聊天列表\r\n    if (!roomId && router.isReady) {\r\n      router.push('/im');\r\n    }\r\n  }, [roomId, router]);\r\n\r\n  console.log('title=', t(\"content.title\"))\r\n  return (\r\n    <AppShell>\r\n      <AppbarContainer appbarProps={{ title: t(\"content.title\"), back: true }}>\r\n        <PermissionSettingsContent roomId={roomId as string} />\r\n      </AppbarContainer>\r\n    </AppShell>\r\n  );\r\n} ","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/im/room/room-settings/permission\",\n      function () {\n        return require(\"private-next-pages/im/room/room-settings/permission/index.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/im/room/room-settings/permission\"])\n      });\n    }\n  "],"names":["React","useState","Box","TextField","Button","Tooltip","Typography","roomSettingsService","toast","useTranslation","useProxyWatch","roomData","PermissionSettingsContent","roomId","currentSettings","t","loading","setLoading","roomSettings","settings","formData","setFormData","sendMessages","permissions","invite","kick","ban","handleSubmit","e","preventDefault","updateRoomPermissions","success","error","message","handleChange","name","value","target","prev","Number","component","onSubmit","sx","mb","title","fullWidth","type","label","onChange","disabled","InputProps","inputProps","min","max","variant","color","display","useRouter","useEffect","AppbarContainer","AppShell","PermissionSettingsPage","router","id","query","isReady","push","console","log","appbarProps","back"],"sourceRoot":"","ignoreList":[]}