{"version":3,"file":"static/chunks/pages/im/room-026dc406f359188c.js","mappings":"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","sources":["webpack://_N_E/../../../src/watcher/useWatchUpdates.tsx","webpack://_N_E/../../node_modules/.pnpm/react-i18next@15.1.4_i18next@24.1.0_typescript@5.8.2__react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/react-i18next/dist/es/index.js","webpack://_N_E/../../../../src/components/app/AppShell.tsx","webpack://_N_E/../../../../src/components/page/PageContent.tsx","webpack://_N_E/../../../../src/components/page/AndroidPageContent.tsx","webpack://_N_E/?768c","webpack://_N_E/../../../src/mc/static-model.ts","webpack://_N_E/../../../../src/components/motion/page-transition.tsx","webpack://_N_E/../../../../src/components/app/PageShell.tsx","webpack://_N_E/../../../../src/components/appbar/AppBar.tsx","webpack://_N_E/./src/im/components/room/RoomHeader.tsx","webpack://_N_E/./src/im/components/messages/text/TextMessage.tsx","webpack://_N_E/./src/im/components/messages/location/LocationMessage.tsx","webpack://_N_E/./src/im/client/message/types.ts","webpack://_N_E/./src/im/components/messages/MessageRenderer.tsx","webpack://_N_E/./src/im/components/room/MessageList.tsx","webpack://_N_E/./src/im/client/message/handlers/location.ts","webpack://_N_E/../../../src/map/MapView.tsx","webpack://_N_E/./src/im/components/messages/location/LocationPicker.tsx","webpack://_N_E/./src/im/components/room/MessageInput.tsx","webpack://_N_E/./src/im/components/room/RoomMembers.tsx","webpack://_N_E/./src/im/components/room/RoomContent.tsx","webpack://_N_E/./src/im/components/room/index.ts","webpack://_N_E/./src/pages/im/room/index.tsx"],"sourcesContent":["import _ from \"lodash\"\r\nimport { useEffect, useState } from \"react\"\r\nimport { IWatchUpdatesConfig, watchUpdates } from \"./watchUpdates\"\r\nimport { PropertiesChain, toProxy } from \"./proxyWatch\"\r\nimport { useProxyWatch } from \"./useProxyWatch\"\r\nimport { objectCountUtils } from \"../utils\"\r\nimport { useWatch } from \"./UseWatch\"\r\nimport { Log } from \"../log\"\r\n\r\n/**\r\n * \r\n * 注意，返回的无论是object还是array，都无法监听，因为它们不是proxy，而是原始对象的副本\r\n * @param target 要监听的对象\r\n * @param conf 监听配置\r\n * @returns 监听的对象\r\n */\r\nexport function useWatchUpdates<T extends object>(target: T, conf?: IWatchUpdatesConfig<T>): [T] {\r\n    const [value, setValue] = useState<T>(target)\r\n    useEffect(() => {\r\n        console.log('use watch updates look look id', objectCountUtils.getObjectCount(target))\r\n        watchUpdates(target, (info) => {\r\n            console.log('uuuuuuuuuupdated', info)\r\n            console.log('tttttttarget=', target);\r\n            const now = _.isArray(info.target) ? [...info.target] : info.target\r\n            // setValue(now as T)\r\n            setValue((_.isArray(target) ? [...target] : { ...target }) as T)\r\n        }, conf)\r\n    }, [])\r\n    return [value as T]\r\n}\r\n\r\n/**\r\n * useProxyWatch + useWatchUpdates 结合体\r\n * 因为react的刷新机制，所以第二个state必须得用setState才会生效。\r\n * 不然其实这是两行代码，第一行是useProxyWatch，第二行是useWatchUpdates就可以了。\r\n * @param target 要监听的对象\r\n * @param propertyChain 要监听的属性链\r\n * @param defaultValue 默认值\r\n * @param conf 监听配置\r\n * @returns 监听的对象 返回的第一个参数是重新拼装的{...arr} or {...obj}，第二个参数是原始的target or defaultValue\r\n */\r\nexport function useProxyWatchUpdates<T extends object, U extends object>(target: T,\r\n    propertyChain: PropertiesChain<T>,\r\n    defaultValue: U,\r\n    conf?: IWatchUpdatesConfig<U>): [U, U] {\r\n        const logger = new Log(false, 'useProxyWatchUpdates_fn');\r\n        logger.pause = true;\r\n    const [v] = useProxyWatch(target, propertyChain, defaultValue)\r\n    const [value, setValue] = useState<U>(v);\r\n    logger.log(`propertyChain=`, propertyChain);\r\n    logger.log(`value=`, value);\r\n    logger.log('v=', v);\r\n    logger.log('defaultValue=', defaultValue)\r\n    useEffect(() => {\r\n        logger.log(`useEffect_fn v=`, v)\r\n        const newValue = _.isArray(v)\r\n            ? [...v]\r\n            : Object.assign({}, v);\r\n\r\n        setValue(newValue as U);\r\n        return watchUpdates(v, (info) => {\r\n            logger.log('watchUpdates_fn', 'info=', info)\r\n            // setValue((_.isArray(v) ? [...v ] : {...v}) as U)\r\n            // 使用 Object.assign 来避免循环引用\r\n            const newValue = _.isArray(v)\r\n                ? [...v]\r\n                : Object.assign({}, v);\r\n\r\n            setValue(newValue as U);\r\n        }, conf)\r\n    }, [v])\r\n    return [value, v]\r\n}\r\n\r\n","export * from \"C:\\\\work\\\\android-droid\\\\html\\\\website-2024-12\\\\node_modules\\\\.pnpm\\\\react-i18next@15.1.4_i18next@24.1.0_typescript@5.8.2__react-dom@19.0.0_react@19.0.0__react@19.0.0\\\\node_modules\\\\react-i18next\\\\dist\\\\es\\\\index.js\"","'use client'\r\nimport { i18n, i18nInit, IPageScrollPosition, StorePageContext, StorePageDynamicContext, toProxy, watchUpdates, storeUtils } from \"@fanfanlo\";\r\nimport { useRouter } from \"next/router\";\r\nimport { PropsWithChildren, useEffect } from \"react\";\r\nimport { I18nextProvider } from \"react-i18next\";\r\n\r\n\r\ni18nInit()\r\n\r\nexport function AppShell({ children }: PropsWithChildren) {\r\n  const router = useRouter();\r\n  const scrollKey = 'scrollPositionInfo'\r\n  const href = window.location.href.split(\"#\")[0]\r\n  const dynamicKey = `dynamic-${href}`\r\n  const s = storeUtils.namespace(dynamicKey);\r\n  let o: Record<string, unknown>|undefined = s.read(dynamicKey)\r\n  if (!o) {\r\n    o = {}\r\n    s.write(dynamicKey, o)\r\n  }\r\n  o = toProxy(o)\r\n  useEffect(() => {\r\n\r\n    router.beforePopState((state) => {\r\n      s.clearAll()\r\n      return true\r\n    })\r\n  })\r\n  useEffect(() => {\r\n    s.write(dynamicKey, o)\r\n    return watchUpdates(o, () => {\r\n      s.write(dynamicKey, o)\r\n    })\r\n  }, [])\r\n  useEffect(() => {\r\n    const info = (s.read(scrollKey) || { x: 0, y: 0 }) as IPageScrollPosition\r\n    // console.log('app shell scroll info info = ', info)\r\n    if (info.x == 0 && info.y == 0) {\r\n      listenScroll()\r\n    } else {\r\n      window.requestAnimationFrame(() => {\r\n        window.scrollTo(info.x, info.y)\r\n        listenScroll()\r\n      })\r\n    }\r\n    function onScroll(e: Event) {\r\n      // console.log('app shell on scroll', { x: window.scrollX, y: window.scrollY })\r\n      s.write(scrollKey, { x: window.scrollX, y: window.scrollY })\r\n    }\r\n    function listenScroll() {\r\n      window.addEventListener('scroll', onScroll)\r\n    }\r\n\r\n    function unsub() {\r\n      window.removeEventListener('scroll', onScroll)\r\n    }\r\n    return unsub\r\n  });\r\n  return (\r\n    <StorePageContext value={s}>\r\n      <StorePageDynamicContext value={o}>\r\n\r\n        <I18nextProvider i18n={i18n}>\r\n          {children}\r\n        </I18nextProvider>\r\n      </StorePageDynamicContext>\r\n    </StorePageContext>\r\n  )\r\n}","import { Box, Button, Container } from '@mui/material';\r\nimport { createContext, PropsWithChildren, useContext, useEffect } from 'react';\r\nimport { ITitleI18nConf, ITitleI18nNsConf, ITitleI18nTitleConf } from '.';\r\nimport { isBuild, isDev, isServer, loadI18nValue, publicRuntimeConfig } from '@fanfanlo';\r\nimport { read } from 'fs';\r\nimport { useTranslation } from '@fanfanlo';\r\n\r\n\r\nfunction Reload(){\r\n  if(!isDev)return <>  </>\r\n  const {t} = useTranslation(\"app-ui/components/page/content\")\r\n  return(\r\n    <Box>\r\n      <Button onClick={() => {window.location.reload()}}>{t(\"PageContent.refresh\")}</Button>\r\n      {new Date().toLocaleString()}\r\n    </Box>\r\n  )\r\n}\r\n\r\nconst ScrollP = createContext({ x: 0, y: 0 });\r\nlet index = 0;\r\nexport default function PageContent({ children, titleConf, reload }: {titleConf?:ITitleI18nConf, reload?: boolean} & PropsWithChildren) {\r\n  index++;\r\n  const scroll = useContext(ScrollP);\r\n  const clazz = `${Date.now() + Math.random() * Date.now()}`;\r\n  useEffect(()=>{\r\n    async function loadTitle(){\r\n      if(!titleConf)return\r\n      let title = titleConf.title\r\n      if(titleConf.ns){\r\n        title = await loadI18nValue(titleConf.ns, titleConf.key || \"content.title\")\r\n      }\r\n      if(!title)return\r\n      document.title = title\r\n    }\r\n    loadTitle()\r\n  }, [])\r\n  useEffect(() => {\r\n    const container = document.getElementsByClassName(clazz)[0];\r\n    if (!container) return;\r\n    container.scrollTop = scroll.y;\r\n    const onScroll = () => {\r\n      var scrollTop = container.scrollTop;\r\n      scroll.y = scrollTop;\r\n    };\r\n    container.removeEventListener('scroll', onScroll);\r\n    container.addEventListener('scroll', onScroll, { passive: true });\r\n    return () => container.removeEventListener('scroll', onScroll);\r\n  }, [clazz, scroll]);\r\n  return (\r\n\r\n    <Container className={clazz} sx={{ flexGrow: 1, overflow: 'auto', padding: \"0px\" }}>\r\n      <Box>\r\n        {(reload || (reload == undefined)) && <Reload />}\r\n        {children}\r\n      </Box>\r\n    </Container>\r\n  );\r\n}\r\n","import { PropsWithChildren } from \"react\";\r\nimport PageContent from \"./PageContent\";\r\nimport { ITitleI18nConf } from \".\";\r\nexport default function AndroidPageContent({ children, titleConf, reload }: {titleConf?:ITitleI18nConf, reload?: boolean} & PropsWithChildren)  {\r\n    return (\r\n        <PageContent titleConf={titleConf} reload={reload}>\r\n            {children}\r\n        </PageContent>\r\n    )\r\n}\r\n","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/im/room\",\n      function () {\n        return require(\"private-next-pages/im/room/index.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/im/room\"])\n      });\n    }\n  ","import { Dispatcher } from \"@fanfanlo\"\r\nimport { DispatcherUnsubscribe } from \"@fanfanlo\"\r\n\r\nconst dipsatcher = new Dispatcher()\r\ninterface IStaticModel{\r\n    dipsatcher:Dispatcher\r\n    screenLockCount:number\r\n    switchPage:()=>void\r\n    listenSwitchPage:(callback:()=>void)=>DispatcherUnsubscribe \r\n}\r\nexport const staticModel:IStaticModel = {\r\n    dipsatcher,\r\n    screenLockCount:0,\r\n    switchPage:async()=>{\r\n        dipsatcher.dispatch(\"switchPage\")\r\n        staticModel.screenLockCount = 0\r\n    },\r\n    listenSwitchPage:(callback:()=>void)=>{\r\n        return dipsatcher.addListener(\"switchPage\",callback)\r\n    }\r\n}   \r\n","import { PropsWithChildren } from \"react\";\r\nimport { AnimatePresence, motion } from \"framer-motion\";\r\nimport { useRouter } from \"next/router\";\r\n\r\n\r\nexport function PageTransition({ children }: PropsWithChildren) {\r\n    const router = useRouter()\r\n    return (\r\n\r\n        <AnimatePresence mode=\"sync\">\r\n            <motion.div\r\n                key={router.route}\r\n                initial={{ opacity: 0, y: 10 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                exit={{ opacity: 0, y: -110 }}\r\n                transition={{ duration: 0.3 }}\r\n            >\r\n                {children}\r\n            </motion.div>\r\n        </AnimatePresence>\r\n    )\r\n}","import { staticModel } from \"@app/static\";\r\nimport { Box } from \"@mui/material\";\r\nimport { useEffect } from \"react\";\r\nimport { PageTransition } from \"../motion\";\r\nlet idCount = 0\r\nexport function PageShell({children}:{children:React.ReactNode}){\r\n    const id = `app-shell-${idCount++}`\r\n    useEffect(()=>{\r\n        const box = document.querySelector(`#${id}`)\r\n        const unlisten = staticModel.listenSwitchPage(()=>{\r\n            if(!box)return\r\n        })\r\n        if(!box)return\r\n        box.addEventListener(\"click\",(e)=>{\r\n            if(staticModel.screenLockCount == 0)return\r\n            e.stopPropagation()\r\n            e.preventDefault()\r\n        })\r\n        return ()=>{\r\n            unlisten()\r\n        }\r\n    },[])\r\n    return (\r\n        <Box id={id}>\r\n            <PageTransition>\r\n                {children}  \r\n            </PageTransition>\r\n        </Box>\r\n    )\r\n}\r\n","import { AppBar, Box, Container, CssBaseline, Fab, Fade, Slide, Toolbar, Typography, useScrollTrigger } from \"@mui/material\";\r\nimport { PropsWithChildren, ReactNode } from \"react\";\r\n// import {AndroidPageContent} from \"../../\";\r\nimport { browserHistoryUtils, IDispatcher } from \"@fanfanlo\";\r\nimport KeyboardArrowLeft from '@mui/icons-material/KeyboardArrowLeft';\r\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\r\nimport * as React from \"react\";\r\nimport { useRouter } from \"next/router\";\r\nimport { PageShell } from \"../app/PageShell\";\r\nimport shadows from \"@mui/material/styles/shadows\";\r\nimport AndroidPageContent from \"../page/AndroidPageContent\";\r\nimport { IAppBarBackAskEvent } from \"@app/static\";\r\nimport { ITitleI18nConf } from \"../page\";\r\ninterface Props {\r\n    /**\r\n     * Injected by the documentation to work in an iframe.\r\n     * You won't need it on your project.\r\n     */\r\n    window?: () => Window;\r\n    children?: React.ReactElement<unknown>;\r\n}\r\n\r\nfunction HideOnScroll(props: Props) {\r\n    const { children, window } = props;\r\n    // Note that you normally won't need to set the window ref as useScrollTrigger\r\n    // will default to window.\r\n    // This is only being set here because the demo is in an iframe.\r\n    const trigger = useScrollTrigger({\r\n        target: window ? window() : undefined,\r\n    });\r\n\r\n    return (\r\n        <Slide appear={false} direction=\"down\" in={!trigger}>\r\n            {children ?? <div />}\r\n        </Slide>\r\n    );\r\n}\r\nexport interface IAppbarProps extends PropsWithChildren {\r\n    title: ReactNode\r\n    back: boolean\r\n    backHandler?: () => boolean\r\n    backDispatcher?:IDispatcher\r\n}\r\nexport function Appbar({ title }: { title: ReactNode } & PropsWithChildren) {\r\n    return (\r\n\r\n        <AppBar color={\"inherit\"}>\r\n            <Toolbar>\r\n                <Typography variant=\"h6\" component=\"div\">\r\n                    {title}\r\n                </Typography>\r\n            </Toolbar>\r\n        </AppBar>\r\n    )\r\n}\r\n\r\ninterface IAppbarContainerProps extends PropsWithChildren {\r\n    appbarProps: IAppbarProps\r\n    titleConf?:ITitleI18nConf\r\n    reload?: boolean\r\n}\r\n\r\n// export interface IAppBarBackAskEvent{\r\n//     defaultPrevented:boolean\r\n// }\r\n\r\nfunction ScrollTop(props: Props) {\r\n    const { children, window } = props;\r\n    // Note that you normally won't need to set the window ref as useScrollTrigger\r\n    // will default to window.\r\n    // This is only being set here because the demo is in an iframe.\r\n    const trigger = useScrollTrigger({\r\n        target: window ? window() : undefined,\r\n        disableHysteresis: true,\r\n        threshold: 100,\r\n    });\r\n\r\n    const handleClick = (event: React.MouseEvent<HTMLDivElement>) => {\r\n        const anchor = (\r\n            (event.target as HTMLDivElement).ownerDocument || document\r\n        ).querySelector('#back-to-top-anchor');\r\n\r\n        if (anchor) {\r\n            anchor.scrollIntoView({\r\n                block: 'center',\r\n            });\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Fade in={trigger}>\r\n            <Box data-id=\"content-scroll-top-button\"\r\n                onClick={handleClick}\r\n                role=\"presentation\"\r\n                sx={{ position: 'fixed', bottom: 16, right: 16 }}\r\n            >\r\n                {children}\r\n            </Box>\r\n        </Fade>\r\n    );\r\n}\r\nexport function AppbarContainer(props: IAppbarContainerProps) {\r\n    const { children, appbarProps, titleConf, reload } = props;\r\n    const router = useRouter()\r\n    function handleBack(){\r\n        // 本想抽象成底层一个方法，但是考虑了一下router需要注入或者是一个callback，似乎像现在这样判断一下event也可以。回头继续观察一下吧。\r\n        const event = browserHistoryUtils.askHistoryBack()\r\n        if(event.defaultPrevented)return\r\n        if(appbarProps.backDispatcher){\r\n            const e:IAppBarBackAskEvent = {defaultPrevented:false}\r\n            appbarProps.backDispatcher.dispatch('back',e)\r\n            if(e.defaultPrevented)return\r\n        }\r\n        router.back()\r\n    }\r\n    return (\r\n        <PageShell>\r\n        <React.Fragment>\r\n            <CssBaseline />\r\n            <HideOnScroll {...props}>\r\n                <AppBar color=\"inherit\">\r\n                    <Toolbar>\r\n                        <KeyboardArrowLeft onClick={handleBack} />\r\n                        {appbarProps.title}\r\n                    </Toolbar>\r\n                </AppBar>\r\n            </HideOnScroll>\r\n            <Toolbar id=\"back-to-top-anchor\" />\r\n            <Container sx={{padding:\"0\", marginTop:\"17px\"}}>\r\n                <AndroidPageContent titleConf={titleConf} reload={reload}>\r\n                    {children}\r\n                </AndroidPageContent>\r\n            </Container>\r\n\r\n            <ScrollTop {...props}>\r\n                <Fab size=\"small\" aria-label=\"scroll back to top\">\r\n                    <KeyboardArrowUpIcon />\r\n                </Fab>\r\n            </ScrollTop>\r\n        </React.Fragment>\r\n        </PageShell>\r\n    );\r\n}\r\n","import { AppBar, Toolbar, IconButton, Typography, Avatar, Box } from '@mui/material';\nimport MenuIcon from '@mui/icons-material/Menu';\nimport PeopleIcon from '@mui/icons-material/People';\nimport { useTranslation } from '@fanfanlo';\nimport { useProxyWatch } from '@fanfanlo';\nimport { matrixRoom } from '../../client/room';\n\nexport interface RoomHeaderProps {\n  roomId: string;\n  showMembers: boolean;\n  onToggleMembers: () => void;\n}\n\nexport function RoomHeader({ roomId, showMembers, onToggleMembers }: RoomHeaderProps) {\n  const { t } = useTranslation('homepage/im/components/room/content');\n  const [roomInfo] = useProxyWatch(\n    matrixRoom.roomData,\n    'joinedRooms',\n    matrixRoom.roomData.joinedRooms.find(r => r.roomId === roomId)\n  );\n\n  return (\n    <AppBar position=\"static\" color=\"default\" elevation={1}>\n      <Toolbar>\n        <IconButton\n          size=\"large\"\n          edge=\"start\"\n          color=\"inherit\"\n          aria-label=\"menu\"\n          sx={{ mr: 2 }}\n          onClick={onToggleMembers}\n        >\n          <MenuIcon />\n        </IconButton>\n        <Box sx={{ mr: 2 }}>\n          <Avatar src={roomInfo?.avatarUrl}>\n            {roomInfo?.name?.charAt(0) || 'R'}\n          </Avatar>\n        </Box>\n        <Typography variant=\"h6\" component=\"div\" sx={{ flexGrow: 1 }}>\n          {roomInfo?.name || t('RoomContent.unnamedRoom')}\n        </Typography>\n        <IconButton\n          color={showMembers ? 'primary' : 'default'}\n          onClick={onToggleMembers}\n          title={t('RoomContent.toggleMembers')}\n        >\n          <PeopleIcon />\n        </IconButton>\n      </Toolbar>\n    </AppBar>\n  );\n}\n","import React from 'react';\nimport { ITextMessage } from '../../../client/message/types';\nimport { Box, Typography } from '@mui/material';\n\ninterface TextMessageProps {\n  message: ITextMessage;\n  className?: string;\n}\n\nexport const TextMessage = ({ message, className = '' }: TextMessageProps) => {\n  return (\n    <Box className={`text-message ${className}`}>\n      <Typography variant=\"body1\">\n        {message.content.body}\n      </Typography>\n    </Box>\n  );\n}\n","import React from 'react';\nimport { ILocationMessage } from '../../../client/message/types';\nimport { Box, Typography, Button, Dialog, DialogTitle, DialogContent, DialogActions } from '@mui/material';\nimport { useTranslation } from '@fanfanlo';\n\n\ninterface LocationMessageProps {\n  message: ILocationMessage;\n  className?: string;\n}\n\nexport const LocationMessage = ({ message, className = '' }: LocationMessageProps) => {\n  const { t } = useTranslation();\n  // 从 geo_uri 中解析经纬度\n  const geoUri = message.content.geo_uri;\n  const [_, coordinates] = geoUri.split(':');\n  const [latitude, longitude] = coordinates.split(',').map(Number);\n  \n  // 构建静态地图 URL（使用百度地图）\n  const mapUrl = `https://api.map.baidu.com/staticimage/v2?ak=${process.env.REACT_APP_BAIDU_MAP_KEY || 'MmweUMZxcXOThZUaBuQ2rtKwLNHf1Hix'}&center=${longitude},${latitude}&zoom=12&width=300&height=200&markers=${longitude},${latitude}&markerStyles=m,B,0`;\n  \n  // 处理点击事件，打开交互式地图\n  const [open, setOpen] = React.useState(false);\n  const handleOpenMap = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n  \n  return (\n    <Box className={`location-message ${className}`}>\n      <Box className=\"map-container\" mb={1}>\n        <img \n          src={mapUrl} \n          alt={message.content.info?.title || t('location.title')} \n          onClick={handleOpenMap}\n          style={{ cursor: 'pointer' }}\n        />\n      </Box>\n      <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\">\n        <Typography variant=\"body2\" color=\"textSecondary\">\n          {message.content.info?.title || t('location.title')}\n        </Typography>\n        <Button \n          variant=\"text\" \n          size=\"small\" \n          onClick={handleOpenMap}\n        >\n          {t('location.viewMap')}\n        </Button>\n      </Box>\n      {open && (\n        <Dialog open={open} onClose={handleClose} maxWidth=\"sm\" fullWidth>\n          <DialogTitle>{message.content.info?.title || t('location.title')}</DialogTitle>\n          <DialogContent>\n            <InteractiveLocationMap message={message} />\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={handleClose} color=\"primary\">\n              {t('common.close')}\n            </Button>\n          </DialogActions>\n        </Dialog>\n      )}\n    </Box>\n  );\n};\n\n// 在需要显示交互式地图的地方使用\nconst InteractiveLocationMap = React.forwardRef(({ message }: { message: ILocationMessage }, ref) => {\n  const [_, coordinates] = message.content.geo_uri.split(':');\n  const [latitude, longitude] = coordinates.split(',').map(Number);\n  \n  return (\n    <Box sx={{\n      width: '100%',\n      height: 400,\n      minHeight: 300,\n      position: 'relative'\n    }}>\n     \n    </Box>\n  );\n});\n\nexport default LocationMessage;\n","/**\n * Matrix 消息类型定义\n * 包含所有与 Matrix 协议相关的消息类型定义和工具函数\n */\n\n/**\n * 基础事件接口\n */\nexport interface IMatrixEventBase {\n  /** 事件ID，消息的唯一标识符 */\n  event_id: string;\n  \n  /** 发送者的用户ID，格式为 @user:domain */\n  sender: string;\n  \n  /** 服务器接收到消息的时间戳（毫秒） */\n  origin_server_ts: number;\n  \n  /** 事件类型，如 'm.room.message' */\n  type: string;\n  \n  /** 消息内容 */\n  content: Record<string, any>;\n  \n  /** 未签名数据，包含额外的元数据 */\n  unsigned?: {\n    /** 消息年龄（毫秒） */\n    age?: number;\n    /** 事务ID，用于去重 */\n    transaction_id?: string;\n    /** 被替换的消息ID，用于消息编辑 */\n    replaces_event_id?: string;\n  };\n  \n  /** 房间ID */\n  room_id?: string;\n}\n\n/**\n * 文本消息内容\n */\nexport interface ITextMessageContent {\n  /** 消息类型，固定为 'm.text' */\n  msgtype: 'm.text';\n  /** 消息文本内容 */\n  body: string;\n  /** 消息格式，如 'org.matrix.custom.html' */\n  format?: string;\n  /** 格式化后的消息内容，当 format 为 'org.matrix.custom.html' 时使用 */\n  formatted_body?: string;\n  /** 关联的消息ID，用于回复、编辑等 */\n  'm.relates_to'?: {\n    /** 关联类型，如 'm.thread' 或 'm.replace' */\n    rel_type?: string;\n    /** 关联的事件ID */\n    event_id?: string;\n    /** 线程ID，如果是线程消息 */\n    thread_id?: string;\n    /** 是否为回退消息 */\n    is_falling_back?: boolean;\n    /** 其他可能的关联数据 */\n    [key: string]: any;\n  };\n  /** 其他可能的自定义字段 */\n  [key: string]: any;\n}\n\n/**\n * 媒体消息内容基础接口\n */\ninterface IMediaMessageContentBase {\n  /** 消息类型，如 'm.image', 'm.file' 等 */\n  msgtype: string;\n  /** 文件描述 */\n  body: string;\n  /** 文件名 */\n  filename?: string;\n  /** 媒体URL */\n  url?: string;\n  /** 文件信息 */\n  info?: {\n    /** 文件大小（字节） */\n    size?: number;\n    /** MIME类型 */\n    mimetype?: string;\n    /** 缩略图信息 */\n    thumbnail_info?: {\n      /** 缩略图宽度 */\n      w?: number;\n      /** 缩略图高度 */\n      h?: number;\n      /** 缩略图大小 */\n      size?: number;\n      /** 缩略图MIME类型 */\n      mimetype?: string;\n    };\n    /** 缩略图URL */\n    thumbnail_url?: string;\n    /** 其他可能的文件信息 */\n    [key: string]: any;\n  };\n  /** 其他可能的自定义字段 */\n  [key: string]: any;\n}\n\n/**\n * 图片消息内容\n */\nexport interface IImageMessageContent extends IMediaMessageContentBase {\n  msgtype: 'm.image';\n  info?: {\n    /** 图片宽度 */\n    w?: number;\n    /** 图片高度 */\n    h?: number;\n    /** 图片大小 */\n    size?: number;\n    /** 图片MIME类型 */\n    mimetype?: string;\n    /** 缩略图信息 */\n    thumbnail_info?: {\n      w?: number;\n      h?: number;\n      size?: number;\n      mimetype?: string;\n    };\n    /** 缩略图URL */\n    thumbnail_url?: string;\n    /** 其他可能的图片信息 */\n    [key: string]: any;\n  };\n}\n\n/**\n * 文件消息内容\n */\nexport interface IFileMessageContent extends IMediaMessageContentBase {\n  msgtype: 'm.file';\n}\n\n/**\n * 音频消息内容\n */\nexport interface IAudioMessageContent extends IMediaMessageContentBase {\n  msgtype: 'm.audio';\n  info?: {\n    /** 音频时长（毫秒） */\n    duration?: number;\n    /** 音频大小 */\n    size?: number;\n    /** 音频MIME类型 */\n    mimetype?: string;\n    /** 其他可能的音频信息 */\n    [key: string]: any;\n  };\n}\n\n/**\n * 视频消息内容\n */\nexport interface IVideoMessageContent extends IMediaMessageContentBase {\n  msgtype: 'm.video';\n  info?: {\n    /** 视频宽度 */\n    w?: number;\n    /** 视频高度 */\n    h?: number;\n    /** 视频时长（毫秒） */\n    duration?: number;\n    /** 视频大小 */\n    size?: number;\n    /** 视频MIME类型 */\n    mimetype?: string;\n    /** 视频缩略图信息 */\n    thumbnail_info?: {\n      w?: number;\n      h?: number;\n      size?: number;\n      mimetype?: string;\n    };\n    /** 视频缩略图URL */\n    thumbnail_url?: string;\n    /** 其他可能的视频信息 */\n    [key: string]: any;\n  };\n}\n\n/**\n * 位置消息内容\n */\nexport interface ILocationMessageContent {\n  msgtype: 'm.location';\n  /** 位置描述 */\n  body: string;\n  /** 地理URI，格式为 'geo:latitude,longitude' */\n  geo_uri: string;\n  /** 位置信息 */\n  info?: {\n    /** 缩略图信息 */\n    thumbnail_info?: {\n      w?: number;\n      h?: number;\n      size?: number;\n      mimetype?: string;\n    };\n    /** 缩略图URL */\n    thumbnail_url?: string;\n    /** 其他可能的位置信息 */\n    [key: string]: any;\n  };\n  /** 其他可能的自定义字段 */\n  [key: string]: any;\n}\n\n/**\n * 消息内容联合类型\n */\nexport type IMessageContent = \n  | ITextMessageContent\n  | IImageMessageContent\n  | IFileMessageContent\n  | IAudioMessageContent\n  | IVideoMessageContent\n  | ILocationMessageContent\n  | Record<string, any>; // 其他可能的类型\n\n/**\n * Matrix 消息接口\n */\nexport interface IMatrixMessage extends Omit<IMatrixEventBase, 'content'> {\n  /** 消息内容 */\n  content: IMessageContent;\n}\n\n/**\n * 文本消息\n */\nexport interface ITextMessage extends IMatrixMessage {\n  content: ITextMessageContent;\n}\n\n/**\n * 图片消息\n */\nexport interface IImageMessage extends IMatrixMessage {\n  content: IImageMessageContent;\n}\n\n/**\n * 文件消息\n */\nexport interface IFileMessage extends IMatrixMessage {\n  content: IFileMessageContent;\n}\n\n/**\n * 音频消息\n */\nexport interface IAudioMessage extends IMatrixMessage {\n  content: IAudioMessageContent;\n}\n\n/**\n * 视频消息\n */\nexport interface IVideoMessage extends IMatrixMessage {\n  content: IVideoMessageContent;\n}\n\n/**\n * 位置消息\n */\nexport interface ILocationMessage extends IMatrixMessage {\n  content: ILocationMessageContent;\n}\n\n/**\n * 消息类型守卫\n */\nconst isTextMessage = (message: IMatrixMessage): message is ITextMessage => \n  message.content.msgtype === 'm.text';\n\nconst isImageMessage = (message: IMatrixMessage): message is IImageMessage => \n  message.content.msgtype === 'm.image';\n\nconst isFileMessage = (message: IMatrixMessage): message is IFileMessage => \n  message.content.msgtype === 'm.file';\n\nconst isAudioMessage = (message: IMatrixMessage): message is IAudioMessage => \n  message.content.msgtype === 'm.audio';\n\nconst isVideoMessage = (message: IMatrixMessage): message is IVideoMessage => \n  message.content.msgtype === 'm.video';\n\nconst isLocationMessage = (message: IMatrixMessage): message is ILocationMessage => \n  message.content.msgtype === 'm.location';\n\n/**\n * 判断是否为媒体消息\n */\nconst isMediaMessage = (message: IMatrixMessage): boolean => \n  ['m.image', 'm.file', 'm.audio', 'm.video'].includes(message.content.msgtype);\n\n/**\n * 获取消息的显示文本\n */\nconst getMessageText = (message: IMatrixMessage): string => {\n  if (!message.content) return '';\n  \n  if (isTextMessage(message)) {\n    return message.content.body;\n  }\n  \n  if (isMediaMessage(message)) {\n    return message.content.body || `[${message.content.msgtype.replace('m.', '').toUpperCase()}]`;\n  }\n  \n  return JSON.stringify(message.content);\n};\n\n/**\n * 获取消息的发送时间\n */\nconst getMessageTime = (message: IMatrixMessage): Date => \n  new Date(message.origin_server_ts);\n\n/**\n * 获取消息的发送者名称\n */\nconst getMessageSenderName = (sender: string): string => \n  sender.split(':')[0].substring(1); // 移除 @ 符号和域名部分\n\n// 默认导出\nexport const messageTypeUtils = {\n  isTextMessage,\n  isImageMessage,\n  isFileMessage,\n  isAudioMessage,\n  isVideoMessage,\n  isLocationMessage,\n  isMediaMessage,\n  getMessageText,\n  getMessageTime,\n  getMessageSenderName,\n};","import React from 'react';\nimport { IMatrixMessage } from '../../client/message/types';\nimport { TextMessage } from './text/TextMessage';\nimport { LocationMessage } from './location/LocationMessage';\nimport { messageTypeUtils } from '../../client/message/types';\n\ninterface MessageRendererProps {\n  message: IMatrixMessage;\n  className?: string;\n}\n\nexport const MessageRenderer = ({ \n  message, \n  className = '' \n}: MessageRendererProps) => {\n  const commonProps = {\n    message,\n    className\n  };\n\n  if (messageTypeUtils.isTextMessage(message)) {\n    return <TextMessage key={message.event_id} {...commonProps} message={message} />;\n  }\n\n  if (messageTypeUtils.isLocationMessage(message)) {\n    return <LocationMessage key={message.event_id} {...commonProps} message={message} />;\n  }\n  \n  // 其他消息类型的处理...\n  \n  return <div className={`unknown-message ${className}`}>\n    不支持的消息类型: {message.content.msgtype}\n  </div>;\n};\n","import { Log, useProxyWatch, useProxyWatchUpdates, useTranslation } from '@fanfanlo';\nimport { Box, CircularProgress, Typography } from '@mui/material';\nimport { useEffect, useRef, useState } from 'react';\nimport { matrixRoom } from '../../client/room';\nimport { matrixUser } from '../../client/user';\nimport { MessageRenderer } from '../messages/MessageRenderer';\nimport { messageTypeUtils } from '../../client/message/types';\nconst fileLogger = new Log(false, 'im.components.room.MessageList')\n// fileLogger.childrenPaused = true;\n// fileLogger.pause = true;\ninterface MessageListProps {\n  roomId: string;\n}\n\nexport function MessageList({ roomId }: MessageListProps) {\n  const logger = fileLogger.sub(false, 'MessageList_fn');\n  logger.pause = true;\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const messagesContainerRef = useRef<HTMLDivElement>(null);\n  const [autoScroll, setAutoScroll] = useState(true);\n  const { t } = useTranslation('homepage/im/components/room/content');\n  \n  // 监听登录状态\n  const [loginResponse] = useProxyWatch(\n    matrixUser.userData,\n    'userInfo.loginResponse',\n    matrixUser.userData.userInfo.loginResponse\n  );\n  \n  // 监听消息列表\n  const [messageIds] = useProxyWatchUpdates(\n    matrixRoom.roomData.messages,\n    [`${roomId}`],\n    matrixRoom.roomData.messages[roomId] || []\n  );\n  logger.log('messageIds=', messageIds);\n  logger.log(`matrixRoom.roomData.messages[roomId]=`,matrixRoom.roomData.messages[roomId])\n  // 监听消息映射\n  const [messagesMap] = useProxyWatchUpdates(\n    matrixRoom.roomData,\n    'messagesMap',\n    matrixRoom.roomData.messagesMap\n  );\n  logger.log('messagesMap=', messagesMap);\n  logger.log('matrixRoom.roomData.messagesMap=', matrixRoom.roomData.messagesMap)\n  // 获取消息详情并转换为 IMatrixMessage 格式\n  const messageList = messageIds?.map(id => {\n    const message = messagesMap[id];\n    if (!message) {\n      console.warn('Message not found:', id);\n      return null;\n    }\n    \n    // 转换为 IMatrixMessage 格式\n    return {\n      id: message.event_id || message.id,\n      type: message.content.msgtype,\n      sender: message.sender,\n      timestamp: message.origin_server_ts || message.timestamp,\n      roomId: roomId,\n      content: message.content,\n      status: 'received' // 默认为已接收状态\n    };\n  }).filter(Boolean) || [];\n\n  // 添加消息更新日志\n  useEffect(() => {\n    logger.log('messageIds=', messageIds);\n    logger.log('messagesMap=', messagesMap);\n  }, [messageIds, messagesMap]);\n  \n  // 滚动到底部\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    if (autoScroll) {\n      scrollToBottom();\n    }\n  }, [messageList, autoScroll]);\n\n  // 处理滚动事件\n  const handleScroll = () => {\n    if (!messagesContainerRef.current) return;\n    \n    const { scrollTop, scrollHeight, clientHeight } = messagesContainerRef.current;\n    const isAtBottom = scrollHeight - scrollTop === clientHeight;\n    \n    setAutoScroll(isAtBottom);\n  };\n\n  return (\n    <Box \n      ref={messagesContainerRef}\n      onScroll={handleScroll}\n      sx={{\n        flex: 1,\n        overflowY: 'auto',\n        p: 2,\n        display: 'flex',\n        flexDirection: 'column',\n        gap: 2\n      }}\n    >\n      {!loginResponse?.user_id ? (\n        <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\" height=\"100%\">\n          <CircularProgress />\n        </Box>\n      ) : messageList.length === 0 ? (\n        <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\" height=\"100%\">\n          <Typography variant=\"body1\" color=\"text.secondary\">\n            {t('MessageList.noMessages')}\n          </Typography>\n        </Box>\n      ) : (\n        messageList.map((message) => (\n          <Box\n            key={message.id}\n            sx={{\n              display: 'flex',\n              justifyContent: message.sender === loginResponse.user_id ? 'flex-end' : 'flex-start',\n              mb: 2\n            }}\n          >\n            <Box\n              sx={{\n                maxWidth: '80%',\n                bgcolor: message.sender === loginResponse.user_id ? 'primary.main' : 'background.paper',\n                color: message.sender === loginResponse.user_id ? 'primary.contrastText' : 'text.primary',\n                p: 2,\n                borderRadius: 2,\n                boxShadow: 1,\n                position: 'relative',\n                wordBreak: 'break-word'\n              }}\n            >\n              <MessageRenderer \n                message={message} \n                className={message.sender === loginResponse.user_id ? 'sent-message' : 'received-message'}\n              />\n              <Typography \n                variant=\"caption\" \n                sx={{ \n                  display: 'block',\n                  textAlign: 'right',\n                  mt: 0.5,\n                  opacity: 0.7,\n                  color: message.sender === loginResponse.user_id ? 'primary.contrastText' : 'text.secondary'\n                }}\n              >\n                {new Date(message.timestamp).toLocaleTimeString()}\n              </Typography>\n            </Box>\n          </Box>\n        ))\n      )}\n      <div ref={messagesEndRef} />\n    </Box>\n  );\n}\n","import { IMatrixMessage, ILocationMessage, ILocationContent } from '../types';\nimport { roomData } from '../../room/data';\nimport { Log } from '@fanfanlo';\nimport { matrixClient } from '../../client';\n\nconst logger = new Log(false, 'im.client.message.handlers.location');\n\n// 内部辅助函数\nfunction addToLocalCache(roomId: string, message: IMatrixMessage) {\n  roomData.messagesMap[message.id] = message;\n  \n  if (!roomData.messages[roomId]) {\n    roomData.messages[roomId] = [];\n  }\n  roomData.messages[roomId].push(message.id);\n}\n\nfunction updateMessageStatus(messageId: string, updates: Partial<IMatrixMessage>) {\n  const message = roomData.messagesMap[messageId];\n  if (message) {\n    roomData.messagesMap[messageId] = {\n      ...message,\n      ...updates\n    };\n  }\n}\n\n// 导出所有内容\nexport const locationMessageUtils = {\n  // 创建位置消息内容\n  createLocationContent: (\n    latitude: number,\n    longitude: number,\n    title: string = '',\n    description: string = ''\n  ): ILocationContent => ({\n    msgtype: 'm.location',\n    body: title || `位置: ${latitude}, ${longitude}`,\n    geo_uri: `geo:${latitude},${longitude}`,\n    info: {\n      title,\n      description\n    }\n  }),\n\n  // 发送位置消息\n  send: async (\n    roomId: string,\n    latitude: number,\n    longitude: number,\n    title: string = '',\n    description: string = ''\n  ): Promise<string> => {\n    const content = locationMessageUtils.createLocationContent(latitude, longitude, title, description);\n    const tempId = `temp_${Date.now()}`;\n    \n    const message: ILocationMessage = {\n      id: tempId,\n      type: 'm.location',\n      sender: matrixClient.client?.getUserId() || '',\n      timestamp: Date.now(),\n      roomId,\n      content,\n      status: 'sending'\n    };\n\n    addToLocalCache(roomId, message);\n\n    if (!matrixClient.client) {\n      logger.error('Matrix client is not initialized');\n      throw new Error('Matrix client is not initialized');\n    }\n\n    try {\n      const eventId = await matrixClient.client.sendMessage(roomId, {\n        msgtype: 'm.location',\n        body: content.body,\n        geo_uri: content.geo_uri,\n        info: content.info\n      });\n\n      updateMessageStatus(tempId, {\n        id: eventId,\n        status: 'sent'\n      });\n\n      return eventId;\n    } catch (error) {\n      logger.error('Failed to send location message:', error);\n      updateMessageStatus(tempId, {\n        status: 'failed',\n        error: error instanceof Error ? error.message : 'Unknown error'\n      });\n      throw error;\n    }\n  },\n\n  // 处理接收到的位置消息\n  handleReceived: (roomId: string, event: any): ILocationMessage => {\n    const message: ILocationMessage = {\n      id: event.event_id,\n      type: 'm.location',\n      sender: event.sender,\n      timestamp: event.origin_server_ts,\n      roomId,\n      content: {\n        msgtype: 'm.location',\n        body: event.content.body,\n        geo_uri: event.content.geo_uri,\n        info: event.content.info\n      },\n      status: 'received'\n    };\n\n    addToLocalCache(roomId, message);\n    return message;\n  }\n};","// MapView.tsx\nimport React from 'react';\nimport dynamic from 'next/dynamic';\n\n// 添加 Map 组件的 props 类型\ninterface MapProps extends React.HTMLAttributes<HTMLDivElement> {\n  center: { lng: number; lat: number };\n  zoom: number;\n  style?: React.CSSProperties;\n  onMapMounted?: (map: any) => void;\n  [key: string]: any;\n}\n\n// 使用 dynamic 导入地图组件，并禁用 SSR\nconst MapWithLoader = dynamic<MapProps>(\n  () => import('react-bmapgl').then((mod) => {\n    const { Map, MapApiLoaderHOC } = mod;\n    \n    // 创建一个函数式组件\n    const MapComponent: React.FC<MapProps> = (props) => {\n      return (\n        <Map\n          style={{ height: '100%', width: '100%' }}\n          center={{lng: 116.402544, lat: 39.928216}}\n          zoom={12}\n          {...props}\n        />\n      );\n    };\n\n    // 使用类型断言来避免类型错误\n    return MapApiLoaderHOC({\n      ak: 'MmweUMZxcXOThZUaBuQ2rtKwLNHf1Hix'\n    })(MapComponent as any) as any;\n  }), \n  { \n    ssr: false,\n    loading: () => (\n      <div style={{ \n        height: '100%', \n        width: '100%', \n        display: 'flex', \n        alignItems: 'center', \n        justifyContent: 'center' \n      }}>\n        加载中...\n      </div>\n    )\n  }\n);\n\n// 导出组件\nexport const MapView: React.FC<MapProps> = (props) => {\n  return <MapWithLoader {...props} />;\n};","import React, { useState } from 'react';\nimport { \n  Dialog, \n  DialogTitle, \n  DialogContent, \n  DialogActions, \n  Button, \n  TextField,\n  Box,\n  CircularProgress,\n  Typography\n} from '@mui/material';\nimport { LocationOn as LocationIcon } from '@mui/icons-material';\nimport { useTranslation, MapView } from '@fanfanlo';\n\nexport interface Location {\n  latitude: number;\n  longitude: number;\n  title: string;\n  description: string;\n}\n\ninterface LocationPickerProps {\n  open: boolean;\n  onClose: () => void;\n  onConfirm: (location: Location) => void;\n}\n\nexport const LocationPicker = ({ \n  open, \n  onClose, \n  onConfirm \n}: LocationPickerProps) => {\n  const { t } = useTranslation();\n  const [title, setTitle] = useState('');\n  const [description, setDescription] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [currentLocation, setCurrentLocation] = useState<{ lat: number; lng: number } | null>(null);\n\n\n\n  const handleGetCurrentLocation = () => {\n    if (!navigator.geolocation) {\n      alert(t('location.geolocationNotSupported'));\n      return;\n    }\n\n    setIsLoading(true);\n    \n    navigator.geolocation.getCurrentPosition(\n      (position) => {\n        setCurrentLocation({\n          lat: position.coords.latitude,\n          lng: position.coords.longitude\n        });\n        setIsLoading(false);\n      },\n      (error) => {\n        console.error('Error getting location:', error);\n        alert(t('location.getLocationFailed'));\n        setIsLoading(false);\n      },\n      { \n        enableHighAccuracy: true,\n        timeout: 10000,\n        maximumAge: 0\n      }\n    );\n  };\n\n  const handleSubmit = () => {\n    if (!currentLocation) return;\n    \n    onConfirm({\n      latitude: currentLocation.lat,\n      longitude: currentLocation.lng,\n      title: title || t('location.myLocation'),\n      description\n    });\n    \n    // 重置表单\n    setTitle('');\n    setDescription('');\n    setCurrentLocation(null);\n    onClose();\n  };\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      maxWidth=\"sm\"\n      fullWidth\n      PaperProps={{\n        sx: {\n          minHeight: 600,\n          height: '100%'\n        }\n      }}\n    >\n      <DialogTitle>{t('location.shareLocation')}</DialogTitle>\n      <DialogContent\n        sx={{\n          height: '100%',\n          display: 'flex',\n          flexDirection: 'column'\n        }}\n      >\n        <Box sx={{ width: '100%', height: '100%', mb: 3, position: 'relative' }}>\n        <MapView \n      style={{ width: '100%', height: '100%', minHeight: 400 }}\n      // 其他需要的 props\n    />\n        </Box>\n        <Box sx={{ mt: 2, mb: 3 }}>\n          <Button\n            variant=\"contained\"\n            startIcon={<LocationIcon />}\n            onClick={handleGetCurrentLocation}\n            disabled={isLoading}\n          >\n            {isLoading ? (\n              <CircularProgress size={24} />\n            ) : (\n              t('location.getCurrentLocation')\n            )}\n          </Button>\n        </Box>\n\n        {currentLocation && (\n          <Box sx={{ mt: 2, mb: 3 }}>\n            <TextField\n              fullWidth\n              label={t('location.title')}\n              value={title}\n              onChange={(e) => setTitle(e.target.value)}\n              margin=\"normal\"\n            />\n            <TextField\n              fullWidth\n              label={t('location.description')}\n              value={description}\n              onChange={(e) => setDescription(e.target.value)}\n              margin=\"normal\"\n              placeholder={t('location.descriptionPlaceholder')}\n            />\n            \n            <Box sx={{ mt: 2, p: 2, border: '1px solid #eee', borderRadius: 1 }}>\n              <Typography variant=\"subtitle2\" gutterBottom>\n                {t('location.preview')}\n              </Typography>\n              <Typography variant=\"body2\" color=\"text.secondary\">\n                {t('location.latitude')}: {currentLocation.lat.toFixed(6)}\n                <br />\n                {t('location.longitude')}: {currentLocation.lng.toFixed(6)}\n              </Typography>\n            </Box>\n          </Box>\n        )}\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onClose}>{t('common.cancel')}</Button>\n        <Button \n          onClick={handleSubmit} \n          variant=\"contained\" \n          disabled={!currentLocation}\n        >\n          {t('common.send')}\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","import { useState, useRef, KeyboardEvent } from 'react';\nimport { \n  Box, \n  TextField, \n  IconButton, \n  InputAdornment,\n  Tooltip\n} from '@mui/material';\nimport { \n  Send as SendIcon, \n  LocationOn as LocationIcon,\n  AttachFile as AttachFileIcon,\n  EmojiEmotions as EmojiIcon \n} from '@mui/icons-material';\nimport { useTranslation } from '@fanfanlo';\nimport { matrixClient } from '../../client';\nimport { locationMessageUtils } from '../../client/message/handlers/location';\nimport { LocationPicker } from '../messages/location/LocationPicker';\n\ninterface MessageInputProps {\n  roomId: string;\n}\n\nexport function MessageInput({ roomId }: MessageInputProps) {\n  const { t } = useTranslation('homepage/im/components/room/content');\n  const [message, setMessage] = useState('');\n  const [locationPickerOpen, setLocationPickerOpen] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\n\n  const sendMessage = async () => {\n    if (!message.trim()) return;\n    \n    try {\n      await matrixClient.client.sendTextMessage(roomId, message.trim());\n      setMessage('');\n      // 保持焦点在输入框\n      textareaRef.current?.focus();\n    } catch (error) {\n      console.error('发送消息失败:', error);\n    }\n  };\n\n  const handleLocationConfirm = async (location: { \n    latitude: number; \n    longitude: number; \n    title: string;\n    description: string;\n  }) => {\n    try {\n      await locationMessageUtils.send(\n        roomId,\n        location.latitude,\n        location.longitude,\n        location.title,\n        location.description\n      );\n    } catch (error) {\n      console.error('发送位置消息失败:', error);\n    }\n  };\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      // 处理文件上传\n      console.log('Selected file:', file);\n      // TODO: 实现文件上传逻辑\n    }\n  };\n\n  const handleKeyDown = (e: KeyboardEvent<HTMLDivElement>) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      sendMessage();\n    }\n  };\n\n  return (\n    <Box sx={{ p: 2, borderTop: '1px solid', borderColor: 'divider' }}>\n      <Box sx={{ display: 'flex', alignItems: 'flex-end' }}>\n        <Tooltip title={t('MessageInput.attachFile')}>\n          <IconButton onClick={() => fileInputRef.current?.click()}>\n            <AttachFileIcon />\n            <input\n              type=\"file\"\n              ref={fileInputRef}\n              onChange={handleFileChange}\n              style={{ display: 'none' }}\n            />\n          </IconButton>\n        </Tooltip>\n        \n        <Tooltip title={t('MessageInput.emoji')}>\n          <IconButton>\n            <EmojiIcon />\n          </IconButton>\n        </Tooltip>\n        \n        <TextField\n          fullWidth\n          multiline\n          maxRows={4}\n          variant=\"outlined\"\n          placeholder={t('MessageInput.placeholder')}\n          value={message}\n          onChange={(e) => setMessage(e.target.value)}\n          onKeyDown={handleKeyDown}\n          inputRef={textareaRef}\n          sx={{ mx: 1 }}\n          InputProps={{\n            sx: { borderRadius: 4, pr: 1 },\n            endAdornment: (\n              <InputAdornment position=\"end\">\n                <Tooltip \n                  title={t('MessageInput.sendLocation')} \n                  disableFocusListener \n                  disableHoverListener\n                >\n                  <IconButton\n                    onClick={() => setLocationPickerOpen(true)}\n                    edge=\"end\"\n                    sx={{ mr: 0.5 }}\n                  >\n                    <LocationIcon color=\"primary\" />\n                  </IconButton>\n                </Tooltip>\n              </InputAdornment>\n            ),\n          }}\n        />\n        \n        <Tooltip \n          title={t('MessageInput.send')}\n        >\n          <span>\n            <IconButton \n              color=\"primary\" \n              onClick={sendMessage}\n              disabled={!message.trim()}\n              sx={{ alignSelf: 'flex-end', mb: 0.5 }}\n            >\n              <SendIcon />\n            </IconButton>\n          </span>\n        </Tooltip>\n      </Box>\n\n      <LocationPicker\n        open={locationPickerOpen}\n        onClose={() => setLocationPickerOpen(false)}\n        onConfirm={handleLocationConfirm}\n      />\n    </Box>\n  );\n}\n","import { Box, Typography, Avatar, List, ListItem, ListItemAvatar, ListItemText, CircularProgress } from '@mui/material';\nimport { useProxyWatch, useProxyWatchUpdates, useTranslation } from '@fanfanlo';\nimport { matrixUser } from '../../client/user';\nimport { matrixRoom } from '../../client/room';\nimport { RoomMembership } from '../../client/room/types';\n\ninterface RoomMember {\n  userId: string;\n  displayName?: string;\n  avatarUrl?: string;\n  membership: RoomMembership;\n}\n\ninterface RoomMembersProps {\n  roomId: string;\n}\n\nexport function RoomMembers({ roomId }: RoomMembersProps) {\n  const { t } = useTranslation('homepage/im/components/room/content');\n  \n  // 监听登录状态\n  const [loginResponse] = useProxyWatch(\n    matrixUser.userData,\n    'userInfo.loginResponse',\n    matrixUser.userData.userInfo.loginResponse\n  );\n  \n  // 监听房间成员数据和加载状态\n  const [roomMembers] = useProxyWatchUpdates(\n    matrixRoom.roomData.roomMembers,\n    [`${roomId}`],\n    matrixRoom.roomData.roomMembers[roomId] || []\n  );\n  const [isFetchingMembers] = useProxyWatch(\n    matrixRoom.roomData.isFetchingMembers,\n    'value',\n    matrixRoom.roomData.isFetchingMembers.value\n  );\n\n  // 如果登录信息未加载完成，显示加载中\n  if (!loginResponse) {\n    return (\n      <Box sx={{ p: 2, textAlign: 'center' }}>\n        <CircularProgress size={24} />\n      </Box>\n    );\n  }\n\n  const currentUserId = loginResponse.user_id;\n  \n  // 将当前用户排在最前面\n  const sortedMembers = [...roomMembers].sort((a) => \n    a.userId === currentUserId ? -1 : 1\n  );\n\n  if (isFetchingMembers) {\n    return (\n      <Box sx={{ p: 2, textAlign: 'center' }}>\n        <CircularProgress size={24} />\n        <Typography variant=\"caption\" color=\"text.secondary\" sx={{ mt: 1 }}>\n          {t('RoomMembers.loading')}\n        </Typography>\n      </Box>\n    );\n  }\n\n  if (sortedMembers.length === 0) {\n    return (\n      <Box sx={{ p: 2, textAlign: 'center' }}>\n        <Typography color=\"text.secondary\">\n          {t('RoomMembers.noMembers')}\n        </Typography>\n      </Box>\n    );\n  }\n\n  return (\n    <Box>\n      <List>\n        {sortedMembers.map((member: { userId: string; displayName?: string; avatarUrl?: string; membership: 'join' | 'invite' | 'leave' | 'ban' }) => (\n          <ListItem key={member.userId}>\n            <ListItemAvatar>\n              <Avatar src={member.avatarUrl} alt={member.displayName || member.userId} />\n            </ListItemAvatar>\n            <ListItemText\n              primary={member.displayName || member.userId}\n              secondary={member.userId === currentUserId ? t('RoomMembers.you') : t(`RoomMembers.${member.membership}`)}\n            />\n          </ListItem>\n        ))}\n      </List>\n    </Box>\n  );\n}","import { Box, Paper, Divider, useTheme } from '@mui/material';\nimport { useTranslation } from '@fanfanlo';\nimport { RoomHeader } from './RoomHeader';\nimport { MessageList } from './MessageList';\nimport { MessageInput } from './MessageInput';\nimport { RoomMembers } from './RoomMembers';\nimport { useState } from 'react';\nimport { useRouter } from 'next/router';\n\ninterface RoomContentProps {\n  roomId: string;\n}\n\nexport function RoomContent({ roomId }: RoomContentProps) {\n  const { t } = useTranslation('homepage/im/components/room/content');\n  const theme = useTheme();\n  const [showMembers, setShowMembers] = useState(false);\n\n  const router = useRouter();\n  const toggleMembers = () => {\n    setShowMembers(!showMembers);\n  };\n\n  return (\n    <Box sx={{ \n      display: 'flex', \n      flexDirection: 'column',\n      height: '100vh',\n      backgroundColor: theme.palette.background.default\n    }}>\n      {/* 顶部标题栏 */}\n      <RoomHeader \n        roomId={roomId} \n        onToggleMembers={toggleMembers}\n        showMembers={showMembers}\n      />\n      \n      <Box sx={{ \n        display: 'flex', \n        flex: 1, \n        overflow: 'hidden',\n        position: 'relative'\n      }}>\n        {/* 主消息区域 */}\n        <Box sx={{\n          flex: 1,\n          display: 'flex',\n          flexDirection: 'column',\n          overflow: 'hidden',\n          transition: 'margin 0.3s ease-in-out',\n          marginRight: showMembers ? '300px' : 0,\n        }}>\n          <MessageList roomId={roomId} />\n          <Divider />\n          <MessageInput roomId={roomId} />\n        </Box>\n        \n        {/* 右侧成员列表 */}\n        <Box\n          sx={{\n            width: '300px',\n            height: '100%',\n            position: 'absolute',\n            right: showMembers ? 0 : '-300px',\n            top: 0,\n            transition: 'right 0.3s ease-in-out',\n            backgroundColor: theme.palette.background.paper,\n            borderLeft: `1px solid ${theme.palette.divider}`,\n            overflowY: 'auto',\n            zIndex: 1,\n          }}\n        >\n          <RoomMembers roomId={roomId} />\n        </Box>\n      </Box>\n    </Box>\n  );\n}","export * from './RoomContent';\nexport * from './RoomHeader';\nexport * from './MessageList';\nexport * from './MessageInput';\nexport * from './RoomMembers';\nexport * from './types';\n","import { useRouter } from 'next/router';\nimport { useEffect } from 'react';\nimport { useTranslation } from \"@fanfanlo\";\nimport { AppbarContainer, AppShell } from \"@app/ui\";\nimport { RoomContent } from '../../../im/components/room';\n\nexport default function RoomPage() {\n  const { t } = useTranslation(\"homepage/pages/im/room/content\");\n  const router = useRouter();\n  const { id: roomId } = router.query;\n\n  useEffect(() => {\n    // 如果没有roomId，重定向到聊天列表\n    if (!roomId && router.isReady) {\n      router.push('/im');\n    }\n  }, [roomId, router]);\n\n  if (!roomId) {\n    return (\n      <AppShell>\n        <AppbarContainer appbarProps={{ title: t(\"content.title\"), back: true }} />\n      </AppShell>\n    );\n  }\n\n  return (\n    <AppShell>\n      <RoomContent roomId={roomId as string} />\n    </AppShell>\n  );\n}"],"names":["newValue","AppBar","Toolbar","IconButton","Typography","Avatar","Box","MenuIcon","PeopleIcon","useTranslation","useProxyWatch","matrixRoom","RoomHeader","roomId","showMembers","onToggleMembers","roomInfo","t","roomData","joinedRooms","find","r","position","color","elevation","size","edge","aria-label","sx","mr","onClick","src","avatarUrl","name","charAt","variant","component","flexGrow","title","React","TextMessage","message","className","content","body","Button","Dialog","DialogTitle","DialogContent","DialogActions","LocationMessage","geoUri","geo_uri","_","coordinates","split","latitude","longitude","map","Number","mapUrl","process","env","REACT_APP_BAIDU_MAP_KEY","open","setOpen","useState","handleOpenMap","handleClose","mb","img","alt","info","style","cursor","display","justifyContent","alignItems","onClose","maxWidth","fullWidth","InteractiveLocationMap","forwardRef","ref","width","height","minHeight","isTextMessage","msgtype","isImageMessage","isFileMessage","isAudioMessage","isVideoMessage","isLocationMessage","isMediaMessage","includes","getMessageText","replace","toUpperCase","JSON","stringify","getMessageTime","Date","origin_server_ts","getMessageSenderName","sender","substring","messageTypeUtils","MessageRenderer","commonProps","event_id","div","Log","useProxyWatchUpdates","CircularProgress","useEffect","useRef","matrixUser","fileLogger","MessageList","logger","sub","pause","messagesEndRef","messagesContainerRef","autoScroll","setAutoScroll","loginResponse","userData","userInfo","messageIds","messages","log","messagesMap","messageList","id","console","warn","type","timestamp","status","filter","Boolean","scrollToBottom","current","scrollIntoView","behavior","handleScroll","scrollTop","scrollHeight","clientHeight","isAtBottom","onScroll","flex","overflowY","p","flexDirection","gap","user_id","length","bgcolor","borderRadius","boxShadow","wordBreak","textAlign","mt","opacity","toLocaleTimeString","matrixClient","addToLocalCache","push","updateMessageStatus","messageId","updates","locationMessageUtils","createLocationContent","description","send","tempId","now","client","getUserId","error","Error","eventId","sendMessage","handleReceived","event","TextField","LocationOn","LocationIcon","MapView","LocationPicker","onConfirm","setTitle","setDescription","isLoading","setIsLoading","currentLocation","setCurrentLocation","handleGetCurrentLocation","navigator","geolocation","alert","getCurrentPosition","lat","coords","lng","enableHighAccuracy","timeout","maximumAge","handleSubmit","PaperProps","startIcon","disabled","label","value","onChange","e","target","margin","placeholder","border","gutterBottom","toFixed","br","InputAdornment","Tooltip","Send","SendIcon","AttachFile","AttachFileIcon","EmojiEmotions","EmojiIcon","MessageInput","setMessage","locationPickerOpen","setLocationPickerOpen","fileInputRef","textareaRef","trim","sendTextMessage","focus","handleLocationConfirm","location","handleFileChange","file","files","handleKeyDown","key","shiftKey","preventDefault","borderTop","borderColor","click","input","multiline","maxRows","onKeyDown","inputRef","mx","InputProps","pr","endAdornment","disableFocusListener","disableHoverListener","span","alignSelf","List","ListItem","ListItemAvatar","ListItemText","RoomMembers","roomMembers","isFetchingMembers","currentUserId","sortedMembers","sort","a","userId","member","displayName","primary","secondary","membership","Divider","useTheme","useRouter","RoomContent","theme","setShowMembers","router","toggleMembers","backgroundColor","palette","background","default","overflow","transition","marginRight","right","top","paper","borderLeft","divider","zIndex","AppbarContainer","AppShell","RoomPage","query","isReady","appbarProps","back"],"sourceRoot":"","ignoreList":[1]}