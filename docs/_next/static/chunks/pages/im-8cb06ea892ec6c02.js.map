{"version":3,"file":"static/chunks/pages/im-8cb06ea892ec6c02.js","mappings":"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","sources":["webpack://_N_E/./src/im/components/rooms/summary-room-list/SummaryRoomList.tsx","webpack://_N_E/./src/im/components/user/profile/UserProfile.tsx","webpack://_N_E/./src/im/components/rooms/create/CreateRoomButton.tsx","webpack://_N_E/./src/im/components/page-content/PageContent.tsx","webpack://_N_E/./src/pages/im/index.tsx","webpack://_N_E/../../../src/watcher/useWatchUpdates.tsx","webpack://_N_E/../../node_modules/.pnpm/react-i18next@15.1.4_i18next@24.1.0_typescript@5.8.2__react-dom@19.0.0_react@19.0.0__react@19.0.0/node_modules/react-i18next/dist/es/index.js","webpack://_N_E/../../../../src/components/app/AppShell.tsx","webpack://_N_E/../../../../src/components/page/PageContent.tsx","webpack://_N_E/../../../../src/components/page/AndroidPageContent.tsx","webpack://_N_E/?9749","webpack://_N_E/../../../src/mc/static-model.ts","webpack://_N_E/../../../../src/components/motion/page-transition.tsx","webpack://_N_E/../../../../src/components/app/PageShell.tsx","webpack://_N_E/../../../../src/components/appbar/AppBar.tsx"],"sourcesContent":["import { useProxyWatchUpdates, useTranslation } from '@fanfanlo';\nimport { \n    Box, \n    List, \n    ListItem, \n    ListItemAvatar, \n    ListItemText, \n    Avatar, \n    Typography, \n    ListItemSecondaryAction,\n    IconButton,\n    Chip\n} from '@mui/material';\nimport { IMatrixRoomData, IMatrixRoomInfo, matrixRoom } from '../../../client/room/';\nimport { format } from 'date-fns';\nimport { zhCN } from 'date-fns/locale';\nimport CheckIcon from '@mui/icons-material/Check';\nimport CloseIcon from '@mui/icons-material/Close';\nimport { matrixClient } from '../../../client';\nimport React from 'react';\nimport { useRouter } from 'next/router';\n\ninterface RoomListItemProps {\n    room: IMatrixRoomInfo;\n    onClick: (roomId: string) => void;\n    onInviteResponse?: (roomId: string, accept: boolean) => Promise<void>;\n}\n\nfunction RoomListItem({ room, onClick, onInviteResponse }: RoomListItemProps) {\n    const isInvite = room.membership === 'invite';\n    const [isProcessing, setIsProcessing] = React.useState(false);\n\n    const handleInviteResponse = async (e: React.MouseEvent, accept: boolean) => {\n        e.stopPropagation();\n        if (onInviteResponse && !isProcessing) {\n            setIsProcessing(true);\n            try {\n                await onInviteResponse(room.roomId, accept);\n            } finally {\n                setIsProcessing(false);\n            }\n        }\n    };\n    const { t } = useTranslation('homepage/im/components/rooms/summary-room-list/content');\n  \n    const getLastMessageTime = () => {\n        if (!room.lastMessageTime) return '';\n        return format(room.lastMessageTime, 'HH:mm', { locale: zhCN });\n    };\n\n  const getRoomName = () => {\n      if (!room.name) return room.roomId;\n      return room.name;\n  };\n\n  return (\n      <ListItem \n          button\n          onClick={() => !isInvite && onClick(room.roomId)}\n          sx={{\n              bgcolor: isInvite ? 'action.hover' : 'background.paper',\n              borderLeft: isInvite ? '3px solid' : 'none',\n              borderLeftColor: 'primary.main',\n              opacity: isProcessing ? 0.7 : 1,\n              pointerEvents: isProcessing ? 'none' : 'auto'\n          }}\n          secondaryAction={\n              isInvite ? (\n                  <Box sx={{ display: 'flex', gap: 1 }}>\n                      <IconButton \n                          size=\"small\" \n                          color=\"primary\"\n                          onClick={(e) => handleInviteResponse(e, true)}\n                          title=\"接受邀请\"\n                          disabled={isProcessing}\n                      >\n                          <CheckIcon />\n                      </IconButton>\n                      <IconButton \n                          size=\"small\" \n                          color=\"error\"\n                          onClick={(e) => handleInviteResponse(e, false)}\n                          title=\"拒绝邀请\"\n                          disabled={isProcessing}\n                      >\n                          <CloseIcon />\n                      </IconButton>\n                  </Box>\n              ) : (\n                  <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                      {room.unreadCount && room.unreadCount > 0 && (\n                          <Chip \n                              label={room.unreadCount.toString()} \n                              size=\"small\" \n                              sx={{ \n                                  bgcolor: 'primary.main', \n                                  color: 'primary.contrastText',\n                                  px: 1\n                              }}\n                          />\n                      )}\n                      <Typography \n                          variant=\"caption\" \n                          color=\"text.secondary\"\n                          sx={{ mt: 0.5 }}\n                      >\n                          {getLastMessageTime()}\n                      </Typography>\n                  </Box>\n              )\n          }\n      >\n          <ListItemAvatar>\n              <Avatar src={room.avatarUrl}>\n                  {getRoomName().charAt(0)}\n              </Avatar>\n          </ListItemAvatar>\n          <ListItemText\n              primary={getRoomName()}\n              secondary={room.membership}\n          />\n      </ListItem>\n  );\n}\n\n\nexport function SummaryRoomList() {\n  // i18n文件路径规则\n  // i18n文件路径，这个文件将被工具自动生成另一个json文件放置到public和一个i18n-raw的目录，例如当前这个就在这里\n  // C:\\work\\android-droid\\html\\website-2024-12\\apps\\homepage\\i18n-raw\\origin\\im\\components\\rooms\\summary-room-list\\content.json\n  // apps\\homepage\\src\\im\\components\\rooms\\summary-room-list\\SummaryRoomList.i18n.json\n  // 这是一个monorepo架构方式的项目，\n  // homepage是项目名，和package.json对应，\n  // /im/components/rooms/summary-room-list是当前文件的目录\n  // content是一个后缀，自动生成的i18n文件会自定命名为content.json\n  // 使用时的规则就是 `${package.name}/${fileFolder}/content`\n  // 这个文件会映射到${package.name}/src/types/i18n-resources.ts文件里\n  // 例如当前这个对应在   homepage__im__components__rooms__summary___room___list 这个type就是它的json文件的类型。\n  // useTranslation 用的是 @fanfanlo库里导入的，而非react-i18next。\n  const { t } = useTranslation('homepage/im/components/rooms/summary-room-list/content');\n\n  // 用useProxyWatchUpdates来监听房间列表变化\n  const [rooms] = useProxyWatchUpdates(matrixRoom.roomData, 'joinedRooms', matrixRoom.roomData.joinedRooms)\n\n  const router = useRouter();\n  // 处理邀请响应\n  const handleInviteResponse = async (roomId: string, accept: boolean) => {\n    try {\n      if (accept) {\n        // 接受邀请\n        await matrixClient.client.joinRoom(roomId);\n      } else {\n        // 拒绝邀请\n        await matrixClient.client.leave(roomId);\n      }\n    } catch (error) {\n      console.error('处理邀请时出错:', error);\n      // 这里可以添加错误提示\n    }\n  };\n  const createHandleRoomClick = (roomId: string) => {\n    return () => {\n      handleRoomClick(roomId)\n    };\n  };\n  // 处理房间点击\n  const handleRoomClick = (roomId: string) => {\n    // 这里可以添加导航到聊天界面的逻辑\n    console.log('进入房间:', roomId);\n    router.push(`/im/room?id=${encodeURIComponent(roomId)}`);\n  };\n\n  if (rooms.length === 0) {\n    return (\n      <Box sx={{ p: 2, textAlign: 'center', color: 'text.secondary' }}>\n        {/* SummaryRoomList是i18n文件名，也是要用的key前缀。 */}\n        {t('SummaryRoomList.noRooms')}\n      </Box>\n    );\n  }\n\n  return (\n    <List sx={{ width: '100%', bgcolor: 'background.paper' }}>\n      {rooms.map((room) => (\n        <RoomListItem \n          key={room.roomId} \n          room={room} \n          onClick={createHandleRoomClick(room.roomId)}\n          onInviteResponse={handleInviteResponse}\n        />\n      ))}\n    </List>\n  );\n}\n","import { useProxyWatch, useTranslation } from \"@fanfanlo\";\r\nimport { Box } from \"@mui/material\";\r\nimport { matrixUser } from \"@src/im/client\";\r\n\r\n\r\nexport function UserProfile(){\r\n    const {t} = useTranslation('homepage/im/components/user/profile/content');\r\n    const [userId, proxy, unsub] = useProxyWatch(matrixUser.userData.userInfo, 'loginResponse.user_id', '')\r\n    \r\n    console.log('userid=', userId, proxy, unsub);\r\n    console.log('xxxxxxxxxx', proxy.loginResponse)\r\n    return (<Box>\r\n        <Box>\r\n            <span>\r\n                <span>\r\n                    ID:\r\n                </span>\r\n                <span>\r\n                    {userId ? userId : '未登录'}\r\n                </span>\r\n            </span>\r\n        </Box>\r\n    </Box>)\r\n}","import { useState } from 'react';\nimport { useTranslation } from '@fanfanlo';\nimport { \n    Button, \n    Dialog, \n    DialogTitle, \n    DialogContent, \n    DialogActions, \n    TextField, \n    FormControlLabel, \n    Checkbox, \n    CircularProgress,\n    Alert,\n    AlertTitle,\n    Box\n} from '@mui/material';\nimport { matrixInit, matrixInivte } from '@src/im/client';\n\ninterface FormData {\n    userId: string;\n    roomName: string;\n    topic: string;\n    isEncrypted: boolean;\n    isDirect: boolean;\n}\n\nexport function CreateRoomButton() {\n    const { t } = useTranslation('homepage/im/components/rooms/create/content');\n    const [open, setOpen] = useState(false);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n    const [formData, setFormData] = useState<FormData>({\n        userId: '',\n        roomName: '',\n        topic: '',\n        isEncrypted: true,\n        isDirect: true\n    });\n    const [errors, setErrors] = useState<Partial<Record<keyof FormData, string>>>({});\n\n    const handleOpen = () => setOpen(true);\n    const handleClose = () => {\n        setOpen(false);\n        setError(null);\n        setErrors({});\n    };\n\n    const validateForm = (): boolean => {\n        const newErrors: Partial<Record<keyof FormData, string>> = {};\n        \n        // 验证用户ID\n        if (!formData.userId.trim()) {\n            newErrors.userId = t('CreateRoomButton.dialog.form.userId.error.required');\n        } else if (!/^@[^:]+:.+$/.test(formData.userId)) {\n            newErrors.userId = t('CreateRoomButton.dialog.form.userId.error.invalid');\n        }\n        \n        setErrors(newErrors);\n        return Object.keys(newErrors).length === 0;\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        \n        if (!validateForm()) {\n            return;\n        }\n        \n        setLoading(true);\n        setError(null);\n        \n        try {\n            if (formData.isDirect) {\n                // 创建直接消息\n                const result = await matrixInivte.createDirectMessage(formData.userId);\n                if (!result.success) {\n                    throw new Error(result.error || 'Unknown error');\n                }\n            } else {\n                // 创建普通房间\n                const options: any = {\n                    name: formData.roomName || undefined,\n                    topic: formData.topic || undefined,\n                    preset: 'private_chat',\n                    visibility: 'private',\n                    invite: [formData.userId],\n                    is_direct: false,\n                    initial_state: formData.isEncrypted ? [{\n                        type: 'm.room.encryption',\n                        state_key: '',\n                        content: {\n                            algorithm: 'm.megolm.v1.aes-sha2'\n                        }\n                    }] : undefined\n                };\n                \n                await matrixInivte.createDirectMessage(options);\n            }\n            \n            // 成功后关闭对话框并重置表单\n            handleClose();\n            setFormData({\n                userId: '',\n                roomName: '',\n                topic: '',\n                isEncrypted: true,\n                isDirect: true\n            });\n            \n            // 这里可以添加成功提示\n            console.log(t('CreateRoomButton.dialog.success'));\n            \n        } catch (err: any) {\n            console.error('创建房间失败:', err);\n            setError(err.message || t('CreateRoomButton.dialog.error', { error: '未知错误' }));\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n        const { name, value, type } = e.target as HTMLInputElement;\n        const checked = (e.target as HTMLInputElement).checked;\n        \n        setFormData(prev => ({\n            ...prev,\n            [name]: type === 'checkbox' ? checked : value\n        }));\n        \n        // 清除当前字段的错误\n        if (errors[name as keyof typeof errors]) {\n            setErrors(prev => ({\n                ...prev,\n                [name]: undefined\n            }));\n        }\n    };\n\n    return (\n        <Box>\n            <Button \n                variant=\"contained\" \n                color=\"primary\" \n                onClick={handleOpen}\n                size=\"small\"\n            >\n                {t('CreateRoomButton.button.name')}\n            </Button>\n            \n            <Dialog \n                open={open} \n                onClose={handleClose}\n                maxWidth=\"sm\"\n                fullWidth\n            >\n                <DialogTitle>{t('CreateRoomButton.dialog.title')}</DialogTitle>\n                <form onSubmit={handleSubmit}>\n                    <DialogContent>\n                        {error && (\n                            <Alert severity=\"error\" sx={{ mb: 2 }}>\n                                <AlertTitle>错误</AlertTitle>\n                                {error}\n                            </Alert>\n                        )}\n                        \n                        <TextField\n                            fullWidth\n                            margin=\"normal\"\n                            label={t('CreateRoomButton.dialog.form.userId.label')}\n                            placeholder={t('CreateRoomButton.dialog.form.userId.placeholder')}\n                            name=\"userId\"\n                            value={formData.userId}\n                            onChange={handleInputChange}\n                            error={!!errors.userId}\n                            helperText={errors.userId}\n                            disabled={loading}\n                        />\n                        \n                        <FormControlLabel\n                            control={\n                                <Checkbox \n                                    name=\"isDirect\"\n                                    checked={formData.isDirect}\n                                    onChange={handleInputChange}\n                                    disabled={loading}\n                                />\n                            }\n                            label={t('CreateRoomButton.dialog.form.isDirect.label')}\n                        />\n                        \n                        {!formData.isDirect && (\n                            <>\n                                <TextField\n                                    fullWidth\n                                    margin=\"normal\"\n                                    label={t('CreateRoomButton.dialog.form.roomName.label')}\n                                    placeholder={t('CreateRoomButton.dialog.form.roomName.placeholder')}\n                                    name=\"roomName\"\n                                    value={formData.roomName}\n                                    onChange={handleInputChange}\n                                    disabled={loading}\n                                />\n                                \n                                <TextField\n                                    fullWidth\n                                    margin=\"normal\"\n                                    label={t('CreateRoomButton.dialog.form.topic.label')}\n                                    placeholder={t('CreateRoomButton.dialog.form.topic.placeholder')}\n                                    name=\"topic\"\n                                    value={formData.topic}\n                                    onChange={handleInputChange}\n                                    multiline\n                                    rows={2}\n                                    disabled={loading}\n                                />\n                                \n                                <FormControlLabel\n                                    control={\n                                        <Checkbox \n                                            name=\"isEncrypted\"\n                                            checked={formData.isEncrypted}\n                                            onChange={handleInputChange}\n                                            disabled={loading}\n                                        />\n                                    }\n                                    label={t('CreateRoomButton.dialog.form.isEncrypted.label')}\n                                />\n                            </>\n                        )}\n                    </DialogContent>\n                    \n                    <DialogActions sx={{ p: 2, pt: 0 }}>\n                        <Button \n                            onClick={handleClose} \n                            disabled={loading}\n                        >\n                            {t('CreateRoomButton.dialog.actions.cancel')}\n                        </Button>\n                        <Button \n                            type=\"submit\" \n                            variant=\"contained\" \n                            color=\"primary\"\n                            disabled={loading}\n                            startIcon={loading ? <CircularProgress size={20} /> : null}\n                        >\n                            {t('CreateRoomButton.dialog.actions.create')}\n                        </Button>\n                    </DialogActions>\n                </form>\n            </Dialog>\n        </Box>\n    );\n}","import { Box } from \"@mui/material\";\r\nimport { SummaryRoomList } from \"../rooms/summary-room-list/SummaryRoomList\";\r\nimport { UserProfile } from \"../user/profile/UserProfile\";\r\nimport { CreateRoomButton } from \"../rooms/create/CreateRoomButton\";\r\n\r\n\r\nexport function IMPageContent(){\r\n\r\n    return <Box>\r\n        <CreateRoomButton />\r\n        <UserProfile />\r\n        <SummaryRoomList />\r\n    </Box>\r\n}","import { AppbarContainer, AppShell } from \"@app/ui\"\r\nimport { useTranslation } from \"@fanfanlo\"\r\nimport { IMPageContent } from \"@src/im/components/page-content/PageContent\"\r\n\r\nexport default function IM() {\r\n    const { t } = useTranslation('homepage/pages/im/content')\r\n    return (\r\n        <AppShell>\r\n            <AppbarContainer appbarProps={{title:t(\"IM.title\"), back:true}}>\r\n                <IMPageContent />\r\n            </AppbarContainer>\r\n        </AppShell>\r\n    )\r\n}","import _ from \"lodash\"\r\nimport { useEffect, useState } from \"react\"\r\nimport { IWatchUpdatesConfig, watchUpdates } from \"./watchUpdates\"\r\nimport { PropertiesChain, toProxy } from \"./proxyWatch\"\r\nimport { useProxyWatch } from \"./useProxyWatch\"\r\nimport { objectCountUtils } from \"../utils\"\r\nimport { useWatch } from \"./UseWatch\"\r\nimport { Log } from \"../log\"\r\n\r\n/**\r\n * \r\n * 注意，返回的无论是object还是array，都无法监听，因为它们不是proxy，而是原始对象的副本\r\n * @param target 要监听的对象\r\n * @param conf 监听配置\r\n * @returns 监听的对象\r\n */\r\nexport function useWatchUpdates<T extends object>(target: T, conf?: IWatchUpdatesConfig<T>): [T] {\r\n    const [value, setValue] = useState<T>(target)\r\n    useEffect(() => {\r\n        console.log('use watch updates look look id', objectCountUtils.getObjectCount(target))\r\n        watchUpdates(target, (info) => {\r\n            console.log('uuuuuuuuuupdated', info)\r\n            console.log('tttttttarget=', target);\r\n            const now = _.isArray(info.target) ? [...info.target] : info.target\r\n            // setValue(now as T)\r\n            setValue((_.isArray(target) ? [...target] : { ...target }) as T)\r\n        }, conf)\r\n    }, [])\r\n    return [value as T]\r\n}\r\n\r\n/**\r\n * useProxyWatch + useWatchUpdates 结合体\r\n * 因为react的刷新机制，所以第二个state必须得用setState才会生效。\r\n * 不然其实这是两行代码，第一行是useProxyWatch，第二行是useWatchUpdates就可以了。\r\n * @param target 要监听的对象\r\n * @param propertyChain 要监听的属性链\r\n * @param defaultValue 默认值\r\n * @param conf 监听配置\r\n * @returns 监听的对象 返回的第一个参数是重新拼装的{...arr} or {...obj}，第二个参数是原始的target or defaultValue\r\n */\r\nexport function useProxyWatchUpdates<T extends object, U extends object>(target: T,\r\n    propertyChain: PropertiesChain<T>,\r\n    defaultValue: U,\r\n    conf?: IWatchUpdatesConfig<U>): [U, U] {\r\n        const logger = new Log(false, 'useProxyWatchUpdates_fn');\r\n        logger.pause = true;\r\n    const [v] = useProxyWatch(target, propertyChain, defaultValue)\r\n    const [value, setValue] = useState<U>(v);\r\n    logger.log(`propertyChain=`, propertyChain);\r\n    logger.log(`value=`, value);\r\n    logger.log('v=', v);\r\n    logger.log('defaultValue=', defaultValue)\r\n    useEffect(() => {\r\n        logger.log(`useEffect_fn v=`, v)\r\n        const newValue = _.isArray(v)\r\n            ? [...v]\r\n            : Object.assign({}, v);\r\n\r\n        setValue(newValue as U);\r\n        return watchUpdates(v, (info) => {\r\n            logger.log('watchUpdates_fn', 'info=', info)\r\n            // setValue((_.isArray(v) ? [...v ] : {...v}) as U)\r\n            // 使用 Object.assign 来避免循环引用\r\n            const newValue = _.isArray(v)\r\n                ? [...v]\r\n                : Object.assign({}, v);\r\n\r\n            setValue(newValue as U);\r\n        }, conf)\r\n    }, [v])\r\n    return [value, v]\r\n}\r\n\r\n","export * from \"C:\\\\work\\\\android-droid\\\\html\\\\website-2024-12\\\\node_modules\\\\.pnpm\\\\react-i18next@15.1.4_i18next@24.1.0_typescript@5.8.2__react-dom@19.0.0_react@19.0.0__react@19.0.0\\\\node_modules\\\\react-i18next\\\\dist\\\\es\\\\index.js\"","'use client'\r\nimport { i18n, i18nInit, IPageScrollPosition, StorePageContext, StorePageDynamicContext, toProxy, watchUpdates, storeUtils } from \"@fanfanlo\";\r\nimport { useRouter } from \"next/router\";\r\nimport { PropsWithChildren, useEffect } from \"react\";\r\nimport { I18nextProvider } from \"react-i18next\";\r\n\r\n\r\ni18nInit()\r\n\r\nexport function AppShell({ children }: PropsWithChildren) {\r\n  const router = useRouter();\r\n  const scrollKey = 'scrollPositionInfo'\r\n  const href = window.location.href.split(\"#\")[0]\r\n  const dynamicKey = `dynamic-${href}`\r\n  const s = storeUtils.namespace(dynamicKey);\r\n  let o: Record<string, unknown>|undefined = s.read(dynamicKey)\r\n  if (!o) {\r\n    o = {}\r\n    s.write(dynamicKey, o)\r\n  }\r\n  o = toProxy(o)\r\n  useEffect(() => {\r\n\r\n    router.beforePopState((state) => {\r\n      s.clearAll()\r\n      return true\r\n    })\r\n  })\r\n  useEffect(() => {\r\n    s.write(dynamicKey, o)\r\n    return watchUpdates(o, () => {\r\n      s.write(dynamicKey, o)\r\n    })\r\n  }, [])\r\n  useEffect(() => {\r\n    const info = (s.read(scrollKey) || { x: 0, y: 0 }) as IPageScrollPosition\r\n    // console.log('app shell scroll info info = ', info)\r\n    if (info.x == 0 && info.y == 0) {\r\n      listenScroll()\r\n    } else {\r\n      window.requestAnimationFrame(() => {\r\n        window.scrollTo(info.x, info.y)\r\n        listenScroll()\r\n      })\r\n    }\r\n    function onScroll(e: Event) {\r\n      // console.log('app shell on scroll', { x: window.scrollX, y: window.scrollY })\r\n      s.write(scrollKey, { x: window.scrollX, y: window.scrollY })\r\n    }\r\n    function listenScroll() {\r\n      window.addEventListener('scroll', onScroll)\r\n    }\r\n\r\n    function unsub() {\r\n      window.removeEventListener('scroll', onScroll)\r\n    }\r\n    return unsub\r\n  });\r\n  return (\r\n    <StorePageContext value={s}>\r\n      <StorePageDynamicContext value={o}>\r\n\r\n        <I18nextProvider i18n={i18n}>\r\n          {children}\r\n        </I18nextProvider>\r\n      </StorePageDynamicContext>\r\n    </StorePageContext>\r\n  )\r\n}","import { Box, Button, Container } from '@mui/material';\r\nimport { createContext, PropsWithChildren, useContext, useEffect } from 'react';\r\nimport { ITitleI18nConf, ITitleI18nNsConf, ITitleI18nTitleConf } from '.';\r\nimport { isBuild, isDev, isServer, loadI18nValue, publicRuntimeConfig } from '@fanfanlo';\r\nimport { read } from 'fs';\r\nimport { useTranslation } from '@fanfanlo';\r\n\r\n\r\nfunction Reload(){\r\n  if(!isDev)return <>  </>\r\n  const {t} = useTranslation(\"app-ui/components/page/content\")\r\n  return(\r\n    <Box>\r\n      <Button onClick={() => {window.location.reload()}}>{t(\"PageContent.refresh\")}</Button>\r\n      {new Date().toLocaleString()}\r\n    </Box>\r\n  )\r\n}\r\n\r\nconst ScrollP = createContext({ x: 0, y: 0 });\r\nlet index = 0;\r\nexport default function PageContent({ children, titleConf, reload }: {titleConf?:ITitleI18nConf, reload?: boolean} & PropsWithChildren) {\r\n  index++;\r\n  const scroll = useContext(ScrollP);\r\n  const clazz = `${Date.now() + Math.random() * Date.now()}`;\r\n  useEffect(()=>{\r\n    async function loadTitle(){\r\n      if(!titleConf)return\r\n      let title = titleConf.title\r\n      if(titleConf.ns){\r\n        title = await loadI18nValue(titleConf.ns, titleConf.key || \"content.title\")\r\n      }\r\n      if(!title)return\r\n      document.title = title\r\n    }\r\n    loadTitle()\r\n  }, [])\r\n  useEffect(() => {\r\n    const container = document.getElementsByClassName(clazz)[0];\r\n    if (!container) return;\r\n    container.scrollTop = scroll.y;\r\n    const onScroll = () => {\r\n      var scrollTop = container.scrollTop;\r\n      scroll.y = scrollTop;\r\n    };\r\n    container.removeEventListener('scroll', onScroll);\r\n    container.addEventListener('scroll', onScroll, { passive: true });\r\n    return () => container.removeEventListener('scroll', onScroll);\r\n  }, [clazz, scroll]);\r\n  return (\r\n\r\n    <Container className={clazz} sx={{ flexGrow: 1, overflow: 'auto', padding: \"0px\" }}>\r\n      <Box>\r\n        {(reload || (reload == undefined)) && <Reload />}\r\n        {children}\r\n      </Box>\r\n    </Container>\r\n  );\r\n}\r\n","import { PropsWithChildren } from \"react\";\r\nimport PageContent from \"./PageContent\";\r\nimport { ITitleI18nConf } from \".\";\r\nexport default function AndroidPageContent({ children, titleConf, reload }: {titleConf?:ITitleI18nConf, reload?: boolean} & PropsWithChildren)  {\r\n    return (\r\n        <PageContent titleConf={titleConf} reload={reload}>\r\n            {children}\r\n        </PageContent>\r\n    )\r\n}\r\n","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/im\",\n      function () {\n        return require(\"private-next-pages/im/index.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/im\"])\n      });\n    }\n  ","import { Dispatcher } from \"@fanfanlo\"\r\nimport { DispatcherUnsubscribe } from \"@fanfanlo\"\r\n\r\nconst dipsatcher = new Dispatcher()\r\ninterface IStaticModel{\r\n    dipsatcher:Dispatcher\r\n    screenLockCount:number\r\n    switchPage:()=>void\r\n    listenSwitchPage:(callback:()=>void)=>DispatcherUnsubscribe \r\n}\r\nexport const staticModel:IStaticModel = {\r\n    dipsatcher,\r\n    screenLockCount:0,\r\n    switchPage:async()=>{\r\n        dipsatcher.dispatch(\"switchPage\")\r\n        staticModel.screenLockCount = 0\r\n    },\r\n    listenSwitchPage:(callback:()=>void)=>{\r\n        return dipsatcher.addListener(\"switchPage\",callback)\r\n    }\r\n}   \r\n","import { PropsWithChildren } from \"react\";\r\nimport { AnimatePresence, motion } from \"framer-motion\";\r\nimport { useRouter } from \"next/router\";\r\n\r\n\r\nexport function PageTransition({ children }: PropsWithChildren) {\r\n    const router = useRouter()\r\n    return (\r\n\r\n        <AnimatePresence mode=\"sync\">\r\n            <motion.div\r\n                key={router.route}\r\n                initial={{ opacity: 0, y: 10 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                exit={{ opacity: 0, y: -110 }}\r\n                transition={{ duration: 0.3 }}\r\n            >\r\n                {children}\r\n            </motion.div>\r\n        </AnimatePresence>\r\n    )\r\n}","import { staticModel } from \"@app/static\";\r\nimport { Box } from \"@mui/material\";\r\nimport { useEffect } from \"react\";\r\nimport { PageTransition } from \"../motion\";\r\nlet idCount = 0\r\nexport function PageShell({children}:{children:React.ReactNode}){\r\n    const id = `app-shell-${idCount++}`\r\n    useEffect(()=>{\r\n        const box = document.querySelector(`#${id}`)\r\n        const unlisten = staticModel.listenSwitchPage(()=>{\r\n            if(!box)return\r\n        })\r\n        if(!box)return\r\n        box.addEventListener(\"click\",(e)=>{\r\n            if(staticModel.screenLockCount == 0)return\r\n            e.stopPropagation()\r\n            e.preventDefault()\r\n        })\r\n        return ()=>{\r\n            unlisten()\r\n        }\r\n    },[])\r\n    return (\r\n        <Box id={id}>\r\n            <PageTransition>\r\n                {children}  \r\n            </PageTransition>\r\n        </Box>\r\n    )\r\n}\r\n","import { AppBar, Box, Container, CssBaseline, Fab, Fade, Slide, Toolbar, Typography, useScrollTrigger } from \"@mui/material\";\r\nimport { PropsWithChildren, ReactNode } from \"react\";\r\n// import {AndroidPageContent} from \"../../\";\r\nimport { browserHistoryUtils, IDispatcher } from \"@fanfanlo\";\r\nimport KeyboardArrowLeft from '@mui/icons-material/KeyboardArrowLeft';\r\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp';\r\nimport * as React from \"react\";\r\nimport { useRouter } from \"next/router\";\r\nimport { PageShell } from \"../app/PageShell\";\r\nimport shadows from \"@mui/material/styles/shadows\";\r\nimport AndroidPageContent from \"../page/AndroidPageContent\";\r\nimport { IAppBarBackAskEvent } from \"@app/static\";\r\nimport { ITitleI18nConf } from \"../page\";\r\ninterface Props {\r\n    /**\r\n     * Injected by the documentation to work in an iframe.\r\n     * You won't need it on your project.\r\n     */\r\n    window?: () => Window;\r\n    children?: React.ReactElement<unknown>;\r\n}\r\n\r\nfunction HideOnScroll(props: Props) {\r\n    const { children, window } = props;\r\n    // Note that you normally won't need to set the window ref as useScrollTrigger\r\n    // will default to window.\r\n    // This is only being set here because the demo is in an iframe.\r\n    const trigger = useScrollTrigger({\r\n        target: window ? window() : undefined,\r\n    });\r\n\r\n    return (\r\n        <Slide appear={false} direction=\"down\" in={!trigger}>\r\n            {children ?? <div />}\r\n        </Slide>\r\n    );\r\n}\r\nexport interface IAppbarProps extends PropsWithChildren {\r\n    title: ReactNode\r\n    back: boolean\r\n    backHandler?: () => boolean\r\n    backDispatcher?:IDispatcher\r\n}\r\nexport function Appbar({ title }: { title: ReactNode } & PropsWithChildren) {\r\n    return (\r\n\r\n        <AppBar color={\"inherit\"}>\r\n            <Toolbar>\r\n                <Typography variant=\"h6\" component=\"div\">\r\n                    {title}\r\n                </Typography>\r\n            </Toolbar>\r\n        </AppBar>\r\n    )\r\n}\r\n\r\ninterface IAppbarContainerProps extends PropsWithChildren {\r\n    appbarProps: IAppbarProps\r\n    titleConf?:ITitleI18nConf\r\n    reload?: boolean\r\n}\r\n\r\n// export interface IAppBarBackAskEvent{\r\n//     defaultPrevented:boolean\r\n// }\r\n\r\nfunction ScrollTop(props: Props) {\r\n    const { children, window } = props;\r\n    // Note that you normally won't need to set the window ref as useScrollTrigger\r\n    // will default to window.\r\n    // This is only being set here because the demo is in an iframe.\r\n    const trigger = useScrollTrigger({\r\n        target: window ? window() : undefined,\r\n        disableHysteresis: true,\r\n        threshold: 100,\r\n    });\r\n\r\n    const handleClick = (event: React.MouseEvent<HTMLDivElement>) => {\r\n        const anchor = (\r\n            (event.target as HTMLDivElement).ownerDocument || document\r\n        ).querySelector('#back-to-top-anchor');\r\n\r\n        if (anchor) {\r\n            anchor.scrollIntoView({\r\n                block: 'center',\r\n            });\r\n        }\r\n    };\r\n\r\n    return (\r\n        <Fade in={trigger}>\r\n            <Box data-id=\"content-scroll-top-button\"\r\n                onClick={handleClick}\r\n                role=\"presentation\"\r\n                sx={{ position: 'fixed', bottom: 16, right: 16 }}\r\n            >\r\n                {children}\r\n            </Box>\r\n        </Fade>\r\n    );\r\n}\r\nexport function AppbarContainer(props: IAppbarContainerProps) {\r\n    const { children, appbarProps, titleConf, reload } = props;\r\n    const router = useRouter()\r\n    function handleBack(){\r\n        // 本想抽象成底层一个方法，但是考虑了一下router需要注入或者是一个callback，似乎像现在这样判断一下event也可以。回头继续观察一下吧。\r\n        const event = browserHistoryUtils.askHistoryBack()\r\n        if(event.defaultPrevented)return\r\n        if(appbarProps.backDispatcher){\r\n            const e:IAppBarBackAskEvent = {defaultPrevented:false}\r\n            appbarProps.backDispatcher.dispatch('back',e)\r\n            if(e.defaultPrevented)return\r\n        }\r\n        router.back()\r\n    }\r\n    return (\r\n        <PageShell>\r\n        <React.Fragment>\r\n            <CssBaseline />\r\n            <HideOnScroll {...props}>\r\n                <AppBar color=\"inherit\">\r\n                    <Toolbar>\r\n                        <KeyboardArrowLeft onClick={handleBack} />\r\n                        {appbarProps.title}\r\n                    </Toolbar>\r\n                </AppBar>\r\n            </HideOnScroll>\r\n            <Toolbar id=\"back-to-top-anchor\" />\r\n            <Container sx={{padding:\"0\", marginTop:\"17px\"}}>\r\n                <AndroidPageContent titleConf={titleConf} reload={reload}>\r\n                    {children}\r\n                </AndroidPageContent>\r\n            </Container>\r\n\r\n            <ScrollTop {...props}>\r\n                <Fab size=\"small\" aria-label=\"scroll back to top\">\r\n                    <KeyboardArrowUpIcon />\r\n                </Fab>\r\n            </ScrollTop>\r\n        </React.Fragment>\r\n        </PageShell>\r\n    );\r\n}\r\n"],"names":["useProxyWatchUpdates","useTranslation","Box","List","ListItem","ListItemAvatar","ListItemText","Avatar","Typography","IconButton","Chip","matrixRoom","format","zhCN","CheckIcon","CloseIcon","matrixClient","React","useRouter","RoomListItem","room","onClick","onInviteResponse","isInvite","membership","isProcessing","setIsProcessing","useState","handleInviteResponse","e","accept","stopPropagation","roomId","t","getLastMessageTime","lastMessageTime","locale","getRoomName","name","button","sx","bgcolor","borderLeft","borderLeftColor","opacity","pointerEvents","secondaryAction","display","gap","size","color","title","disabled","alignItems","unreadCount","label","toString","px","variant","mt","src","avatarUrl","charAt","primary","secondary","SummaryRoomList","rooms","roomData","joinedRooms","router","client","joinRoom","leave","error","console","createHandleRoomClick","handleRoomClick","log","push","encodeURIComponent","length","p","textAlign","width","map","useProxyWatch","matrixUser","UserProfile","userId","proxy","unsub","userData","userInfo","loginResponse","span","Button","Dialog","DialogTitle","DialogContent","DialogActions","TextField","FormControlLabel","Checkbox","CircularProgress","Alert","AlertTitle","matrixInivte","CreateRoomButton","open","setOpen","loading","setLoading","setError","formData","setFormData","roomName","topic","isEncrypted","isDirect","errors","setErrors","handleOpen","handleClose","validateForm","newErrors","trim","test","Object","keys","handleSubmit","preventDefault","result","createDirectMessage","success","Error","options","undefined","preset","visibility","invite","is_direct","initial_state","type","state_key","content","algorithm","err","message","handleInputChange","value","target","checked","prev","onClose","maxWidth","fullWidth","form","onSubmit","severity","mb","margin","placeholder","onChange","helperText","control","multiline","rows","pt","startIcon","IMPageContent","AppbarContainer","AppShell","IM","appbarProps","back","newValue"],"sourceRoot":"","ignoreList":[6]}