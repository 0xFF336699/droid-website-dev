{"version":3,"file":"static/chunks/9938-aa8d911f7382a366.js","mappings":"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","sources":["webpack://_N_E/../../src/index.ts","webpack://_N_E/./src/markets/markets-script-dev-lib.ts","webpack://_N_E/../../node_modules/.pnpm/react-i18next@15.6.0_i18next@24.2.3_typescript@5.7.3__react-dom@19.1.0_react@19.1.0__react@19.1.0_typescript@5.7.3/node_modules/react-i18next/dist/es/index.js","webpack://_N_E/../../../../src/android/components/index.ts","webpack://_N_E/./src/markets/market-dev-socket-setting-data.ts","webpack://_N_E/./src/pages/home/test-script.tsx","webpack://_N_E/./src/markets/market-html-utils.ts","webpack://_N_E/../../../../src/mui/dialog/ButtonConfirm.tsx","webpack://_N_E/../../libs/droid/project-interface/src/common/project-contexts.tsx","webpack://_N_E/../../../../src/utils/socket/socket-utils.ts","webpack://_N_E/../../../../src/components/tabbar/Tabbar.tsx","webpack://_N_E/./src/components/permissions/components/components.module.scss","webpack://_N_E/../../../src/types/index.ts","webpack://_N_E/../../../src/android/index.ts","webpack://_N_E/./src/markets/market-dev-socket.ts","webpack://_N_E/../../libs/droid/project/src/project/ui/components/CreateProjectButton.tsx","webpack://_N_E/../../libs/droid/project/src/project/utils/projectUtils.ts","webpack://_N_E/../../libs/droid/project/src/project/ui/components/DeleteProjectButton.tsx","webpack://_N_E/../../libs/droid/project/src/project/ui/project/ProjectUI.tsx","webpack://_N_E/../../libs/droid/project/src/project/ui/projects/ProjectsInfoItemUI.tsx","webpack://_N_E/./src/components/a11y/open-a11y-node-button.tsx","webpack://_N_E/./src/components/android-settings/AndroidSettingsInfo.tsx","webpack://_N_E/../../../../../src/android/scripts/app/app-kill-self.ts","webpack://_N_E/./src/components/app/kill-self/KillSelf.tsx","webpack://_N_E/./src/components/markets/AddExternalMarketButton.tsx","webpack://_N_E/./src/components/markets/main-page-add-buttons/MainPageAddButtons.tsx","webpack://_N_E/./src/components/page/markets-dev-settings/open-link-button/OpenLinkButton.tsx","webpack://_N_E/./src/components/scripts/send-sms/SendSms.tsx","webpack://_N_E/./src/components/test/SmsScriptItemComponent.tsx","webpack://_N_E/./src/im/components/page-links/PageLinks.tsx","webpack://_N_E/./src/livekit-meeting/MeetingRoom.new.tsx","webpack://_N_E/./src/markets/markets-script-lib.ts","webpack://_N_E/./src/markets/markets-script-manager.ts","webpack://_N_E/../../../../../src/android/scripts/a11y/a11y-info.ts","webpack://_N_E/../../../../src/mc/android-permission/androidPermission.data.ts","webpack://_N_E/../../../../src/utils/browser/use-tab-activity.tsx","webpack://_N_E/./src/components/permissions/accessibility/AccessibilityInfo.tsx","webpack://_N_E/./src/components/permissions/components/Components.tsx","webpack://_N_E/../../../../../src/android/scripts/floating/floating-info.ts","webpack://_N_E/./src/components/permissions/floating/FloatingInfo.tsx","webpack://_N_E/./src/components/permissions/home-page-permissions/HomePagePermissions.tsx","webpack://_N_E/./src/pages/home/index.tsx","webpack://_N_E/../../../src/types/market.intf.ts","webpack://_N_E/../../../../src/htmls/accessibility-info-buttons/accessibility-info-buttons.ts"],"sourcesContent":["// export interface IAndroid {\r\n//     onCallJsEvent(type:string, value:string):void\r\n// }\r\nexport * from './android/'\r\n// export * from './data'\r\nexport * from './types'\r\nexport * from './htmls'\r\nexport * from './mc/AndroidController'\r\nexport * from './confs'","import { autoJsStoreUtils } from \"@droid/android\"\r\nimport { IStoreWithData, storeUtils, toProxy } from \"@fanfanlo\"\r\nimport { IAndroidWatchFile, IMarketDevConnectEventType, IMarketDevGetAllEventData, IMarketDevServerEventType, WatchResourceType } from \"@market/lib\"\r\nimport { marketsDevSocket } from \"./market-dev-socket\"\r\nimport { objectCountUtils } from \"@fanfanlo\"\r\ninterface IMarketDevLibInfo{\r\n    allMarketLibData?:IMarketDevGetAllEventData\r\n    \r\n}\r\n// 注意marketDevLibData的操作是由devLibInfo来做的\r\n// 一定保持它俩操作的对象是同一个。\r\nconst marketDevLibData = toProxy<IMarketDevLibInfo>({})\r\nlet devLibInfo:IStoreWithData<IMarketDevLibInfo>// = storeUtils.getNamespaceStoreWithData('devLibInfo', {defData:{}, forceReset:false});\r\n\r\nfunction getMarketScriptDataNsPrefix() {\r\n    return 'market-script-data'\r\n}\r\n\r\nfunction createMarketScriptDataNsPath(ns: string) {\r\n    return `${getMarketScriptDataNsPrefix()}/${ns}`\r\n}\r\n\r\nasync function writeNsAllFiles(ns: string, files: Record<string, string>) {\r\n    const nsPath = createMarketScriptDataNsPath(ns)\r\n    const oldFiles = autoJsStoreUtils.read<string[]>(nsPath) || [];\r\n    for (const name of Object.keys(files)) {\r\n        const index = oldFiles.indexOf(name);\r\n        if (index > -1) {\r\n            oldFiles.splice(index, 1);\r\n        }\r\n        const content = files[name]\r\n        autoJsStoreUtils.write(`${nsPath}/${name}`, content)\r\n    }\r\n    for (const name of oldFiles) {\r\n        removeFile(`${nsPath}/${name}`)\r\n    }\r\n}\r\n\r\nfunction writeFile(name: string, content: string) {\r\n\r\n}\r\n\r\nfunction readNsAllFiles(ns: string) {\r\n\r\n}\r\n\r\nfunction readFile(name: string) {\r\n\r\n}\r\n\r\nfunction removeFile(name: string) {\r\n\r\n}\r\n\r\nfunction getAllMarkets() {\r\n\r\n}\r\nfunction listenDev(){\r\n    marketsDevSocket.dispatcher.addListener(IMarketDevConnectEventType.getAllScripts, onGetAllScript)\r\n    marketsDevSocket.dispatcher.addListener(IMarketDevServerEventType.update, onFileUpdate)    \r\n}\r\n\r\nfunction onGetAllScript(data:IMarketDevGetAllEventData){\r\n    // console.log('onGetAllScript=2', data)\r\n    // console.log('devLibInfo.data=', devLibInfo.data)\r\n    devLibInfo.data.allMarketLibData = data;\r\n    // 转为已经代理过的对象\r\n    marketDevLibData.allMarketLibData = devLibInfo.data.allMarketLibData;\r\n    // console.log('from onGetAllScript look look id', objectCountUtils.getObjectCount(devLibInfo.data.allMarketLibData.resources))\r\n}\r\n\r\nfunction onFileUpdate(data:IAndroidWatchFile){\r\n    if(data.client.resourceType == WatchResourceType.Html){\r\n        if(!devLibInfo.data.allMarketLibData)return;\r\n        for(const html of devLibInfo.data.allMarketLibData.htmls){\r\n            if(html.client.path == data.client.path){\r\n                html.content = data.content;\r\n                return;\r\n            }\r\n        }\r\n    }else if(data.client.resourceType == WatchResourceType.Js){\r\n        if(!devLibInfo.data.allMarketLibData)return;\r\n        for(let index = 0; index < devLibInfo.data.allMarketLibData.resources.length; index ++){\r\n            const script = devLibInfo.data.allMarketLibData.resources[index];\r\n            if(script.client.path == data.client.path){\r\n                devLibInfo.data.allMarketLibData.resources[index] = data;\r\n                console.log('market script dev scripts update script', data)\r\n                // devLibInfo.data.allMarketLibData.resources = [...devLibInfo.data.allMarketLibData.resources];\r\n                // console.log('update data', data);\r\n                // console.log('look look id', objectCountUtils.getObjectCount(devLibInfo.data.allMarketLibData.resources), devLibInfo.data.allMarketLibData.resources)\r\n                return;\r\n            }\r\n        }\r\n    }else{\r\n        // unknown resource type\r\n    }\r\n}\r\nlet isInitialized = false;\r\nasync function init() {\r\n    if(isInitialized){\r\n        return;\r\n    }\r\n    isInitialized = true;\r\n    listenDev();\r\n    devLibInfo = await storeUtils.getNamespaceStoreWithData('devLibInfo', {defData:{}, forceReset:false});\r\n    marketDevLibData.allMarketLibData = devLibInfo.data.allMarketLibData\r\n}\r\nexport const marketsDevScriptLib = {\r\n    writeFile,\r\n    readFile,\r\n    writeNsAllFiles,\r\n    readNsAllFiles,\r\n    getAllMarkets,\r\n    init,\r\n    marketDevLibData,\r\n}\r\n","export * from \"C:\\\\work\\\\android-droid\\\\html\\\\website-2024-12\\\\node_modules\\\\.pnpm\\\\react-i18next@15.6.0_i18next@24.2.3_typescript@5.7.3__react-dom@19.1.0_react@19.1.0__react@19.1.0_typescript@5.7.3\\\\node_modules\\\\react-i18next\\\\dist\\\\es\\\\index.js\"","export * from './A11yPermission'\r\nexport * from './floatPermission'\r\nexport * from './Manifest'\r\nexport * from './Permission'\r\nexport * from './PermissionAskUi'\r\nexport * from './PermissionEvent'\r\nexport * from './PermissionGroup'\r\nexport * from './permissionGroupCreator'\r\nexport * from './PermissionInterfaces'\r\n\r\n","import { storeUtils, toProxy } from \"@fanfanlo\";\r\n\r\nexport interface ISocketSettingData{\r\n    //如果点击开始链接了，那就保持链接，这样需要注意不在开发环境时会不停重连。\r\n    keepConnect:boolean;\r\n    url:string;\r\n}\r\n\r\nasync function createDefSocketSettingData():Promise<ISocketSettingData>{\r\n    const data =  {\r\n        keepConnect:false,\r\n        url:\"\"     \r\n     }\r\n     const res = await storeUtils.getNamespaceStoreWithData('market-dev-socket-setting', {defData:data})\r\n     return res.data;\r\n}\r\n\r\nexport async function getMarketDevSocketSettingData():Promise<ISocketSettingData>{\r\n    return await createDefSocketSettingData()\r\n}","import { AutoWebViewJs } from \"@droid/android\";\r\nimport { Button } from \"@mui/material\";\r\n// import { buildScript, printScript1 } from \"@scripts/script1\";\r\nimport axios from \"axios\";\r\ntype LibPathKey = string\r\nfunction parseUsedLib(s: string) {\r\n    let res: LibPathKey[] = [];\r\n    let reg = /javaLib\\[\\\"(.*)\\\"\\]/g\r\n    let r = s.matchAll(reg);\r\n    for (let a of r) {\r\n        res.push(a[1] as LibPathKey)\r\n    }\r\n    return res;\r\n}\r\nlet beforeJavaLibCreateScript = `\r\nlet isScriptRunnable = true;\r\nlet scriptExitListeners = [];\r\nfunction addScriptExitListener(f){\r\n    removeScriptExitListener(f);\r\n    scriptExitListeners.push(f);\r\n}\r\nfunction removeScriptExitListener(f){\r\n    let index = scriptExitListeners.indexOf(f);\r\n    if(index == -1)return;\r\n    scriptExitListeners.splice(index, 1);\r\n}\r\nfunction onJavaCallTerminate(){\r\n    callScriptExit();\r\n    return true;\r\n}\r\nfunction callJavaExit(){\r\n\r\n}\r\nfunction jsCallComplete(){\r\n    callScriptExit();\r\n    callJavaExit();\r\n}\r\n\r\nfunction jsCallFailed(){\r\n    callScriptExit();\r\n    callJavaExit();\r\n}\r\nfunction callScriptExit(){\r\n    isScriptRunnable = false;\r\n    let res = \"\"\r\n    console.log('before call exit', scriptExitListeners.length);\r\n    scriptExitListeners.forEach((f)=>{f()});\r\n    console.log('after call exit');\r\n    return res;\r\n}\r\n    `\r\nexport function TestScript() {\r\n\r\n    async function onClick() {\r\n        // printScript1('hello script1')\r\n        // runProjectScriptDemo();\r\n    }\r\n    return (\r\n        <>\r\n            <Button onClick={onClick}>script</Button>\r\n        </>\r\n    )\r\n}\r\nexport default TestScript\r\nasync function runProjectScriptDemo() {\r\n    \r\n    const res = await axios.get('/scripts/projectScript07.js')\r\n    const scriptString = res.data\r\n    let dependencies: LibPathKey[] = parseUsedLib(scriptString).concat(parseUsedLib(beforeJavaLibCreateScript));\r\n\r\n    // const conf = buildScript({\r\n    //     script: scriptString, injects: [\"console\", \"a11yModel\"],\r\n    //     optimizationLevel: -1, printScript: false,\r\n    //     scriptId: \"demo.project\"\r\n    // }, dependencies, beforeJavaLibCreateScript)\r\n    // const s = AutoWebViewJs.confToScript(conf);\r\n    // console.log('ssssssssssss', s)\r\n    // AutoWebViewJs.instance.callScriptRunner(s);\r\n    // console.log('code', code)\r\n}","import { IFrameHtmlBuilderOptions } from \"@fanfanlo\";\n\nfunction createHtml(script: string, opts?:IFrameHtmlBuilderOptions) {\n    return `<html>\n    <head>\n    <script type=\"importmap\">\n  {\n    \"imports\": {\n      \"react\": \"https://esm.sh/react@19\",\n      \"react-dom/client\": \"https://esm.sh/react-dom@19/client\"\n    }\n  }\n</script>\n        <script>\n                const IFRAME_ID = '${opts?.iframeId}';\n                window.IFRAME_ID = '${opts?.iframeId}';\n                \n            var autoWebViewJs = window.autoWebViewJs = window.parent.window.autoWebViewJs;\n            autoWebViewJs = window.parent.window.autoWebViewJs;\n            var callScript = window.callScript = autoWebViewJs.callScript;\n            var callScriptByConf = window.callScriptByConf = autoWebViewJs.callScriptByConf;\n            var isRealInAndroid = window.isRealInAndroid;\n            // var storeUtilsConf = window.storeUtilsConf = window.parent.window.storeUtilsConf;\n            var storeUtilsConf = window.storeUtilsConf = {\n                ns:{},\n                read:window.parent.window.storeUtilsConf.read,\n                write:window.parent.window.storeUtilsConf.write   \n            }\n        </script>\n        <title>droid lego</title>\n        <style>html, body{margin-left:-0px;padding:0;\n        background-color: white;}</style>\n    </head>\n    <body>\n        <div id=\"app\"></div>\n        <script>${script}</script>\n        <script>\n                // const IFRAME_ID = '${opts?.iframeId}';\n                function notifyResize() {\n                    const body = document.body;\n                    const html = document.documentElement;\n                    \n                    // 获取实际内容高度（取最大值）\n                    const height = Math.max(\n                        body.scrollHeight,\n                        body.offsetHeight,\n                        html.scrollHeight,\n                        html.offsetHeight\n                    );\n                    \n                    // 获取实际内容宽度\n                    const width = Math.max(\n                        body.scrollWidth,\n                        body.offsetWidth,\n                        html.scrollWidth,\n                        html.offsetWidth\n                    );\n                    \n                    // 发送消息给父窗口\n                    window.parent.postMessage({\n                        type: 'resize',\n                        iframeId: IFRAME_ID,\n                        height,\n                        width\n                    }, '*');\n                }\n                \n                // 监听窗口大小变化\n                window.addEventListener('resize', notifyResize);\n                \n                // 监听DOMContentLoaded，确保DOM加载完毕后调整大小\n                document.addEventListener('DOMContentLoaded', notifyResize);\n                \n                // 监听load事件，确保所有资源加载完毕后调整大小\n                window.addEventListener('load', notifyResize);\n                \n                // 创建MutationObserver监听DOM变化\n                const observer = new MutationObserver(notifyResize);\n                observer.observe(document.documentElement, {\n                    childList: true,\n                    subtree: true,\n                    attributes: true,\n                    characterData: true\n                });\n                \n                // 监听来自父窗口的消息，处理请求重新调整大小的消息\n                window.addEventListener('message', function(event) {\n                    if (event.data && event.data.type === 'requestResize') {\n                        // 主动触发一次尺寸计算和发送\n                        notifyResize();\n                    }\n                });\n                \n                // 初始化大小\n                notifyResize();\n        </script>\n    </body>\n</html>`\n}\n\nfunction mergeHtml(html:string, opts?:IFrameHtmlBuilderOptions){\n    let h = html;\n    if(!h.includes('<body')){\n        h = `<body>${h}</body>`\n    }\n    if(!h.includes('<html')){\n        h = `<html>${h}</html>`\n    }\n    if(!h.includes('<head')){\n        h = h.replace('<html>', '<html><head></head>')\n    }\n    h = h.replace('<head>', `<head><script>\n                const IFRAME_ID = '${opts?.iframeId}';\n                window.IFRAME_ID = '${opts?.iframeId}';\n                \n            var autoWebViewJs = window.autoWebViewJs = window.parent.window.autoWebViewJs;\n            autoWebViewJs = window.parent.window.autoWebViewJs;\n            var callScript = window.callScript = autoWebViewJs.callScript;\n            var callScriptByConf = window.callScriptByConf = autoWebViewJs.callScriptByConf;\n            var isRealInAndroid = window.isRealInAndroid;\n            // var storeUtilsConf = window.storeUtilsConf = window.parent.window.storeUtilsConf;\n            var storeUtilsConf = window.storeUtilsConf = {\n                ns:{},\n                read:window.parent.window.storeUtilsConf.read,\n                write:window.parent.window.storeUtilsConf.write   \n            }\n        </script>\n        \n        <style>html, body{margin-left:-0px;padding:0;\n        background-color: white;}</style>`);\n\n    h = h.replace(`</body>`, `\n        \n        <script>\n                function notifyResize() {\n                    const body = document.body;\n                    const html = document.documentElement;\n                    \n                    // 获取实际内容高度（取最大值）\n                    const height = Math.max(\n                        body.scrollHeight,\n                        body.offsetHeight,\n                        html.scrollHeight,\n                        html.offsetHeight\n                    );\n                    \n                    // 获取实际内容宽度\n                    const width = Math.max(\n                        body.scrollWidth,\n                        body.offsetWidth,\n                        html.scrollWidth,\n                        html.offsetWidth\n                    );\n                    \n                    // 发送消息给父窗口\n                    window.parent.postMessage({\n                        type: 'resize',\n                        iframeId: IFRAME_ID,\n                        height,\n                        width\n                    }, '*');\n                }\n                \n                // 监听窗口大小变化\n                window.addEventListener('resize', notifyResize);\n                \n                // 监听DOMContentLoaded，确保DOM加载完毕后调整大小\n                document.addEventListener('DOMContentLoaded', notifyResize);\n                \n                // 监听load事件，确保所有资源加载完毕后调整大小\n                window.addEventListener('load', notifyResize);\n                \n                // 创建MutationObserver监听DOM变化\n                const observer = new MutationObserver(notifyResize);\n                observer.observe(document.documentElement, {\n                    childList: true,\n                    subtree: true,\n                    attributes: true,\n                    characterData: true\n                });\n                \n                // 监听来自父窗口的消息，处理请求重新调整大小的消息\n                window.addEventListener('message', function(event) {\n                    if (event.data && event.data.type === 'requestResize') {\n                        // 主动触发一次尺寸计算和发送\n                        notifyResize();\n                    }\n                });\n                \n                // 初始化大小\n                notifyResize();\n        </script>\n        </body>`);\n        console.log('hhhhhhhhhhhhh=', h);\n    return h;\n}\nasync function createHtmlByUrl(url: string, opts?:IFrameHtmlBuilderOptions) {\n    const res = await fetch(url);\n    const content = await res.text();\n    return createHtml(content, opts);\n}\nexport const marketHtmlUtils = {\n    createHtml,\n    createHtmlByUrl,\n    mergeHtml\n}","import { Button, Dialog, DialogActions, DialogContent, DialogTitle } from \"@mui/material\"\r\nimport React, { PropsWithChildren, useState } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nexport interface ButtonConfirmProps {\r\n    title?: string | React.ReactNode\r\n    content?: string | React.ReactNode\r\n    confirmText?: string | React.ReactNode\r\n    cancelText?: string | React.ReactNode\r\n    onConfirm?: () => void\r\n    onCancel?: () => void\r\n    onClose?: (confirmed:boolean) => void\r\n    cancelId?: string\r\n    confirmId?: string\r\n}\r\n\r\nexport function ButtonConfirm({ title, content, confirmText, cancelText, onConfirm, onCancel, onClose , cancelId, confirmId, children }: ButtonConfirmProps & PropsWithChildren) {\r\n    const [isOpen, setIsOpen] = useState(false)\r\n    const {t} = useTranslation('fanfanlo/mui/dialog/content')\r\n    return (\r\n        <>\r\n            <span onClick={() => setIsOpen(true)}>\r\n                {children}  \r\n            </span>\r\n            <Dialog open={isOpen} onClose={() => setIsOpen(false)}>\r\n                <DialogTitle>{title || t('ButtonConfirm.title')}</DialogTitle>\r\n                <DialogContent>{content || t('ButtonConfirm.content')}</DialogContent>\r\n                <DialogActions>\r\n                    <Button id={cancelId || 'btn-dialog-button-confirm-cancel'}\r\n                    data-id={cancelId || 'btn-dialog-button-confirm-cancel'}\r\n                    onClick={()=>{setIsOpen(false); onCancel?.();onClose?.(false)}}>{cancelText || t('ButtonConfirm.cancel')}</Button>\r\n                    <Button id={confirmId || 'btn-dialog-button-confirm-confirm'}\r\n                    data-id={confirmId || 'btn-dialog-button-confirm-confirm'}\r\n                    onClick={()=>{setIsOpen(false); onConfirm?.();onClose?.(true)}}>{confirmText || t('ButtonConfirm.confirm')}</Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n        </>\r\n    )\r\n}\r\n","import { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { IActionGroup, IActionData, IActionShellData, IActionJavaData } from \"../action\";\r\nimport { ITriggerGroup, ITriggerData, ITriggerShellData, ITriggerJavaData } from \"../trigger\";\r\nimport { ITriggerActionGroup, ITriggerAction } from \"../trigger-action\";\r\nimport { IProjectData } from \"../project\";\r\nimport { IGroup, GroupCheckList2, GroupCheckList1 } from \"../common\";\r\nimport { IChildToProjectData, projectDataToUniqueId } from \"../utils\";\r\nimport { StorePageContext, toProxy, useWatchUpdates, watchUpdates } from \"@fanfanlo\";\r\nimport _ from \"lodash\";\r\n\r\nexport const ProjectContext = createContext<IProjectData>({} as IProjectData)\r\n\r\nexport const TriggerActionGroupContext = createContext<ITriggerActionGroup>({} as ITriggerActionGroup)\r\n\r\nexport const TriggerActionContext = createContext<ITriggerAction>({} as ITriggerAction)\r\n\r\nexport const TriggerGroupContext = createContext<ITriggerGroup>({} as ITriggerGroup)\r\n\r\nexport const TriggerListContext = createContext<ITriggerData<ITriggerShellData, ITriggerJavaData>[]>([] as ITriggerData<ITriggerShellData, ITriggerJavaData>[])\r\n\r\nexport const TriggerContext = createContext<ITriggerData<ITriggerShellData, ITriggerJavaData>>({} as ITriggerData<ITriggerShellData, ITriggerJavaData>)\r\n\r\nexport const ActionGroupContext = createContext<IActionGroup>({} as IActionGroup)\r\n\r\nexport const ActionListContext = createContext<IActionData<IActionShellData, IActionJavaData>[]>([] as IActionData<IActionShellData, IActionJavaData>[])\r\n\r\nexport const ActionContext = createContext<IActionData<IActionShellData, IActionJavaData>>({} as IActionData<IActionShellData, IActionJavaData>)\r\n\r\nexport const GroupContext = createContext<IGroup<any>>({} as IGroup<any>)\r\n\r\nexport const GroupCheckList2Context = createContext<GroupCheckList2>([] as GroupCheckList2)\r\n\r\nexport const GroupCheckList1Context = createContext<GroupCheckList1>([] as GroupCheckList1)\r\n\r\n\r\nexport function useProjectUniqueKeyValue<T>(initProjectInfoFn:(projectInfo: IChildToProjectData) => void, key:string, defValue:T):[T, (v:T) => void, string]{\r\n    const projectInfo: IChildToProjectData = {}\r\n    initProjectInfoFn(projectInfo)\r\n    const store = useContext(StorePageContext);\r\n    const uniqueKey = `${key}:${projectDataToUniqueId(projectInfo)}`\r\n    const [value, _setValue] = useState<T>(store.get(uniqueKey) as T || defValue)\r\n    function setValue(v:T){\r\n        _setValue(v)\r\n        store.set(uniqueKey, v)\r\n    }\r\n    const v = _.isObject(value) ? toProxy(value) : value\r\n    if(_.isObject(value)){\r\n        useEffect(()=>{\r\n            watchUpdates(value, (info)=>{\r\n                store.set(uniqueKey, v)\r\n                // 这里逻辑上返回的v是重新构建的，所以其它地方引用v的时候需要注意删除侦听，或者这里得寻找统一方法处理\r\n                // setValue((_.isArray(value) ? [...value] : {...value}) as T)\r\n            })\r\n        }, [])\r\n    }\r\n    return [v, setValue, uniqueKey]\r\n}","import validator from \"validator\";\r\nimport { loadI18nValue } from \"../../i18n\";\r\nexport function isValidWebSocketURL(url: string): boolean {\r\n    if(!url)return false;\r\n    return validator.isURL(url, { protocols: ['ws','wss'], require_protocol: true });\r\n  }\r\n  \r\n\r\nexport enum SocketConnectStatusEnum {\r\n    connecting = \"connecting\",\r\n    connected = \"connected\",\r\n    disconnecting = \"disconnecting\",\r\n    disconnected = \"disconnected\",\r\n    waitRetry = \"waitRetry\"\r\n}\r\n\r\nexport async function getSocketConnectStatusEnumI18n(status:SocketConnectStatusEnum){\r\n    return await loadI18nValue('fanfanlo/utils/socket/content', `status.${status}`);\r\n}","'use client';\r\nimport { BottomNavigation, BottomNavigationAction, Box, CssBaseline, Paper, Stack } from '@mui/material';\r\n\r\nimport HomeIcon from '@mui/icons-material/Home';\r\nimport SettingsIcon from '@mui/icons-material/Settings';\r\nimport StorefrontIcon from '@mui/icons-material/Storefront';\r\nimport { useRouter } from 'next/router';\r\nimport { PropsWithChildren } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { ITitleI18nConf } from '../page';\r\nimport AndroidPageContent from '../page/AndroidPageContent';\r\nimport CreateIcon from '@mui/icons-material/Create';\r\ninterface TabInfoType {\r\n  label: string;\r\n  value: string;\r\n  icon: React.ReactNode;\r\n}\r\n\r\nfunction BottomBar() {\r\n  return <Paper\r\n    id=\"bottom-navigation\"\r\n    sx={{ position: 'fixed', bottom: 0, left: 0, right: 0 }}\r\n    elevation={3}>\r\n    <NavBar />\r\n  </Paper>;\r\n}\r\nexport function NavBar() {\r\n  const router = useRouter();\r\n  const { pathname } = router;\r\n  const { t } = useTranslation('app-ui/components/tabbar/content');\r\n  const tabInfoList: TabInfoType[] = [\r\n    { label: t('content.home'), value: '/', icon: <HomeIcon /> },\r\n    // { label: t('content.create'), value: '/script-creator', icon: <CreateIcon /> },\r\n    // { label: t('content.market'), value: '/market', icon: <StorefrontIcon /> },\r\n    { label: t('content.settings'), value: '/settings', icon: <SettingsIcon /> },\r\n  ];\r\n  return (\r\n\r\n    <BottomNavigation showLabels value={pathname}>\r\n      {tabInfoList.map(e => (\r\n        <BottomNavigationAction\r\n          key={e.value}\r\n          label={e.label}\r\n          icon={e.icon}\r\n          data-id={`tabbar-${e.value}`}\r\n          className={pathname === e.value ? 'Mui-selected' : ''}\r\n          onClick={() => {\r\n            if (pathname === e.value) return;\r\n            router.push(e.value);\r\n          }}\r\n        />\r\n      ))}\r\n    </BottomNavigation>\r\n  );\r\n}\r\n\r\n\r\n// testWatchUpdates()\r\nexport function TabbarContainer({ children, titleConf }: {titleConf?:ITitleI18nConf} & PropsWithChildren)  {\r\n  return (\r\n    <Box sx={{ display: 'flex', flexDirection: 'column', height: '100vh' }}>\r\n      <CssBaseline />\r\n      <Stack direction={\"column\"} spacing={3}\r\n      \r\n      >\r\n        <AndroidPageContent titleConf={titleConf}>\r\n          {children}\r\n        </AndroidPageContent>\r\n        <BottomBar />\r\n      </Stack>\r\n    </Box>\r\n  );\r\n}\r\n\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"permissionComponentsSpanPadding\":\"components_permissionComponentsSpanPadding___8iUl\",\"danger\":\"components_danger__at2U4\",\"pass\":\"components_pass__QEjyt\"};","export * from \"./i18n-resources\"","export * from './android-listener-shell'\r\nexport * from './androidDispatchers'\r\nexport * from './AutoWebViewJs'\r\nexport * from './jsbridge'\r\nexport * from './WebViewJs'\r\nexport * from './win/index'\r\nexport * from './components/'\r\nexport * from './is-in-android'\r\nexport * from './scripts'\r\nexport * from './mock/mock'","import { Dispatcher, isValidWebSocketURL, SocketConnectStatusEnum, toProxy } from \"@fanfanlo\";\r\nimport { IMarketDevConnectEventType, IMarketDevEvent } from \"@market/lib\";\r\nimport { getMarketDevSocketSettingData } from \"./market-dev-socket-setting-data\";\r\nconst dispatcher = new Dispatcher();\r\ninterface ISocketConnectInfo{\r\n    status:SocketConnectStatusEnum;\r\n    retryCount:number;\r\n}\r\n\r\nexport const socketConnectInfo:ISocketConnectInfo = toProxy({\r\n    status:SocketConnectStatusEnum.disconnected,\r\n    retryCount:0\r\n})\r\nlet ws:WebSocket|undefined;\r\nasync function connect(){\r\n    const url = (await getMarketDevSocketSettingData()).url\r\n    if(!isValidWebSocketURL(url)){\r\n        return;\r\n    }\r\n    socketConnectInfo.status = SocketConnectStatusEnum.connecting;\r\n    const w = ws = new WebSocket(url);\r\n    w.onopen = () => {\r\n        socketConnectInfo.status = SocketConnectStatusEnum.connected;\r\n        toGetAllScripts();\r\n    }\r\n    w.onclose = () => {\r\n        console.log('oscket on close', arguments)\r\n        socketConnectInfo.status = SocketConnectStatusEnum.disconnected;\r\n        checkNeedRetry();\r\n    }\r\n    w.onerror = () => {\r\n        console.log('socket onerror', arguments)\r\n        socketConnectInfo.status = SocketConnectStatusEnum.disconnected;\r\n        close();\r\n        checkNeedRetry();\r\n    }\r\n    w.onmessage = (e:MessageEvent) => {\r\n        try{\r\n            const event:IMarketDevEvent<any> = JSON.parse(e.data)\r\n            console.log('market dev socket onmessage', event.type)\r\n            dispatcher.dispatch(event.type, event.data)\r\n        }catch(e){\r\n            console.error(e)\r\n        }\r\n    }\r\n\r\n    async function toGetAllScripts(){\r\n        const event = {type: IMarketDevConnectEventType.getAllScripts}\r\n        w.send(JSON.stringify(event));\r\n    }\r\n}\r\nfunction close(){\r\n    if(!ws)return;\r\n    ws.close();\r\n    ws = undefined;\r\n}\r\nasync function checkNeedRetry(){\r\n    const settingData = await getMarketDevSocketSettingData()\r\n    if(!settingData.keepConnect){\r\n        return;\r\n    }\r\n    socketConnectInfo.retryCount++;\r\n    setTimeout(()=>{\r\n        connect();\r\n    }, 1000 * 5)\r\n}\r\nfunction disconnect(){\r\n    if(ws){\r\n        ws.close();\r\n        ws = undefined;\r\n    }\r\n    socketConnectInfo.status = SocketConnectStatusEnum.disconnected;\r\n}\r\nexport const marketsDevSocket = {\r\n    connect,\r\n    disconnect,\r\n    socketConnectInfo,\r\n    dispatcher\r\n}\r\n","import { createProjectDefultData, IProjectData, projectStore } from \"@droid/project-interface\"\r\nimport { Button } from \"@mui/material\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { useRouter } from \"next/router\"\r\nexport const CreateProjectButton = () => {\r\n    const {t} = useTranslation(\"droid-project/project/ui/components/content\")\r\n    const router = useRouter()\r\n    async function onCreateProjectClick(){\r\n        const project:IProjectData = createProjectDefultData()\r\n        projectStore.addDraft(project)\r\n        const path = `/project-editor?id=${project.id}`\r\n        await router.prefetch(path)\r\n        router.push(path)\r\n    }\r\n    return <span><Button data-id={\"create-project-button.b79975b3-cc10-4e3e-bc05-478a98c925b5\"} \r\n    data-typeof-create-project-id=\"create-project-btn-from-ui-components-create-project-button\"\r\n    id=\"typeof-create-project-id-create-project-btn-from-ui-components-create-project-button\"\r\n    onClick={onCreateProjectClick}>{t('content.create')}</Button></span>\r\n}\r\n\r\n","import { IProjectData } from \"@droid/project-interface\"\r\n\r\nexport const projectUtils = {\r\n    getProjectName: (project?: IProjectData):string => {\r\n        return project?.localName || project?.name || project?.id.slice(project?.id.length - 8) || ''\r\n    }\r\n}\r\n\r\n","import { ProjectContext, projectStore } from \"@droid/project-interface\"\r\nimport { ButtonConfirm } from \"@fanfanlo\"\r\nimport { Box, Button } from \"@mui/material\"\r\nimport { useContext } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nexport function DeleteProjectButton() {\r\n    const { t } = useTranslation(\"droid-project/project/ui/components/content\")\r\n    const project = useContext(ProjectContext)\r\n    const projectId = project.id\r\n    const handleDelete = () => {\r\n        projectStore.deleteProject(projectId)\r\n    }\r\n    const content = <Box style={{textAlign: 'center'}}>\r\n        <span style={{color:\"#FF0000\"}}>{project.name}</span>\r\n        <br/>\r\n        <span>{t('content.confirmDelete')}</span>\r\n    </Box>\r\n    return (\r\n        <>\r\n            <ButtonConfirm\r\n            title={t('content.title')}  \r\n            content={content}\r\n            onConfirm={handleDelete}>\r\n                <Button\r\n                id=\"project-simple-title-list-del-btn\"\r\n                data-id=\"project-simple-title-list-del-btn\"\r\n                >\r\n                    {t('content.delete')}\r\n                </Button>\r\n            </ButtonConfirm>\r\n        </>\r\n    )\r\n}\r\n","import { childToProjectDataUtils, IProjectData, ProjectContext } from \"@droid/project-interface\";\r\nimport { Box, Button, Grid2 } from \"@mui/material\";\r\nimport { useRouter } from \"next/router\";\r\nimport { PropsWithChildren } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { projectUtils } from \"../../utils/projectUtils\";\r\nimport { DeleteProjectButton } from \"../components/DeleteProjectButton\";\r\nfunction ProjectName({ project }: PropsWithChildren & { project: IProjectData }) {\r\n    const router = useRouter()\r\n    const { t } = useTranslation('droid-project/project/ui/project/content')\r\n    function edit() {\r\n        const path = `/project-editor?id=${project.id}`\r\n        router.push(path, undefined, {shallow: true})\r\n    }\r\n    return (\r\n        <Grid2 container spacing={2} sx={{ width: \"100%\" }}\r\n        >\r\n            <Grid2 size={\"grow\"}>\r\n                <span >{projectUtils.getProjectName(project)}</span>\r\n            </Grid2>\r\n            <Grid2 container spacing={2}>\r\n                <Button\r\n                    {...childToProjectDataUtils.getProjectElementsId({ project }, 'project-list-edit-btn')}\r\n                   \r\n                    data-listof-project-list-edit-btn-id={project.id} \r\n                    id=\"project-simple-title-list-edit-btn\" \r\n                    data-id=\"project-simple-title-list-edit-btn\" \r\n                    onClick={edit}>{t('content.project.edit')}</Button>\r\n                <DeleteProjectButton />\r\n            </Grid2>\r\n        </Grid2>\r\n    )\r\n}\r\n\r\nexport function ProjectUI({ project }: PropsWithChildren & { project: IProjectData }) {\r\n    return (\r\n        <ProjectContext.Provider value={project}>\r\n            <Box sx={{ width: \"100%\", backgroundColor: \"#f0f0f0\", padding: 1 }}\r\n                data-id={project.id}\r\n                {...childToProjectDataUtils.getProjectElementsId({ project })}>\r\n                <ProjectName project={project} />\r\n            </Box>\r\n        </ProjectContext.Provider>\r\n    )\r\n}","import { IProjectData, projectStore } from \"@droid/project-interface\"\r\nimport { loadI18nValue, watchUpdates } from \"@fanfanlo\"\r\nimport { Box, List, ListItem } from \"@mui/material\"\r\nimport { use, useEffect, useState } from \"react\"\r\nimport { useTranslation } from \"react-i18next\"\r\nimport { CreateProjectButton } from \"../components/CreateProjectButton\"\r\nimport { ProjectUI } from \"../project/ProjectUI\"\r\nfunction ProjectsTitle() {\r\n    const { t } = useTranslation('droid-project/project/ui/projects/content')\r\n    // const v = use(loadI18nValue('droid-project/project/ui/projects/content', 'content.projects'))\r\n    // console.log('ttttttttttttttttttttttt', v, 'tttt', t)\r\n    return <div>\r\n        <h4>{t('content.projects')}</h4>\r\n        {/* <h4>{v}</h4> */}\r\n    </div>\r\n}\r\n\r\nfunction ProjectList({ projects }: { projects: IProjectData[] }) {\r\n    return (\r\n        <List sx={{width:\"100%\"}}>\r\n            {projects.length > 0 && projects.map((project) => (\r\n                <ListItem sx={{width:\"100%\"}} key={project.id}>\r\n                    <ProjectUI key={project.id} project={project} />\r\n                </ListItem>\r\n            ))}\r\n        </List>\r\n    )\r\n}\r\nfunction Projects() {\r\n    const { t } = useTranslation('droid-project/project/ui/projects/content')\r\n\r\n    const [projects, setProjects] = useState<IProjectData[]>(projectStore.getListCopy())\r\n    useEffect(() => {\r\n        const unsub = watchUpdates(projectStore.list, () => {\r\n            setProjects(projectStore.getListCopy())\r\n        })\r\n        return () => {\r\n            unsub()\r\n        }\r\n    }, [])\r\n    return <Box>\r\n        <CreateProjectButton />\r\n        {projects.length == 0 && <Box>\r\n            <Box>\r\n                <span>{t('content.noProjects')}</span>\r\n                {/* <CreateProjectButton /> */}\r\n                <span>{t('content.orFindFromMarket')}</span>\r\n            </Box>\r\n        </Box>}\r\n        {projects.length > 0 && <ProjectList projects={projects} />}\r\n    </Box>\r\n}\r\n\r\nexport function ProjectsUI() {\r\n    return (<Box>\r\n        <ProjectsTitle />\r\n        <Projects />\r\n    </Box>)\r\n}\r\n","import { androidDispatchers, autoWebViewJs, openHtmlShowA11yNodeInfoButton } from \"@droid/android\";\r\nimport { IA11yNodeInfo } from \"@droid/project-interface\";\r\nimport { toProxy, useProxyWatch, useTranslation } from \"@fanfanlo\";\r\nimport { Button } from \"@mui/material\";\r\nimport { ulid } from \"ulid\";\r\n\r\nconst data = toProxy({opened:false})\r\nasync function onClick() {\r\n\r\n    if(data.opened)return;\r\n    const eventType = \"a11yNodeSelectActionItem\"\r\n    const selectEventIndex = autoWebViewJs.shellListen(androidDispatchers.WebViewJsDispatcher.name, eventType, eventType, false, onSelectNode)\r\n    function onSelectNode(s: string) {\r\n        clear()\r\n        autoWebViewJs.clipboardSetText(s)\r\n        // const info: IA11yNodeInfo = JSON.parse(s)\r\n        // console.log('fffffffffffffff', s)\r\n    }\r\n    function clear(){\r\n        data.opened = false;\r\n        console.log('ccccccccccclear')\r\n        autoWebViewJs.shellRemoveListen(androidDispatchers.WebViewJsDispatcher.name, selectEventIndex);\r\n        autoWebViewJs.shellRemoveListen(androidDispatchers.Window.name, exitWindowIndex);\r\n        if(exitWebviewJsIndex){\r\n            autoWebViewJs.removeListen(androidDispatchers.Window.name, parseInt(exitWebviewJsIndex));\r\n        }\r\n    }\r\n    const windowId = ulid()\r\n    openHtmlShowA11yNodeInfoButton(eventType, windowId)\r\n    data.opened = true;\r\n    const et = `window-${windowId}-dismiss`\r\n    const {javaResultString:exitWebviewJsIndex, errMsg} = autoWebViewJs.listen(androidDispatchers.Window.name, et, et, true)\r\n    if(errMsg){\r\n        throw new Error(errMsg)\r\n    }\r\n    const exitWindowIndex = autoWebViewJs.shellListen(androidDispatchers.Window.name, et, et, true, ()=>{\r\n        clear()\r\n    });\r\n}\r\nexport function OpenA11yNodeButton() {\r\n    const { t } = useTranslation('homepage/components/a11y/content')\r\n    const [opened] = useProxyWatch(data, 'opened', data.opened)\r\n    return <>\r\n        <Button onClick={onClick} disabled={opened}>{t(\"open-a11y-node-button.btnName\")}</Button>\r\n    </>\r\n}","import { autoWebViewJs } from \"@droid/android\";\r\nimport { Box, Button, Modal } from \"@mui/material\";\r\nimport { useEffect, useState } from \"react\";\r\n\r\nexport function AndroidSettingsInfo() {\r\n    const [permissions, setPermissions] = useState<string[]>([])\r\n    const [open, setOpen] = useState(false)\r\n    const onSettingClick = () => {\r\n        const script = `\r\n        com.fanfanlo.lib.utils.PermissionUtils.openAppSettings();`\r\n        autoWebViewJs.callScript(script);\r\n    }\r\n    const handleClose = () => {\r\n      setOpen(false);\r\n    };\r\n    useEffect(()=>{\r\n        const script = \r\n        `\r\n        var data = com.fanfanlo.lib.utils.PermissionUtils.getGrantedPermissions();\r\n        var res = com.fanfanlo.lib.utils.JsonUtil.gson2.toJson(data);\r\n        res;\r\n        `\r\n        const res = autoWebViewJs.callScript<string[]>(script)\r\n        if(res.javaResultData){\r\n            setPermissions(res.javaResultData)\r\n        }\r\n    }, [])\r\n    return (\r\n        <>\r\n            <Box>\r\n                <Box>\r\n                    <span>授权</span>\r\n                    <Button onClick={onSettingClick}>打开设置页</Button>\r\n                    <Button onClick={() => setOpen(true)}>已授权</Button>\r\n                </Box>\r\n            </Box>\r\n            <Modal open={open}\r\n        onClose={handleClose}>\r\n                <Box sx={{bgcolor:\"background.paper\", p:2}}>\r\n                    <Box><span>已授权的权限</span><Button onClick={handleClose}>关闭</Button></Box>\r\n                    <ul>\r\n                        {permissions.map((p, i) => <li style={{wordBreak:\"break-all\",wordWrap:\"break-word\"}} key={i}>{p.replace('android.permission', '')}</li>)}\r\n                    </ul>\r\n                </Box>\r\n            </Modal>\r\n        </>\r\n    )\r\n}","import { AutoWebViewJs } from \"../../AutoWebViewJs\"\r\n\r\n\r\nlet script = `com.fanfanlo.lib.sys.Sys.killMyApp()`\r\nexport function appKillSelf(){\r\n    AutoWebViewJs.instance.callScript(script)\r\n}","import { appKillSelf } from \"@droid/android\";\r\nimport { useTranslation } from \"@fanfanlo\";\r\nimport { Button } from \"@mui/material\";\r\nimport toast from \"react-hot-toast\";\r\n\r\nexport function KillSelf(){\r\n    const {t} = useTranslation(\"homepage/components/app/kill-self/content\")\r\n    async function onClick(){\r\n        toast.success(t(\"KillSelf.toast\"))\r\n        await new Promise(r=>setTimeout(r, 1000 * 1))\r\n        appKillSelf()\r\n    }\r\n    return(\r\n        <>\r\n            <Button onClick={onClick}>\r\n                {t(\"KillSelf.name\")}\r\n            </Button>\r\n        </>\r\n    )\r\n}","import { Button } from \"@mui/material\";\r\nimport {useRouter} from \"next/router\";\r\nimport {useTranslation} from \"@fanfanlo\"\r\nexport function AddExternalMarketButton(){\r\n    const router = useRouter()\r\n    const {t} = useTranslation('homepage/components/markets/content');\r\n    function onClick(){\r\n        router.push(\"/add-market\")\r\n    }\r\n    return (\r\n        <Button onClick={onClick}>\r\n            {t(\"AddExternalMarketButton.name\")}\r\n        </Button>\r\n    )\r\n}","import React, { useState } from 'react';\r\nimport { Button, Menu, MenuItem } from '@mui/material';\r\nimport AddIcon from '@mui/icons-material/Add';\r\nimport { useTranslation } from '@fanfanlo';\r\nimport { useRouter } from 'next/router';\r\ninterface IMenuItemData{\r\n    name:string\r\n    url:string\r\n}\r\nexport const MainPageAddButtons: React.FC = () => {\r\n    const router = useRouter();\r\n    const [anchorEl, setAnchorEl] = useState<null | HTMLElement>(null);\r\n    const open = Boolean(anchorEl);\r\n\r\n    const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\r\n        setAnchorEl(event.currentTarget);\r\n    };\r\n\r\n    const handleClose = () => {\r\n        setAnchorEl(null);\r\n    };\r\n\r\n    const {t} = useTranslation('homepage/components/markets/main-page-add-buttons/content')\r\n    const menuItems:IMenuItemData[] = [\r\n        {\r\n            name:t(\"content.sub.addScriptByUrl\"),\r\n            url:\"/listen-editing-market\"\r\n        },\r\n        {\r\n            name:t(\"content.sub.addScriptByText\"),\r\n            url:\"/add-market-by-text\"\r\n        },\r\n        {\r\n            name:t(\"content.sub.addMarket\"),\r\n            url:\"/add-market-by-url\"\r\n        },\r\n        {\r\n            name:t(\"content.sub.addMarketByText\"),\r\n            url:\"/listen-editing-market\"\r\n        }\r\n    ]\r\n    return (\r\n        <>\r\n            <Button\r\n                variant=\"contained\"\r\n                startIcon={<AddIcon />}\r\n                onClick={handleClick}\r\n            >\r\n                {t(\"content.add\")}\r\n            </Button>\r\n            <Menu\r\n                anchorEl={anchorEl}\r\n                open={open}\r\n                onClose={handleClose}\r\n            >\r\n                {menuItems.map((item, index) => (\r\n                    <MenuItem \r\n                        key={index}\r\n                        onClick={() => {\r\n                            handleClose();\r\n                            router.push(item.url);\r\n                        }}\r\n                    >\r\n                        {item.name}\r\n                    </MenuItem>\r\n                ))}\r\n            </Menu>\r\n        </>\r\n    );\r\n};","import { useTranslation } from \"@fanfanlo\";\r\nimport { Box, Button } from \"@mui/material\";\r\nimport Link from \"next/link\";\r\nimport { useRouter } from \"next/router\";\r\n\r\nexport function MarketsDevSettingsOpenLinkButton(){\r\n    const router = useRouter();\r\n    const {t} = useTranslation('homepage/components/page/markets-dev-settings/open-link-button/content');\r\n    async function onClick(){\r\n        const bl = await router.push(\"/markets-dev-settings\");\r\n    }\r\n    return(\r\n        <>\r\n        <Button onClick={onClick}>{t(\"content.name\")}</Button>\r\n        </>\r\n    )\r\n}\r\n\r\nexport function MarketsDevSettingsLineOpenLinkButton(){\r\n    return(\r\n        <>\r\n            <Box sx={{mt:2, mb:2}}>\r\n                <MarketsDevSettingsOpenLinkButton />\r\n            </Box>\r\n        </>\r\n    )\r\n}","import { useState } from 'react';\nimport { Box, Stack, TextField, Button, Select, MenuItem, FormControl, InputLabel } from '@mui/material';\nimport { isValidPhoneNumber, parsePhoneNumber, getCountryCallingCode } from 'libphonenumber-js';\nimport type { CountryCode } from 'libphonenumber-js';\nimport { autoWebViewJs } from '@droid/android';\n\n// 常用国家列表，可根据实际需求扩展\nconst COUNTRY_LIST: { code: CountryCode; name: string }[] = [\n  { code: 'CN', name: '中国' },\n  { code: 'US', name: '美国' },\n  { code: 'GB', name: '英国' },\n  { code: 'IN', name: '印度' },\n  { code: 'JP', name: '日本' },\n  { code: 'KR', name: '韩国' },\n  { code: 'DE', name: '德国' },\n  { code: 'FR', name: '法国' },\n  { code: 'RU', name: '俄罗斯' },\n  { code: 'BR', name: '巴西' },\n];\n\n// 生成短信发送脚本\nfunction runSendSmsScript(msg: string, targetNumber: string, senderNumber?: string, simSlot?: number) {\n  const script = `com.fanfanlo.lib.sms.SmsSender.sendSms(\"${targetNumber}\", \"${msg}\", \"${senderNumber || ''}\", ${simSlot || 0}, true, \"\", function(){java.lang.System.out.println('321 sms sent')})`;\n  autoWebViewJs.callScript(script);\n}\n\n// 手机号校验\nfunction validatePhoneNumber(input: string, defaultCountry: CountryCode) {\n  let number = input.trim();\n  if (!number) return false;\n  if (!number.startsWith('+')) {\n    try {\n      const phoneNumber = parsePhoneNumber(number, defaultCountry);\n      return phoneNumber.isValid();\n    } catch {\n      return false;\n    }\n  } else {\n    return isValidPhoneNumber(number);\n  }\n}\n\nexport function SendSms() {\n  const [msg, setMsg] = useState('can you hear me');\n  const [targetNumber, setTargetNumber] = useState('16553511099');\n  const [senderNumber, setSenderNumber] = useState('13121129569');\n  const [country, setCountry] = useState<CountryCode>('CN');\n  const [targetNumberError, setTargetNumberError] = useState('');\n  const [senderNumberError, setSenderNumberError] = useState('');\n\n  function handleTargetNumberChange(e: any) {\n    const v = e.target.value;\n    setTargetNumber(v);\n    if (!validatePhoneNumber(v, country)) {\n      setTargetNumberError('目标手机号格式无效');\n    } else {\n      setTargetNumberError('');\n    }\n  }\n\n  function handleSenderNumberChange(e: any) {\n    const v = e.target.value;\n    setSenderNumber(v);\n    if (v && !validatePhoneNumber(v, country)) {\n      setSenderNumberError('发件人手机号格式无效');\n    } else {\n      setSenderNumberError('');\n    }\n  }\n\n  function sendSms() {\n    if (!validatePhoneNumber(targetNumber, country)) {\n      setTargetNumberError('目标手机号格式无效');\n      return;\n    }\n    if (senderNumber && !validatePhoneNumber(senderNumber, country)) {\n      setSenderNumberError('发件人手机号格式无效');\n      return;\n    }\n    // TODO: 调用原有发送逻辑\n    // alert('手机号校验通过，可以发送短信');\n    const script = runSendSmsScript(msg, targetNumber, senderNumber);\n    // ...\n  }\n\n  return (\n    <Box>\n      <Stack direction=\"column\" spacing={2}>\n        <Box className=\"abcedfg\">\n          <FormControl sx={{mt:\"0.5rem\"}}>\n            <InputLabel id=\"country-label\">国家</InputLabel>\n            <Select\n              labelId=\"country-label\"\n              value={country}\n              label=\"国家\"\n              onChange={e => setCountry(e.target.value as CountryCode)}\n              sx={{ width: 180 }}\n            >\n              {COUNTRY_LIST.map(item => (\n                <MenuItem key={item.code} value={item.code}>\n                  {item.name} (+{getCountryCallingCode(item.code as CountryCode)})\n                </MenuItem>\n              ))}\n            </Select>\n          </FormControl>\n        </Box>\n        <TextField\n          label=\"目标手机号\"\n          value={targetNumber}\n          onChange={handleTargetNumberChange}\n          error={!!targetNumberError}\n          helperText={targetNumberError || '请输入国际格式或本地格式手机号'}\n        />\n        <TextField\n          label=\"发件人手机号（可选）\"\n          value={senderNumber}\n          onChange={handleSenderNumberChange}\n          error={!!senderNumberError}\n          helperText={senderNumberError || '如需指定发件人，可填写'}\n        />\n        <TextField\n          label=\"短信内容\"\n          value={msg}\n          onChange={e => setMsg(e.target.value)}\n          multiline\n          rows={3}\n        />\n        <Button\n          variant=\"contained\"\n          onClick={sendSms}\n          disabled={\n            !targetNumber || !!targetNumberError || !!senderNumberError || !msg\n          }\n        >\n          发送短信\n        </Button>\n      </Stack>\n    </Box>\n  );\n}","import { autoWebViewJs, ICallScriptRunnerResult, isRealInAndroid, Manifest } from \"@droid/android\";\r\nimport { Box, Button, Dialog, Modal, Paper, Stack, TextField } from \"@mui/material\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { v4 as uuidv4 } from 'uuid';\r\nfunction getScript(){\r\n    const script = `\r\n\r\nvar domain = {}\r\nvar smsEventType = \"smsReceived\";\r\nvar smsDispatcher = com.fanfanlo.lib.smstransfer.receiver.SmsReceiver.dispatcher;\r\n\r\nfunction runAskPermissions(){\r\n    com.fanfanlo.lib.utils.PermissionUtils.askPermissions([\"${Manifest.Permission.RECEIVE_SMS}\",\"${Manifest.Permission.READ_SMS}\", \"${Manifest.Permission.READ_PHONE_STATE}\", \"${Manifest.Permission.READ_PHONE_NUMBERS}\", \"${Manifest.Permission.READ_CALL_LOG}\"], {\r\n        onGranted:function(permissions, granted){\r\n            if(granted){\r\n                runScriptAfterHasPermissions();\r\n            }\r\n        },\r\n        onDenied:function(permissions, doNotAskAgain){\r\n        }\r\n    });\r\n}\r\nrunAskPermissions();\r\n\r\nfunction runScriptAfterHasPermissions(){\r\n    function onSmsReceived(data){\r\n        java.lang.System.out.println(\"js sms received sender is \" + data.sender + \" sms is \" + data.msg + \" receive time is \" + data.time + \"receiver number is\" + data.receiver + \" slot is \" + data.slot);\r\n        sendMsm(data);\r\n        sendMail(data);\r\n    }\r\n    smsDispatcher.addListener(smsEventType, onSmsReceived, false, domain);\r\n}\r\n\r\nfunction sendMsm(data){\r\n    // var key = \"57a60ecf-4c79-4b3d-b0ad-aa4e70e70d40:\" + data.receiver ? data.receiver : \"abc\";\r\n    var key = \"${localStorage.getItem(nsMobilePathKey)}\";\r\n    if(!key || key == 'null'){\r\n        return;\r\n    }\r\n    // var url = \"https://d.shangwoa.top/redis-set-sms-upstash\";\r\n    var url = \"${localStorage.getItem(nsSendSmsUrlKey)}\";\r\n    if(!url || url == 'null'){return;}\r\n    var body = com.fanfanlo.lib.utils.JsonUtil.gson2.toJson({k:key, v:data});\r\n    com.fanfanlo.lib.utils.UIThreadUtil.runInNewThread(function(){\r\n        com.fanfanlo.lib.net.HttpUtils.post(url, body);\r\n    });\r\n}\r\n    function sendMail(data){\r\n    var to = \"${localStorage.getItem(nsEmailKey)}\";\r\n    if(!to || to == 'null'){return;}\r\n    var auth = \"${localStorage.getItem(nsResendAuthKey)}\";\r\n    if(!auth || auth == 'null'){return;}\r\n    java.lang.System.out.println(\"start send mail\");\r\n    var url = \"${resendAipUrl}\";\r\n        if(!url || url == 'null'){return;}\r\n        var body = {\r\n            from: \"onboarding@resend.dev\",\r\n            to: to,\r\n            subject: String(\"new message from \" + data.sender),\r\n            html: String(\"<div><p>content:\" + data.msg + \"</p><p>from:\" + data.sender + \"</p><p>time:\" + data.time + \"</p><p>receiver:\" + data.receiver + \"</p><p>slot:\" + data.slot + \"</p></div>\")\r\n        };\r\n        var header = {\r\n            \"Authorization\": String(\"Bearer \" + auth),\r\n            \"Content-Type\": \"application/json\"\r\n        }\r\n        com.fanfanlo.lib.utils.UIThreadUtil.runInNewThread(function(){\r\n            com.fanfanlo.lib.net.HttpUtils.post(url, body, header);\r\n        });\r\n        java.lang.System.out.println(\"end send mail\");\r\n    }\r\nfunction onJavaCallTerminate(){\r\n    smsDispatcher.removeDomainListeners(domain);\r\n    return true;\r\n}\r\n`;\r\n    return script;\r\n}\r\nconst scriptId = 'fanfanlo/sms/listener/1';\r\n\r\nconst isRunningScript = `\r\n// var data = com.fanfanlo.droidlib.auto.rhino.RhinoManager.isRunning(\"${scriptId}\");\r\nvar data = com.fanfanlo.droidlib.auto.js.JsManager.isRunning(\"${scriptId}\");\r\n\r\nvar res = com.fanfanlo.lib.utils.JsonUtil.gson2.toJson(data);\r\n\r\nres;\r\n`\r\n\r\nconst stopScript = `\r\n// var data = com.fanfanlo.droidlib.auto.rhino.RhinoManager.stopById(\"${scriptId}\");\r\nvar data = com.fanfanlo.droidlib.auto.js.JsManager.stopById(\"${scriptId}\");\r\nvar res = com.fanfanlo.lib.utils.JsonUtil.gson2.toJson(data);\r\nres;\r\n`\r\n\r\nfunction getScriptConf() {\r\n    return {\r\n        injects: [\"console\"],\r\n        onlyRunSingle: true,\r\n        stopPrevIfOnlyRunSingle: true,\r\n        scriptId,\r\n        script: getScript()\r\n    }\r\n}\r\ninterface IStopByIdResult {\r\n    total: number\r\n    stoped: number\r\n}\r\nlet runnerResult: ICallScriptRunnerResult | undefined;\r\nfunction testUrl(str: string) {\r\n    const urlPattern = /^https?:\\/\\/[^\\s/$.?#].[^\\s]*$/i;\r\n    if (!urlPattern.test(str)) {\r\n        // console.log('not legal url', str);\r\n        return '';\r\n    }\r\n    try {\r\n        const u = new URL(str);\r\n        const parts = u.hostname.split(\".\");\r\n        // console.log(`u.hostname.split(\".\")`, u.hostname.split(\".\"))\r\n        if (\r\n            parts.length < 2 ||\r\n            parts.some(p => p.length === 0) ||\r\n            parts[parts.length - 1].length < 2\r\n        ) {\r\n            // console.log('not legal url with .', str);\r\n            return '';\r\n        }\r\n        return u.href;\r\n    } catch (e) {\r\n        // console.log('not legal url2', str);\r\n        return '';\r\n    }\r\n}\r\nfunction testResendAuth(auth: string) {\r\n    if (auth.length < 4) return ''\r\n    if (auth.indexOf('re_') != 0) return '';\r\n    return auth;\r\n}\r\nfunction testEmail(email: string) {\r\n    if (!/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email)) return '';\r\n    return email;\r\n}\r\nconst ns = \"@test\";\r\nconst nsSendSmsUrlKey = `${ns}/sendSmsUrl`;\r\nconst nsResendUrlKey = `${ns}/resendUrl`;\r\nconst nsResendAuthKey = `${ns}/resendAuth`;\r\nconst nsEmailKey = `${ns}/email`;\r\nconst nsMobilePathKey = `${ns}/mobilePathKey`;\r\n\r\nconst readSmsUrl = \"https://d.shangwoa.top/redis-lrange-get-upstash\";\r\nconst resendAipUrl = \"https://api.resend.com/emails\";\r\nconst defSendSmsUrl = (()=>{\r\n    if(typeof window === 'undefined')return '';\r\n    let data = localStorage.getItem(nsSendSmsUrlKey);\r\n    if (!data || data == 'null'){\r\n        // data = \"https://redis-set-sms-upstash.mailregios.workers.dev/\";\r\n        data = \"https://d.shangwoa.top/redis-set-sms-upstash\";\r\n        localStorage.setItem(nsSendSmsUrlKey, data);\r\n    }\r\n    return data;\r\n})();\r\nconst resendUrl = (()=>{\r\n    if(typeof window === 'undefined')return '';\r\n    let data = localStorage.getItem(nsResendUrlKey);\r\n    if (!data || data == 'null'){\r\n        data = \"https://resend.com\";\r\n        localStorage.setItem(nsResendUrlKey, data);\r\n    }\r\n    return data;\r\n})();\r\nconst defResendAuth = (()=>{\r\n    if(typeof window === 'undefined')return '';\r\n    let data = localStorage.getItem(nsResendAuthKey);\r\n    if (!data || data == 'null'){\r\n        data = \"re_17h7y4J2_Jw88LxFtdJCfxomHhjtM44Y5\";\r\n        localStorage.setItem(nsResendAuthKey, data);\r\n    }\r\n    return data;\r\n})();\r\nconst defEmail = \"name@example.com\";\r\nconst defMobilePathKey = (() => {\r\n    if (typeof window == 'undefined') return '';\r\n    let prefix = localStorage.getItem(nsMobilePathKey);\r\n    if (!prefix || prefix == 'null') {\r\n        prefix = uuidv4();\r\n        localStorage.setItem(nsMobilePathKey, prefix);\r\n    }\r\n    return prefix;\r\n})();\r\nexport function SmsScriptItemComponent() {\r\n    const [isRunning, setIsRunning] = useState(false)\r\n    const [openSetting, setOpenSetting] = useState(false)\r\n    const [sendSmsUrl, setSendSmsUrl] = useState(\"\");\r\n    const [resendAuth, setResendAuth] = useState(\"\");\r\n    const [email, setEmail] = useState(\"\");\r\n    const [mobilePathKey, setMobilePathKey] = useState(defMobilePathKey);\r\n    function callOpenSetting() {\r\n        setOpenSetting(true);\r\n        reloadSmsUrl();\r\n        reloadResendAuth();\r\n        reloadEmail();\r\n    }\r\n    function reloadSmsUrl() {\r\n        const url = localStorage.getItem(nsSendSmsUrlKey) || defSendSmsUrl;\r\n        // console.log('reloadSmsUrl', url);\r\n        setSendSmsUrl(url);\r\n    }\r\n    function reloadResendAuth() {\r\n        const auth = localStorage.getItem(nsResendAuthKey) || defResendAuth;\r\n        // console.log('reloadResendAuth_fn', auth);\r\n        setResendAuth(auth);\r\n    }\r\n    function reloadEmail() {\r\n        const email = localStorage.getItem(nsEmailKey) || \"\";\r\n        // console.log('reloadEmail_fn', email);\r\n        setEmail(email);\r\n    }\r\n    useEffect(() => {\r\n        reloadSmsUrl();\r\n        reloadResendAuth();\r\n        reloadEmail();\r\n    }, [])\r\n\r\n    function onMobilePathKeyChange(str: string) {\r\n        setMobilePathKey(str);\r\n        localStorage.setItem(nsMobilePathKey, str);\r\n    }\r\n    useEffect(() => {\r\n        if (sendSmsUrl.length > 0) return;\r\n        setTimeout(() => {\r\n            // console.log('later check sendSmsUrl', sendSmsUrl);\r\n            if (sendSmsUrl.length > 0) return;\r\n            setSendSmsUrl(defSendSmsUrl)\r\n        }, 1000 * 3)\r\n    }, [sendSmsUrl]);\r\n    function onSendSmsUrlChange(str: string) {\r\n        setSendSmsUrl(str);\r\n        if (str === \"\") {\r\n            localStorage.removeItem(nsSendSmsUrlKey);\r\n        }\r\n        const href = testUrl(str);\r\n        if (!href) return;\r\n        console.log('save url', href);\r\n        localStorage.setItem(nsSendSmsUrlKey, href);\r\n    }\r\n    useEffect(() => {\r\n        if (resendAuth.length > 0) return;\r\n        setTimeout(() => {\r\n            // console.log('later check resendAuth', resendAuth);\r\n            if (resendAuth.length > 0) return;\r\n            setResendAuth(defResendAuth)\r\n        }, 1000 * 3)\r\n    }, [resendAuth])\r\n    function onResendAuthChange(str: string) {\r\n        setResendAuth(str);\r\n        if (str === \"\") {\r\n            localStorage.removeItem(nsResendAuthKey);\r\n            return;\r\n        }\r\n        localStorage.setItem(nsResendAuthKey, str);\r\n    }\r\n    function onEmailChange(str: string) {\r\n        setEmail(str);\r\n        if (str === \"\") {\r\n            localStorage.removeItem(nsEmailKey);\r\n            return;\r\n        }\r\n        const email = testEmail(str);\r\n        if (!email) return;\r\n        localStorage.setItem(nsEmailKey, email);\r\n    }\r\n    useEffect(() => {\r\n        if (email.length > 0) return;\r\n        setTimeout(() => {\r\n            // console.log('later check email', email);\r\n            if (email.length > 0) return;\r\n            // setEmail(defEmail)\r\n        }, 1000 * 3)\r\n    }, [email])\r\n    const onRunScriptClick = async () => {\r\n        const res = autoWebViewJs.callScriptByConf(getScriptConf())\r\n        // console.log('FirstProjectButton call run script res is', res)\r\n        runnerResult = res.javaResultData\r\n        checkIsRunning()\r\n    }\r\n    const onStopClick = () => {\r\n        console.log('stop project', scriptId)\r\n        const res = autoWebViewJs.callScript<IStopByIdResult>(stopScript)\r\n        // console.log('FirstProjectButton call onStopClick res is', res)\r\n        checkIsRunning()\r\n    }\r\n    function checkIsRunning() {\r\n        const res = autoWebViewJs.callScript<string>(isRunningScript)\r\n        const isRun = !!res.javaResultData && res.javaResultData !== \"false\";\r\n        // console.log('FirstProjectButton call isRunningScript res is', isRun, res)\r\n        setIsRunning(isRun)\r\n    }\r\n    useEffect(() => {\r\n        checkIsRunning()\r\n    }, []);\r\n    function onCfButtonClick(e: React.MouseEvent<HTMLAnchorElement>) {\r\n        onUrlClick(e, \"https://cloudflare.com/\")\r\n    }\r\n    function onUpstashButtonClick(e: React.MouseEvent<HTMLAnchorElement>) {\r\n        onUrlClick(e, \"https://console.upstash.com/\")\r\n    }\r\n    function onResendClick(e: React.MouseEvent<HTMLAnchorElement>) {\r\n        onUrlClick(e, resendUrl);\r\n    }\r\n    function onUrlClick(e: React.MouseEvent<HTMLAnchorElement>, url: string) {\r\n        if (!isRealInAndroid) return;\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n        const script = `\r\n        com.fanfanlo.lib.intent.Funcs.browserOpenUrl(\"${url}\");`\r\n        autoWebViewJs.callScript(script)\r\n    }\r\n    function onMobilePathKeyClick(e: React.MouseEvent<HTMLAnchorElement>) {\r\n        onUrlClick(e, `${readSmsUrl}/?k=${mobilePathKey}`)\r\n    }\r\n    \r\n    async function testSendEmail(){\r\n        console.log('start testSendEmail')\r\n        const url = localStorage.getItem(nsEmailKey);\r\n        if (!url) return;\r\n        // val sender:String, val msg:String, val time:Long, val receiver:String, val slot:Int\r\n        const res = await fetch(url, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({\r\n                sender: '+15205309873',\r\n                msg: 'test',\r\n                time: Date.now(),\r\n                receiver: '+15321167889',\r\n                slot: 0,\r\n            }),\r\n        });\r\n        const data = await res.json();\r\n        console.log('testSendEmail complete', data);\r\n    }\r\n    async function testSendSms(){\r\n        const url = `${sendSmsUrl}`;\r\n        // val sender:String, val msg:String, val time:Long, val receiver:String, val slot:Int\r\n        const res = await fetch(url, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify({k:mobilePathKey, v:{\r\n                sender: '+15205309873',\r\n                msg: 'test',\r\n                time: Date.now(),\r\n                receiver: '+15321167889',\r\n                slot: 0,\r\n            }}),\r\n        });\r\n        const data = await res.json();\r\n        console.log('testSendSms complete', data);\r\n    }\r\n    async function onTestSendClick(){\r\n        await testSendEmail();\r\n        await testSendSms();\r\n    }\r\n    return (\r\n        <>\r\n            <Box>\r\n                <span>转发短信</span>\r\n                <span>{isRunning ? \"运行中\" : \"未运行\"}</span>\r\n                <Button onClick={onRunScriptClick}>运行</Button>\r\n                <Button onClick={onStopClick}>停止</Button>\r\n                <Button onClick={() => callOpenSetting()}>设置</Button>\r\n                <Dialog open={openSetting} onClose={() => setOpenSetting(false)}>\r\n                    {/* <Paper> */}\r\n\r\n                    <Stack sx={{ bgcolor: \"background.paper\", m: 1, p: 1, height: \"100%\" }} direction=\"column\" spacing={2}>\r\n                        <Box>\r\n                            <span>设置</span>\r\n                            <Button onClick={() => setOpenSetting(false)}>关闭</Button>\r\n                            {((sendSmsUrl && mobilePathKey) ||testEmail(email))\r\n                            && <Button onClick={onTestSendClick}>模拟接收到短信</Button>}\r\n                            \r\n                        </Box>\r\n                        <Stack sx={{ border: \"1px solid #ccc\", borderRadius: 1, p: 1 }} direction={\"column\"}\r\n                            spacing={1}>\r\n                            <Box>\r\n                                <span style={{color:\"red\"}}>强烈建议您使用自己的服务进行转发，如您懂些编程的话，请自行修改代码并进行加密发送信息。</span>\r\n                            </Box>\r\n                        </Stack>\r\n                        <Stack sx={{ border: \"1px solid #ccc\", borderRadius: 1, p: 1 }} direction={\"column\"}\r\n                            spacing={1}>\r\n                            <Box>\r\n                                <b>邮箱地址</b>\r\n                            </Box>\r\n                            <Box>\r\n                                <span>不填写将不会发送邮件</span>\r\n                            </Box>\r\n                            <Box>\r\n                                <TextField\r\n                                    error={!!email && !testEmail(email)}\r\n                                    id=\"editable-text\"\r\n                                    aria-label=\"editable-text\"\r\n                                    required\r\n                                    fullWidth\r\n                                    multiline\r\n                                    placeholder={defEmail}\r\n                                    helperText={!email ? \"不填写将不会发送邮件\" : testEmail(email) ? \"请输入您要转发邮件的邮箱地址\" : \"您输入的邮箱地址可能不正确\"}\r\n                                    variant=\"standard\"\r\n                                    value={email} onChange={(e) => onEmailChange(e.target.value)} />\r\n                            </Box>\r\n                        </Stack>\r\n                        <Stack sx={{ border: \"1px solid #ccc\", borderRadius: 1, p: 1 }} direction={\"column\"}\r\n                            spacing={1}>\r\n                            <Box>\r\n                                <b>读取短信的路径</b>\r\n                            </Box>\r\n                            <Box>\r\n                                <Box><span>不填写将不会把短信内容发送到远程服务器。</span></Box>\r\n                                <Box>\r\n                                    <span>\r\n                                        该字符串可以起到轻微加密的作用，长度您可以设置在100个字符以内，建议30个字符以上。\r\n                                    </span>\r\n                                </Box>\r\n                                <Box>\r\n                                    <span>我们提供的默认存储并没有访问限制，任何人知道、猜到、枚举到路径都可以获取到您的短信内容，强烈建议您替换为您的安全方式接收和存储短信，以免被恶意获取到。</span>\r\n                                </Box>\r\n                                {(sendSmsUrl && mobilePathKey && sendSmsUrl == defSendSmsUrl) && <Box><a target=\"_blank\" onClick={onMobilePathKeyClick} href={`${readSmsUrl}/?k=${mobilePathKey}`}>打开访问路径</a>\r\n                                <span>{`${readSmsUrl}/?k=${mobilePathKey}`}</span></Box>}\r\n                            </Box>\r\n                            <Box>\r\n                                <TextField\r\n                                    id=\"editable-text\"\r\n                                    aria-label=\"editable-text\"\r\n                                    required\r\n                                    fullWidth\r\n                                    multiline\r\n                                    placeholder={defMobilePathKey}\r\n                                    variant=\"standard\"\r\n                                    value={mobilePathKey} onChange={(e) => onMobilePathKeyChange(e.target.value)} />\r\n                            </Box>\r\n                        </Stack>\r\n                        <Box>\r\n                            <Box>因为没时间开发，所以默认发送信息和邮件是我们申请的免费资源用来测试的，额度不多，大家都用的话，很快就会用完，用完后就所有人都发不出去了，如果出现这种情况，您可以自己申请或建设您自己的转发渠道。</Box>\r\n                            <Box>如果该功能受欢迎，我们也会很快自己开发提供无限量免费使用资源。</Box>\r\n                        </Box>\r\n                        <Stack sx={{ border: \"1px solid #ccc\", borderRadius: 1, p: 1 }} direction={\"column\"}\r\n                            spacing={1}>\r\n                            <Box><b>邮件转发</b></Box>\r\n                            <Box>\r\n                                <span>\r\n                                    我们默认是用<a onClick={onResendClick} href={resendUrl} target=\"_blank\">resend</a>发送邮件的，您可以到它的官网申请自己的账号使用。\r\n                                </span>\r\n                            </Box>\r\n                            <Box>\r\n                                <TextField\r\n                                    error={!testResendAuth(resendAuth)}\r\n                                    id=\"editable-text\"\r\n                                    aria-label=\"editable-text\"\r\n                                    required\r\n                                    fullWidth\r\n                                    multiline\r\n                                    helperText={testResendAuth(resendAuth) ? \"请输入您要转发邮件的auth\" : \"您输入的auth可能不正确\"}\r\n                                    variant=\"standard\"\r\n                                    value={resendAuth} onChange={(e) => onResendAuthChange(e.target.value)} />\r\n                            </Box>\r\n                        </Stack>\r\n                        <Stack sx={{ border: \"1px solid #ccc\", borderRadius: 1, p: 1 }} direction=\"column\" spacing={1}>\r\n                            <Box>\r\n                                <Box><b>短信转发地址</b></Box>\r\n                                <Box>\r\n                                    <span>默认为：{defSendSmsUrl}</span>\r\n                                </Box>\r\n                                <Box>\r\n                                    <span>\r\n                                        如果您是自己使用，可以在<a onClick={onUpstashButtonClick} href=\"https://console.upstash.com/\" target=\"_blank\">upstash</a>申请免费redis进行操作即可。\r\n                                    </span>\r\n                                </Box>\r\n                                <Box>\r\n                                    <span>您还可以做一个代理层，在<a onClick={onCfButtonClick} href=\"https://cloudflare.com\" target=\"_blank\">cloudflare</a>网站创建worker，然后将worker的url填到这里。</span>\r\n                                </Box>\r\n                                <Box>\r\n                                    <span>您也可以自建服务器或者使用钉钉、server酱等接收消息推送的api。</span>\r\n                                </Box>\r\n                            </Box>\r\n                            <TextField\r\n                                error={!testUrl(sendSmsUrl)}\r\n                                id=\"editable-text\"\r\n                                aria-label=\"editable-text\"\r\n                                required\r\n                                fullWidth\r\n                                multiline\r\n                                helperText={testUrl(sendSmsUrl) ? \"请输入您要转发短信的url\" : \"您输入的url不合法\"}\r\n                                variant=\"standard\"\r\n                                value={sendSmsUrl} onChange={(e) => onSendSmsUrlChange(e.target.value)} />\r\n                        </Stack>\r\n                    </Stack>\r\n                    {/* </Paper> */}\r\n                </Dialog>\r\n            </Box>\r\n        </>\r\n    )\r\n}\r\n","import MessageIcon from '@mui/icons-material/Message';\r\nimport { IconButton } from \"@mui/material\";\r\nimport { useRouter } from \"next/navigation\";\r\nexport function IMOpenPageLink(){\r\n    const router = useRouter();\r\n    function onClick(){\r\n        router.push('/im')\r\n    }\r\n    return (\r\n        <span>\r\n            <IconButton onClick={onClick}>\r\n                <MessageIcon />\r\n                {/* {t('PageLinks.im')} */}\r\n            </IconButton>\r\n        </span>\r\n    )\r\n}","import React, {\n    useCallback,\n    useEffect,\n    useRef,\n    useState,\n    forwardRef,\n    ForwardedRef\n} from 'react';\nimport {\n    Room,\n    RoomEvent,\n    Participant,\n    RemoteParticipant,\n    RemoteTrack,\n    Track,\n    LocalTrack,\n    LocalVideoTrack,\n    LocalAudioTrack,\n    createLocalAudioTrack,\n    createLocalVideoTrack,\n    VideoPreset,\n    VideoPresets,\n    TrackPublication,\n    LocalParticipant\n} from 'livekit-client';\nimport {\n    Box,\n    Button,\n    Typography,\n    Grid,\n    Alert,\n    IconButton,\n    CircularProgress,\n    Stack,\n    SxProps,\n    Theme\n} from '@mui/material';\nimport {\n    Mic as MicIcon,\n    MicOff as MicOffIcon,\n    ScreenShare as ScreenShareIcon,\n    StopScreenShare as StopScreenShareIcon,\n    Videocam as VideoIcon,\n    VideocamOff as VideoOffIcon,\n    CallEnd as CallEndIcon,\n    Settings as SettingsIcon,\n    VolumeUp as VolumeUpIcon,\n    VolumeOff as VolumeOffIcon,\n    Fullscreen as FullscreenIcon,\n    FullscreenExit as FullscreenExitIcon,\n    Refresh as RefreshIcon\n} from '@mui/icons-material';\nimport { Log } from '@fanfanlo';\nimport { mainModel } from '@src/libs/mc/main/MainModel';\nimport { MeetingRoomProps, VideoPresetConfig, ExtendedParticipantState, ParticipantState } from './meeting-room.intf';\n\n// 日志记录器\nconst logger = new Log(false, 'livekit-meeting.MeetingRoom');\nconst uiLogger = logger.sub(false, 'MeetingRoom_ui');\n\n// 视频预设\nconst VIDEO_PRESET: VideoPresetConfig = {\n    width: 1280,\n    height: 720,\n    // @ts-ignore - frameRate is used by LiveKit internally\n    frameRate: 24,\n    maxBitrate: 3000 * 1000, // 3Mbps\n};\n\n// 类型定义已移至 meetint-room.intf.ts\n\n\nfunction getTokenEndpoint(): string {\n    if (!mainModel.appConfig?.livekit?.jwt) {\n        throw new Error('LiveKit JWT endpoint is not configured');\n    }\n    return `${mainModel.appConfig.livekit.jwt}/token`;\n}\n// 主组件实现\nfunction MeetingRoomComponent(\n    {\n        roomName,\n        userName,\n        onDisconnect,\n        onError,\n        className = '',\n        style,\n        sx\n    }: MeetingRoomProps,\n    ref: ForwardedRef<HTMLDivElement>\n) {\n    // 全局音视频控制状态\n    const [globalMediaState, setGlobalMediaState] = useState<{\n        isAudioEnabled: boolean;\n        isVideoEnabled: boolean;\n    }>({\n        isAudioEnabled: true,\n        isVideoEnabled: true,\n    });\n\n    // Refs\n    const roomRef = useRef<Room | null>(null);\n    const localTracksRef = useRef<LocalTrack[]>([]);\n    const videoElements = useRef<Record<string, HTMLVideoElement>>({});\n    const audioElements = useRef<Record<string, HTMLAudioElement>>({});\n    const [participantStates, setParticipantStates] = useState<Record<string, ExtendedParticipantState>>({});\n    const isUnmountedRef = useRef(false);\n\n    // State\n    const [isConnecting, setIsConnecting] = useState(false);\n    const [hasConnected, setHasConnected] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n    const [isMuted, setIsMuted] = useState(false);\n    const [isVideoEnabled, setIsVideoEnabled] = useState(true);\n    const [participants, setParticipants] = useState<RemoteParticipant[]>([]);\n\n    // 获取 token\n    const fetchToken = useCallback(async (roomName: string, identity: string) => {\n        try {\n            const response = await fetch(getTokenEndpoint(), {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    room_name: roomName,\n                    identity,\n                }),\n            });\n\n            if (!response.ok) {\n                throw new Error('获取 token 失败');\n            }\n\n            const data = await response.json();\n            return data.token;\n        } catch (error) {\n            uiLogger.error('获取 token 失败:', error);\n            throw error;\n        }\n    }, []);\n\n    // 连接到房间\n    const connectToRoom = useCallback(async () => {\n        if (isConnecting || hasConnected) return;\n\n        setIsConnecting(true);\n        setError(null);\n\n        try {\n            // 1. 获取 token\n            const token = await fetchToken(roomName, userName);\n\n            // 2. 创建本地轨道\n            const { audioTrack, videoTrack } = await createLocalTracks();\n            localTracksRef.current = [audioTrack, videoTrack];\n\n            // 3. 创建房间连接\n            const room = new Room({\n                adaptiveStream: true,\n                dynacast: true,\n                videoCaptureDefaults: {\n                    resolution: VIDEO_PRESET,\n                },\n                // @ts-ignore - publishDefaults is a valid option\n                publishDefaults: {\n                    dtx: true,\n                    red: true,\n                    forceStereo: false,\n                    simulcast: true,\n                } as any, // Type assertion to bypass type checking for now\n            });\n\n            // 4. 设置事件监听\n            setupRoomListeners(room);\n\n            // 5. 连接到房间\n            await room.connect(\n                mainModel.appConfig!.livekit.wsUrl,\n                token,\n                {\n                    autoSubscribe: true,\n                }\n            );\n\n            // 6. 发布本地轨道\n            try {\n                await Promise.all([\n                    room.localParticipant.publishTrack(audioTrack),\n                    room.localParticipant.publishTrack(videoTrack)\n                ]);\n            } catch (publishError) {\n                uiLogger.error('发布轨道失败:', publishError);\n                // 即使发布失败也继续，因为可能已经有其他参与者发布了相同的轨道\n            }\n\n            // 7. 更新引用和状态\n            roomRef.current = room;\n            setHasConnected(true);\n\n            // 8. 添加现有远程参与者到状态\n            const remoteParticipants = Array.from(room.remoteParticipants.values());\n            setParticipants(remoteParticipants);\n\n            // 9. 更新本地参与者状态\n            updateParticipantState(room.localParticipant.identity, {\n                isAudioEnabled: true,\n                isVideoEnabled: true,\n                audioTrack,\n                videoTrack,\n            });\n\n            // 10. 为现有远程参与者设置轨道\n            remoteParticipants.forEach(participant => {\n                // 初始化远程参与者状态\n                initParticipantState(participant);\n                uiLogger.log('已初始化远程参与者状态:', participant.identity);\n                \n                // 使用 getTrackPublications 获取所有轨道发布\n                participant.getTrackPublications().forEach(publication => {\n                    if (publication.track && publication.track instanceof RemoteTrack) {\n                        handleTrackSubscribed(publication.track, publication, participant);\n                    }\n                });\n            });\n            \n            // 初始化本地参与者状态\n            if (room.localParticipant) {\n                initParticipantState(room.localParticipant);\n                uiLogger.log('已初始化本地参与者状态:', room.localParticipant.identity);\n            }\n\n            uiLogger.log('成功加入会议');\n\n        } catch (error) {\n            uiLogger.error('连接房间失败:', error);\n            setError('加入会议失败，请检查网络和权限设置');\n            // 发生错误时清理资源\n            cleanupTracks(localTracksRef.current);\n            localTracksRef.current = [];\n\n            if (roomRef.current) {\n                try {\n                    await roomRef.current.disconnect();\n                } catch (e) {\n                    uiLogger.error('断开连接时出错:', e);\n                }\n                roomRef.current = null;\n            }\n        } finally {\n            setIsConnecting(false);\n        }\n    }, [roomName, userName, isConnecting, hasConnected, fetchToken]);\n\n    // 创建本地音视频轨道\n    const createLocalTracks = useCallback(async () => {\n        try {\n            const [audioTrack, videoTrack] = await Promise.all([\n                createLocalAudioTrack({\n                    echoCancellation: true,\n                    noiseSuppression: true,\n                    autoGainControl: true,\n                }),\n                createLocalVideoTrack({\n                    resolution: {\n                        width: 1280,\n                        height: 720,\n                        frameRate: 24,\n                    },\n                }),\n            ]);\n            return { audioTrack, videoTrack };\n        } catch (error) {\n            uiLogger.error('创建本地轨道失败:', error);\n            throw error;\n        }\n    }, []);\n\n    // 清理轨道\n    const cleanupTracks = useCallback((tracks: LocalTrack[]) => {\n        tracks.forEach(track => {\n            track.stop();\n            track.detach();\n        });\n    }, []);\n\n    // 跟踪已处理的轨道元素\n    const trackElementsRef = useRef<Record<string, boolean>>({});\n    const videoElementsRef = useRef<Record<string, HTMLVideoElement>>({});\n    const audioElementsRef = useRef<Record<string, HTMLAudioElement>>({});\n\n    // 更新参与者状态\n    const updateParticipantState = useCallback((identity: string, state: Partial<ParticipantState>) => {\n        setParticipantStates(prev => ({\n            ...prev,\n            [identity]: {\n                ...(prev[identity] || {\n                    isAudioEnabled: true,\n                    isVideoEnabled: true,\n                    isAudioEnabledGlobal: true,\n                    isVideoEnabledGlobal: true,\n                }),\n                ...state,\n            },\n        }));\n    }, []);\n    // 处理轨道订阅\n    const handleTrackSubscribed = useCallback((\n        track: RemoteTrack,\n        publication: TrackPublication,\n        participant: Participant\n    ) => {\n        if (!track) return () => { };\n\n        const { identity } = participant;\n        const isVideoTrack = track.kind === Track.Kind.Video;\n\n        uiLogger.log(`处理 ${track.kind} 轨道订阅:`, identity, track);\n\n        // 更新轨道状态的函数\n        const updateTrackState = () => {\n            const isMuted = track.isMuted;\n            const stateUpdate: Partial<ParticipantState> = {};\n\n            if (track.kind === Track.Kind.Audio) {\n                stateUpdate.isAudioEnabled = !isMuted;\n            } else if (track.kind === Track.Kind.Video) {\n                stateUpdate.isVideoEnabled = !isMuted;\n            }\n\n            updateParticipantState(identity, stateUpdate);\n\n            // 强制触发重新渲染以确保 ParticipantVideo 组件更新\n            if (isVideoTrack) {\n                setParticipants(prev => [...prev]);\n            }\n        };\n\n        // 监听轨道静音/取消静音事件\n        track.on('muted', updateTrackState);\n        track.on('unmuted', updateTrackState);\n\n        // 初始状态更新\n        updateTrackState();\n\n        // 强制更新参与者列表以触发重新渲染\n        // 这确保了即使没有状态变化，组件也会检查新的轨道\n        setParticipants(prev => {\n            const participantExists = prev.some(p => p.identity === identity);\n            if (!participantExists) {\n                return [...prev, participant as RemoteParticipant];\n            }\n            return [...prev];\n        });\n\n\n        // 清理函数\n        return () => {\n            track.off('muted', updateTrackState);\n            track.off('unmuted', updateTrackState);\n        };\n    }, [updateParticipantState]);\n\n    // 设置房间事件监听\n    const setupRoomListeners = useCallback((room: Room) => {\n        // 保存所有事件处理函数引用，以便后续清理\n        type EventHandler = (...args: any[]) => void;\n        const eventHandlers: Record<string, EventHandler> = {\n            // 处理远程参与者连接\n            participantConnected: (participant: RemoteParticipant) => {\n                if (!(participant instanceof RemoteParticipant)) return;\n\n                uiLogger.log('远程参与者已连接:', participant.identity);\n\n                // 添加新参与者到状态（使用函数式更新确保不重复添加）\n                setParticipants(prev => {\n                    // 如果已经存在该参与者，则返回原数组\n                    if (prev.some(p => p.identity === participant.identity)) {\n                        return prev;\n                    }\n                    return [...prev, participant];\n                });\n\n                // 监听参与者的轨道发布\n                const handleTrackPublished = (publication: TrackPublication) => {\n                    uiLogger.log('远程参与者发布轨道:', publication.kind, participant.identity);\n                    if (publication.track) {\n                        handleTrackSubscribed(publication.track as RemoteTrack, publication, participant);\n                    } else {\n                        publication.once('subscribed', (track: RemoteTrack) => {\n                            handleTrackSubscribed(track, publication, participant);\n                        });\n                    }\n                };\n\n                // 添加轨道发布监听\n                participant.on('trackPublished', handleTrackPublished);\n\n                // 处理已经发布的轨道\n                participant.trackPublications.forEach(publication => {\n                    if (publication.track) {\n                        handleTrackSubscribed(publication.track as RemoteTrack, publication, participant);\n                    }\n                });\n\n                // 返回清理函数\n                return () => {\n                    participant.off('trackPublished', handleTrackPublished);\n                };\n            },\n\n            // 处理参与者断开连接\n            participantDisconnected: (participant: RemoteParticipant) => {\n                uiLogger.log('远程参与者已断开连接:', participant.identity);\n                setParticipants(prev => {\n                    const newParticipants = prev.filter(p => p.identity !== participant.identity);\n                    uiLogger.log('更新后的参与者列表:', newParticipants.map(p => p.identity));\n                    return newParticipants;\n                });\n            },\n\n            // 处理轨道订阅\n            trackSubscribed: (track: RemoteTrack, publication: TrackPublication, participant: Participant) => {\n                if (!track) return;\n                uiLogger.log('轨道订阅成功:', track.kind, participant.identity);\n                // 处理远程轨道订阅\n                handleTrackSubscribed(track, publication, participant as RemoteParticipant);\n            },\n\n            disconnected: (reason?: any) => {\n                const reasonStr = reason?.toString?.() || '未知原因';\n                uiLogger.log('已从房间断开连接，原因:', reasonStr);\n                // 更新状态但不调用 handleDisconnect，因为可能是我们主动断开的\n                setHasConnected(false);\n                setParticipants([]);\n                setError(null);\n            },\n\n            reconnecting: () => {\n                uiLogger.log('正在重新连接到房间...');\n                setError('正在重新连接...');\n            },\n\n            reconnected: () => {\n                uiLogger.log('已重新连接到房间');\n                setError(null);\n            }\n        };\n\n        // 添加事件监听\n        room\n            .on(RoomEvent.Disconnected, eventHandlers.disconnected)\n            .on(RoomEvent.Reconnecting, eventHandlers.reconnecting)\n            .on(RoomEvent.Reconnected, eventHandlers.reconnected)\n            .on(RoomEvent.ParticipantConnected, eventHandlers.participantConnected)\n            .on(RoomEvent.ParticipantDisconnected, eventHandlers.participantDisconnected)\n            .on(RoomEvent.TrackSubscribed, eventHandlers.trackSubscribed);\n\n        // 返回清理函数\n        return () => {\n            if (!room) return;\n            room\n                .off(RoomEvent.Disconnected, eventHandlers.disconnected)\n                .off(RoomEvent.Reconnecting, eventHandlers.reconnecting)\n                .off(RoomEvent.Reconnected, eventHandlers.reconnected)\n                .off(RoomEvent.ParticipantConnected, eventHandlers.participantConnected)\n                .off(RoomEvent.ParticipantDisconnected, eventHandlers.participantDisconnected)\n                .off(RoomEvent.TrackSubscribed, eventHandlers.trackSubscribed);\n\n            // 确保返回 void\n            return undefined;\n        };\n    }, [handleTrackSubscribed]);\n\n    // 离开会议\n    const leaveMeeting = useCallback(async () => {\n        uiLogger.log('正在离开会议...');\n        try {\n            // 停止所有本地轨道\n            cleanupTracks(localTracksRef.current);\n\n            // 断开房间连接\n            if (roomRef.current) {\n                await roomRef.current.disconnect();\n                roomRef.current = null;\n            }\n\n            // 更新状态\n            setHasConnected(false);\n            setParticipants([]);\n            setError(null);\n\n            // 清除所有媒体元素\n            Object.values(videoElements.current).forEach(el => el && el.remove());\n            Object.values(audioElements.current).forEach(el => el && el.remove());\n            videoElements.current = {};\n            audioElements.current = {};\n\n            // 调用断开连接回调\n            if (onDisconnect) {\n                onDisconnect();\n            }\n\n            uiLogger.log('已成功离开会议');\n        } catch (error) {\n            uiLogger.error('离开会议时出错:', error);\n            setError('离开会议时出错，请重试');\n        }\n    }, [onDisconnect]);\n\n    // 清理函数\n    const cleanup = useCallback(async (isUnmounting = false) => {\n        // 如果是组件卸载，设置卸载标志\n        if (isUnmounting) {\n            isUnmountedRef.current = true;\n        }\n\n        uiLogger.log('执行清理...');\n        if (!roomRef.current) return;\n\n        const localParticipant = roomRef.current.localParticipant;\n        const audioTrack = localTracksRef.current.find(\n            t => t.kind === Track.Kind.Audio\n        ) as LocalAudioTrack | undefined;\n        const videoTrack = localTracksRef.current.find(\n            t => t.kind === Track.Kind.Video\n        ) as LocalVideoTrack | undefined;\n\n        try {\n            if (audioTrack) {\n                await audioTrack.stop();\n            }\n            if (videoTrack) {\n                await videoTrack.stop();\n            }\n        } catch (error) {\n            uiLogger.error('停止轨道失败:', error);\n        }\n\n        // 清理轨道\n        cleanupTracks(localTracksRef.current);\n        localTracksRef.current = [];\n\n        // 清理房间\n        if (roomRef.current) {\n            roomRef.current.disconnect();\n            roomRef.current = null;\n        }\n\n        // 清理状态\n        setHasConnected(false);\n        setParticipants([]);\n        setParticipantStates({});\n    }, []);\n\n    // 更新全局媒体状态\n    const updateGlobalMediaState = useCallback((audioEnabled: boolean, videoEnabled: boolean) => {\n        setGlobalMediaState(prev => ({\n            ...prev,\n            isAudioEnabled: audioEnabled,\n            isVideoEnabled: videoEnabled,\n        }));\n    }, []);\n\n    // 切换静音状态（全局控制）\n    const toggleMute = useCallback(async () => {\n        if (!roomRef.current) return;\n\n        const localParticipant = roomRef.current.localParticipant;\n        const audioTrack = localTracksRef.current.find(\n            t => t.kind === Track.Kind.Audio\n        ) as LocalAudioTrack | undefined;\n\n        if (!audioTrack) return;\n\n        try {\n            // 全局按钮基于全局状态进行切换\n            const newGlobalAudioState = !globalMediaState.isAudioEnabled;\n\n            // 同步更新本地麦克风的物理状态\n            if (newGlobalAudioState) {\n                await audioTrack.unmute();\n            } else {\n                await audioTrack.mute();\n            }\n\n            // 更新本地UI状态\n            setIsMuted(!newGlobalAudioState);\n            updateParticipantState(localParticipant.identity, { isAudioEnabled: newGlobalAudioState });\n\n            // 更新全局音频状态，这将影响所有参与者的有效状态\n            updateGlobalMediaState(newGlobalAudioState, globalMediaState.isVideoEnabled);\n        } catch (error) {\n            uiLogger.error('切换静音状态失败:', error);\n            setError('切换麦克风状态失败');\n        }\n    }, [globalMediaState, updateParticipantState, updateGlobalMediaState]);\n\n    // 切换视频状态（全局控制）\n    const toggleVideo = useCallback(async () => {\n        if (!roomRef.current) return;\n\n        const localParticipant = roomRef.current.localParticipant;\n        const videoTrack = localTracksRef.current.find(\n            t => t.kind === Track.Kind.Video\n        ) as LocalVideoTrack | undefined;\n\n        if (!videoTrack) return;\n\n        try {\n            // 全局按钮基于全局状态进行切换\n            const newGlobalVideoState = !globalMediaState.isVideoEnabled;\n\n            // 同步更新本地摄像头的物理状态\n            if (newGlobalVideoState) {\n                await videoTrack.unmute();\n            } else {\n                await videoTrack.mute();\n            }\n\n            // 更新本地UI状态\n            setIsVideoEnabled(newGlobalVideoState);\n            updateParticipantState(localParticipant.identity, { isVideoEnabled: newGlobalVideoState });\n\n            // 更新全局视频状态，这将影响所有参与者的有效状态\n            updateGlobalMediaState(globalMediaState.isAudioEnabled, newGlobalVideoState);\n        } catch (error) {\n            uiLogger.error('切换视频状态失败:', error);\n            setError('切换摄像头状态失败');\n        }\n    }, [globalMediaState, updateParticipantState, updateGlobalMediaState]);\n\n    // 切换本地静音状态（仅本地tile）\n    const handleLocalMuteToggle = useCallback(async () => {\n        if (!roomRef.current) return;\n\n        const localParticipant = roomRef.current.localParticipant;\n        const audioTrack = localTracksRef.current.find(\n            t => t.kind === Track.Kind.Audio\n        ) as LocalAudioTrack | undefined;\n\n        if (!audioTrack) return;\n\n        try {\n            const newMutedState = !isMuted;\n            if (newMutedState) {\n                await audioTrack.mute();\n            } else {\n                await audioTrack.unmute();\n            }\n\n            setIsMuted(newMutedState);\n            updateParticipantState(localParticipant.identity, { isAudioEnabled: !newMutedState });\n        } catch (error) {\n            uiLogger.error('切换本地静音状态失败:', error);\n            setError('切换麦克风状态失败');\n        }\n    }, [isMuted, updateParticipantState]);\n\n    // 切换本地视频状态（仅本地tile）\n    const handleLocalVideoToggle = useCallback(async () => {\n        if (!roomRef.current) return;\n\n        const localParticipant = roomRef.current.localParticipant;\n        const videoTrack = localTracksRef.current.find(\n            t => t.kind === Track.Kind.Video\n        ) as LocalVideoTrack | undefined;\n\n        if (!videoTrack) return;\n\n        try {\n            const newVideoState = !isVideoEnabled;\n            if (newVideoState) {\n                await videoTrack.unmute();\n            } else {\n                await videoTrack.mute();\n            }\n\n            setIsVideoEnabled(newVideoState);\n            updateParticipantState(localParticipant.identity, { isVideoEnabled: newVideoState });\n        } catch (error) {\n            uiLogger.error('切换本地视频状态失败:', error);\n            setError('切换摄像头状态失败');\n        }\n    }, [isVideoEnabled, updateParticipantState]);\n\n    // 组件卸载时清理资源\n    useEffect(() => {\n        return () => {\n            // 清理资源\n            cleanup(true);\n        };\n    }, []);\n\n    // 获取参与者状态\n    const getParticipantState = useCallback((identity: string): ParticipantState => {\n        return participantStates[identity] || {\n            isAudioEnabled: true,\n            isVideoEnabled: true,\n            isAudioEnabledGlobal: true,\n            isVideoEnabledGlobal: true,\n        };\n    }, [participantStates]);\n\n    // 初始化参与者状态\n    const initParticipantState = useCallback((participant: Participant) => {\n        const state = getParticipantState(participant.identity);\n\n        // 更新音频状态\n        const audioTrack = participant.getTrackPublications().find(\n            pub => pub.kind === Track.Kind.Audio\n        )?.track as LocalAudioTrack | undefined;\n\n        // 更新视频状态\n        const videoTrack = participant.getTrackPublications().find(\n            pub => pub.kind === Track.Kind.Video\n        )?.track as LocalVideoTrack | undefined;\n\n        updateParticipantState(participant.identity, {\n            ...state,\n            isAudioEnabled: audioTrack ? !audioTrack.isMuted : false,\n            isVideoEnabled: videoTrack ? !videoTrack.isMuted : false\n        });\n    }, [getParticipantState, updateParticipantState]);\n\n    // 切换参与者的音频状态\n    const handleToggleAudio = useCallback((participant: Participant) => {\n        const currentState = participantStates[participant.identity] || {\n            isAudioEnabled: true,\n            isVideoEnabled: true,\n            isAudioEnabledGlobal: true,\n            isVideoEnabledGlobal: true,\n        };\n\n        updateParticipantState(participant.identity, {\n            ...currentState,\n            isAudioEnabled: !currentState.isAudioEnabled\n        });\n    }, [participantStates, updateParticipantState]);\n\n    // 切换参与者的视频状态\n    const handleToggleVideo = useCallback((participant: Participant) => {\n        const currentState = participantStates[participant.identity] || {\n            isAudioEnabled: true,\n            isVideoEnabled: true,\n            isAudioEnabledGlobal: true,\n            isVideoEnabledGlobal: true,\n        };\n\n        updateParticipantState(participant.identity, {\n            ...currentState,\n            isVideoEnabled: !currentState.isVideoEnabled\n        });\n    }, [participantStates, updateParticipantState]);\n\n    // 获取参与者的实际媒体状态（考虑全局覆盖）\n    const getEffectiveMediaState = useCallback((participantId: string) => {\n        const state = participantStates[participantId];\n        if (!state) return { isAudioEnabled: true, isVideoEnabled: true };\n\n        return {\n            isAudioEnabled: globalMediaState.isAudioEnabled ? state.isAudioEnabled : false,\n            isVideoEnabled: globalMediaState.isVideoEnabled ? state.isVideoEnabled : false,\n        };\n    }, [globalMediaState, participantStates]);\n\n    // 参与者视频组件\n    const ParticipantVideo = React.memo(({\n        participant,\n        isLocal,\n        isVideoEnabled\n    }: {\n        participant: Participant;\n        isLocal: boolean;\n        isVideoEnabled: boolean;\n    }) => {\n        const videoRef = useRef<HTMLVideoElement>(null);\n        const [videoTrack, setVideoTrack] = useState<RemoteTrack | LocalVideoTrack | null>(null);\n\n        // 处理视频轨道变化\n        useEffect(() => {\n            if (!participant) return;\n\n            // 查找现有的视频轨道发布\n            const videoPublication = Array.from(participant.trackPublications.values())\n                .find(pub => pub.kind === Track.Kind.Video);\n\n            // 如果轨道已存在，则直接设置\n            if (videoPublication && videoPublication.track) {\n                setVideoTrack(videoPublication.track);\n            }\n\n            // 当订阅轨道时处理\n            const handleTrackSubscribed = (track: Track) => {\n                if (track.kind === Track.Kind.Video) {\n                    setVideoTrack(track as RemoteTrack | LocalVideoTrack);\n                }\n            };\n\n            // 当取消订阅轨道时处理\n            const handleTrackUnsubscribed = (track: Track) => {\n                if (track.kind === Track.Kind.Video) {\n                    setVideoTrack(null);\n                }\n            };\n\n            // 添加事件监听\n            participant.on(RoomEvent.TrackSubscribed, handleTrackSubscribed);\n            participant.on(RoomEvent.TrackUnsubscribed, handleTrackUnsubscribed);\n\n            // 清理函数\n            return () => {\n                participant.off(RoomEvent.TrackSubscribed, handleTrackSubscribed);\n                participant.off(RoomEvent.TrackUnsubscribed, handleTrackUnsubscribed);\n            };\n        }, [participant]);\n\n        // 处理视频元素附加/分离\n        useEffect(() => {\n            const videoElement = videoRef.current;\n            if (!videoElement || !videoTrack) return;\n\n            // 清理现有视频源\n            while (videoElement.firstChild) {\n                videoElement.removeChild(videoElement.firstChild);\n            }\n\n            // 附加视频轨道\n            if (isVideoEnabled) {\n                videoTrack.attach(videoElement);\n            }\n\n            return () => {\n                if (videoTrack) {\n                    videoTrack.detach(videoElement);\n                }\n            };\n        }, [videoTrack, isVideoEnabled]);\n\n        return (\n            <Box\n                sx={{\n                    width: '100%',\n                    aspectRatio: '16/9',\n                    bgcolor: 'grey.800',\n                    display: 'flex',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    position: 'relative',\n                }}\n            >\n                <video\n                    ref={videoRef}\n                    autoPlay\n                    playsInline\n                    muted={isLocal}\n                    style={{\n                        width: '100%',\n                        height: '100%',\n                        objectFit: 'cover',\n                        display: isVideoEnabled ? 'block' : 'none'\n                    }}\n                />\n                {!isVideoEnabled && (\n                    <Box\n                        sx={{\n                            position: 'absolute',\n                            top: 0,\n                            left: 0,\n                            right: 0,\n                            bottom: 0,\n                            display: 'flex',\n                            alignItems: 'center',\n                            justifyContent: 'center',\n                            bgcolor: 'grey.900',\n                        }}\n                    >\n                        <Box\n                            sx={{\n                                width: 80,\n                                height: 80,\n                                borderRadius: '50%',\n                                display: 'flex',\n                                alignItems: 'center',\n                                justifyContent: 'center',\n                                bgcolor: 'primary.main',\n                                color: 'white',\n                                fontSize: 32,\n                                fontWeight: 'bold',\n                            }}\n                        >\n                            {participant.identity.charAt(0).toUpperCase()}\n                        </Box>\n                    </Box>\n                )}\n            </Box>\n        );\n    });\n\n    // 参与者音频组件\n    const ParticipantAudio = React.memo(({\n        participant,\n        isMuted,\n    }: {\n        participant: Participant;\n        isMuted: boolean;\n    }) => {\n        const audioRef = useRef<HTMLAudioElement>(null);\n        const [audioTrack, setAudioTrack] = useState<RemoteTrack | LocalAudioTrack | null>(null);\n\n        useEffect(() => {\n            if (!participant) return;\n\n            const handleTrackSubscribed = (track: Track) => {\n                if (track.kind === Track.Kind.Audio) {\n                    setAudioTrack(track as RemoteTrack | LocalAudioTrack);\n                }\n            };\n\n            const handleTrackUnsubscribed = (track: Track) => {\n                if (track.kind === Track.Kind.Audio) {\n                    setAudioTrack(null);\n                }\n            };\n\n            // 查找现有的音频轨道\n            const audioPublication = Array.from(participant.trackPublications.values())\n                .find(pub => pub.kind === Track.Kind.Audio);\n\n            if (audioPublication && audioPublication.track) {\n                setAudioTrack(audioPublication.track);\n            }\n\n            participant.on(RoomEvent.TrackSubscribed, handleTrackSubscribed);\n            participant.on(RoomEvent.TrackUnsubscribed, handleTrackUnsubscribed);\n\n            return () => {\n                participant.off(RoomEvent.TrackSubscribed, handleTrackSubscribed);\n                participant.off(RoomEvent.TrackUnsubscribed, handleTrackUnsubscribed);\n            };\n        }, [participant]);\n\n        useEffect(() => {\n            const audioElement = audioRef.current;\n            if (audioElement && audioTrack) {\n                audioTrack.attach(audioElement);\n                // 远程音频默认静音，除非用户手动取消\n                audioElement.muted = isMuted;\n                return () => {\n                    audioTrack.detach(audioElement);\n                };\n            }\n        }, [audioTrack, isMuted]);\n\n        return <audio ref={audioRef} autoPlay playsInline />;\n    });\n\n    // 渲染参与者\n    const renderParticipant = useCallback((participant: Participant, isLocal: boolean) => {\n        const effectiveState = getEffectiveMediaState(participant.identity);\n\n        return (\n            <Box\n                key={participant.identity}\n                sx={{\n                    position: 'relative',\n                    borderRadius: 2,\n                    overflow: 'hidden',\n                    bgcolor: 'background.paper',\n                    boxShadow: 1,\n                }}\n            >\n                {/* 视频元素 */}\n                <ParticipantVideo\n                    participant={participant}\n                    isLocal={isLocal}\n                    isVideoEnabled={effectiveState.isVideoEnabled}\n                />\n\n                {/* 音频元素 */}\n                {!isLocal && (\n                    <ParticipantAudio\n                        participant={participant}\n                        isMuted={!effectiveState.isAudioEnabled}\n                    />\n                )}\n\n                {/* 控制栏 */}\n                <Box\n                    sx={{\n                        position: 'absolute',\n                        bottom: 0,\n                        left: 0,\n                        right: 0,\n                        p: 1,\n                        bgcolor: 'rgba(0, 0, 0, 0.6)',\n                        display: 'flex',\n                        justifyContent: 'center',\n                        gap: 1,\n                    }}\n                >\n                    <IconButton\n                        size=\"small\"\n                        color={effectiveState.isAudioEnabled ? 'primary' : 'error'}\n                        onClick={() => handleToggleAudio(participant)}\n                    >\n                        {effectiveState.isAudioEnabled ? <MicIcon /> : <MicOffIcon />}\n                    </IconButton>\n                    <IconButton\n                        size=\"small\"\n                        color={effectiveState.isVideoEnabled ? 'primary' : 'error'}\n                        onClick={() => handleToggleVideo(participant)}\n                    >\n                        {effectiveState.isVideoEnabled ? <VideoIcon /> : <VideoOffIcon />}\n                    </IconButton>\n                    <Typography variant=\"caption\" color=\"white\">\n                        {participant.identity} {isLocal && '(你)'}\n                    </Typography>\n                    )\n\n                    {/* 本地麦克风控制 */}\n                    {isLocal && (\n                        <IconButton\n                            size=\"small\"\n                            onClick={handleLocalMuteToggle}\n                            color={isMuted ? 'error' : 'primary'}\n                            sx={{ color: 'white' }}\n                            title={isMuted ? '取消静音' : '静音'}\n                        >\n                            {isMuted ? <MicOffIcon /> : <MicIcon />}\n                        </IconButton>\n                    )}\n\n                    {/* 本地视频控制 */}\n                    {isLocal && (\n                        <IconButton\n                            size=\"small\"\n                            onClick={handleLocalVideoToggle}\n                            color={isVideoEnabled ? 'primary' : 'error'}\n                            sx={{ color: 'white' }}\n                            title={isVideoEnabled ? '关闭摄像头' : '开启摄像头'}\n                        >\n                            {isVideoEnabled ? <VideoIcon /> : <VideoOffIcon />}\n                        </IconButton>\n                    )}\n                </Box>\n            </Box>\n        );\n    }, [isMuted, isVideoEnabled, getEffectiveMediaState, handleToggleAudio, handleToggleVideo, handleLocalMuteToggle, handleLocalVideoToggle]);\n\n    // 渲染加载状态\n    if (isConnecting) {\n        return (\n            <Box sx={{\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'center',\n                justifyContent: 'center',\n                height: '100%',\n                p: 3\n            }}>\n                <CircularProgress />\n                <Typography variant=\"body1\" sx={{ mt: 2 }}>正在连接会议...</Typography>\n            </Box>\n        );\n    }\n\n    // 渲染错误状态\n    if (error) {\n        return (\n            <Alert severity=\"error\" sx={{ m: 2 }}>\n                <Typography variant=\"body1\">{error}</Typography>\n                <Button\n                    variant=\"contained\"\n                    color=\"primary\"\n                    onClick={connectToRoom}\n                    startIcon={<RefreshIcon />}\n                    sx={{ mt: 1 }}\n                >\n                    重试连接\n                </Button>\n            </Alert>\n        );\n    }\n\n    // 渲染主界面\n    function renderMainContent() {\n        // 如果已经连接，显示会议界面\n        if (hasConnected && roomRef.current) {\n            return (\n                <Box className={className} sx={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n                    <Box sx={{ flex: 1, overflow: 'auto', p: 2 }}>\n                        <Grid container spacing={2}>\n                            <Grid item xs={12} md={participants.length === 0 ? 12 : 6}>\n                                {renderParticipant(roomRef.current.localParticipant, true)}\n                            </Grid>\n                            {participants.map(function (participant) {\n                                return (\n                                    <Grid item xs={12} md={6} key={participant.identity}>\n                                        {renderParticipant(participant, false)}\n                                    </Grid>\n                                );\n                            })}\n                        </Grid>\n                    </Box>\n                    {/* 底部控制栏 */}\n                    <Box sx={{\n                        p: 2,\n                        borderTop: '1px solid',\n                        borderColor: 'divider',\n                        display: 'flex',\n                        justifyContent: 'center',\n                        gap: 2\n                    }}>\n                        <Button\n                            variant=\"contained\"\n                            color={!globalMediaState.isAudioEnabled ? 'error' : 'primary'}\n                            onClick={toggleMute}\n                            startIcon={!globalMediaState.isAudioEnabled ? <MicOffIcon /> : <MicIcon />}\n                        >\n                            {!globalMediaState.isAudioEnabled ? '取消静音' : '静音'}\n                        </Button>\n\n                        <Button\n                            variant=\"contained\"\n                            color={!globalMediaState.isVideoEnabled ? 'error' : 'primary'}\n                            onClick={toggleVideo}\n                            startIcon={globalMediaState.isVideoEnabled ? <VideoIcon /> : <VideoOffIcon />}\n                        >\n                            {globalMediaState.isVideoEnabled ? '关闭摄像头' : '开启摄像头'}\n                        </Button>\n\n                        <Button\n                            variant=\"contained\"\n                            color=\"error\"\n                            onClick={leaveMeeting}\n                            startIcon={<CallEndIcon />}\n                        >\n                            离开会议\n                        </Button>\n                    </Box>\n                </Box>\n            );\n        }\n\n        // 未连接时显示连接界面\n        return (\n            <Box className={className} sx={{\n                height: '100%',\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'center',\n                justifyContent: 'center',\n                p: 3\n            }}>\n                <Typography variant=\"h6\" gutterBottom>\n                    准备加入会议\n                </Typography>\n                <Button\n                    variant=\"contained\"\n                    color=\"primary\"\n                    onClick={connectToRoom}\n                    disabled={isConnecting}\n                    startIcon={<VideoIcon />}\n                    sx={{ mt: 2 }}\n                >\n                    加入会议\n                    {isConnecting && (\n                        <CircularProgress\n                            size={16}\n                            sx={{\n                                color: 'inherit',\n                                ml: 1\n                            }}\n                        />\n                    )}\n                </Button>\n            </Box>\n        );\n    }\n\n    // 渲染组件\n    return (\n        <Box ref={ref} sx={sx} style={style}>\n            {error ? (\n                <Alert\n                    severity=\"error\"\n                    action={\n                        <Button\n                            color=\"inherit\"\n                            size=\"small\"\n                            onClick={connectToRoom}\n                        >\n                            重试\n                        </Button>\n                    }\n                >\n                    {error}\n                </Alert>\n            ) : (\n                renderMainContent()\n            )}\n        </Box>\n    );\n}\n\n// 使用 forwardRef 导出组件\nconst MeetingRoom = forwardRef(MeetingRoomComponent);\nMeetingRoom.displayName = 'MeetingRoom';\n\nexport { MeetingRoom };\n","import { ScriptMap } from \"@market/lib\";\r\nimport { storeUtils, toProxy } from \"../../../../libs/fanfanlo\";\r\n\r\n\r\ninterface LibIndexInfo {\r\n    list: string[];\r\n}\r\nconst libIndexInfo = storeUtils.createLocalStore<LibIndexInfo>('markets-script-index-info', { defData: { list: [] }, forceReset: false });\r\nexport const lib = toProxy<ScriptMap>({});\r\n\r\nlet isInitialized = false;\r\nfunction init(){\r\n    if(isInitialized){\r\n        return;\r\n    }\r\n    isInitialized = true;\r\n}\r\nexport const marketsScriptLib = {\r\n    lib,\r\n    libIndexInfo,\r\n    init\r\n}","import { marketsDevScriptLib } from \"./markets-script-dev-lib\";\r\nimport { watchUpdates } from \"@fanfanlo\";\r\nimport { marketsScriptLib } from \"./markets-script-lib\";\r\n\r\nlet isInitialized = false;\r\nfunction init(){\r\n    if(isInitialized){\r\n        return;\r\n    }\r\n    isInitialized = true;\r\n    marketsDevScriptLib.init();\r\n    marketsScriptLib.init();\r\n    watchUpdates(marketsDevScriptLib.marketDevLibData, (data)=>{\r\n        console.log('marketsDevScriptLib.devLibInfo=', data);\r\n        const allMarktLibData = marketsDevScriptLib.marketDevLibData.allMarketLibData;\r\n        if(!allMarktLibData)return;\r\n        for(const html of allMarktLibData.htmls){\r\n            marketsScriptLib.lib[html.client.ns] = html;\r\n            \r\n        }\r\n        for(const script of allMarktLibData.resources){\r\n            marketsScriptLib.lib[script.client.ns] = script;\r\n        }\r\n    });\r\n}\r\nexport const marketsScriptManager = {\r\n    init,\r\n}\r\n","import { isInAndroid } from '../../is-in-android';\r\nimport { autoWebViewJs } from '../../AutoWebViewJs';\r\nimport { ICallAndroidReslt } from '../../WebViewJs';\r\n\r\ninterface IA11yServiceLiveInfo {\r\n  hasPermission?: boolean;\r\n  hasService?: boolean;\r\n  isAlive?: boolean;\r\n  pingTime?: number;\r\n  crashed?: boolean;\r\n}\r\n\r\nfunction getA11yServiceLiveInfo(): ICallAndroidReslt<IA11yServiceLiveInfo> {\r\n  const script = `var info =com.fanfanlo.droidlib.auto.components.webview.AutoWebViewJs.a11yModel.serviceLiveInfo;\\n var s = com.fanfanlo.lib.utils.JsonUtil.gson2.toJson(info);\\n s;`;\r\n  const info = autoWebViewJs.callScript<IA11yServiceLiveInfo>(script);\r\n  return info;\r\n}\r\n\r\nfunction hasPermission():boolean{\r\n    if(!isInAndroid())return false\r\n    const res = autoWebViewJs.onCallGetA11yPermission<boolean>()\r\n    // console.log('hasPermission', res)\r\n    return res.javaResultData as boolean\r\n\r\n    // return getA11yServiceLiveInfo().javaResultData?.hasPermission;\r\n}\r\n\r\nfunction openPermission(){\r\n    autoWebViewJs.onCallOpenA11yPermission()\r\n    // return autoWebViewJs.callScriptRunner(`com.fanfanlo.lib.permissions.FloatPermission.openPermission();`);\r\n\r\n}\r\nconst hasPermissionScript = `var bl = com.fanfanlo.droidlib.auto.service.accessibility.a11yUtils.hasServicePermission(com.fanfanlo.lib.mc.LibMainModel.Companion.instance.application, com.fanfanlo.droidlib.auto.components.webview.AutoWebViewJs.a11yModel.serviceKClass.class);\\nbl;`\r\nfunction checkPermission(){\r\n    //com.fanfanlo.lib.utils.ClassUtils.kclassToClass\r\n    // let s = `val bl = com.fanfanlo.droidlib.auto.service.accessibility.a11yUtils.hasServicePermission(com.fanfanlo.lib.mc.LibMainModel.libMainModel.application, com.fanfanlo.droidlib.auto.components.webview.AutoWebViewJs.a11yModel.serviceKClass.java);\\nbl;`\r\n    // let s = `var bl = com.fanfanlo.droidlib.auto.service.accessibility.a11yUtils.hasPermission(com.fanfanlo.droidlib.auto.components.webview.AutoWebViewJs.a11yModel.getServiceJavaClass());\\nbl;`\r\n    // let s = `var bl = com.fanfanlo.droidlib.auto.service.accessibility.a11yUtils.hasPermission(com.fanfanlo.droidlib.auto.components.webview.AutoWebViewJs.a11yModel.serviceKClass);\\nbl;`\r\n    // let s = `var bl = com.fanfanlo.droidlib.auto.service.accessibility.a11yUtils.hasServicePermission(com.fanfanlo.lib.mc.libMainModel.application, com.fanfanlo.droidlib.auto.components.webview.AutoWebViewJs.a11yModel.serviceKClass.class);\\nbl;`\r\n    // let s = `var bl = com.fanfanlo.droidlib.auto.service.accessibility.a11yUtils.hasServicePermission(com.fanfanlo.lib.mc.LibMainModel.Companion.instance.application, com.fanfanlo.droidlib.auto.components.webview.AutoWebViewJs.a11yModel.serviceKClass.class);\\nbl;`\r\n    // let s = `var bl = com.fanfanlo.droidlib.auto.service.accessibility.a11yUtils.hasServicePermission(com.fanfanlo.droidlib.auto.components.webview.AutoWebViewJs.a11yModel.serviceKClass.class);\\nbl;`\r\n    // s = `var x = com.fanfanlo.droidlib.auto.components.webview.AutoWebViewJs.a11yModel.serviceKClass;\\nx`\r\n    // let s = `var c = com.fanfanlo.lib.utils.ClassUtils.Companion.kclassToClass(com.fanfanlo.droidlib.auto.components.webview.AutoWebViewJs.a11yModel.serviceKClass);\r\n    // var bl = com.fanfanlo.droidlib.auto.service.accessibility.a11yUtils.hasServicePermission(com.fanfanlo.lib.mc.libMainModel.application, c);\r\n    // bl;`\r\n        const res = autoWebViewJs.callScript<boolean>(hasPermissionScript)\r\n        // console.log('checkPermission2222', res)\r\n        return res\r\n}\r\nexport const a11yScript = {\r\n  getA11yServiceLiveInfo,\r\n  hasPermission,\r\n  openPermission,\r\n  checkPermission,\r\n  hasPermissionScript,\r\n}","import { useTranslation } from \"@fanfanlo\"\r\n\r\nexport enum AndroidPermissionStatus{\r\n    granted = 'granted',\r\n    denied = 'denied',\r\n    shouldAskAgain = 'shouldAskAgain',\r\n}\r\nexport interface IAndroidPermission{\r\n    name:string\r\n    status:AndroidPermissionStatusType\r\n}\r\n\r\nexport interface IAndroidPermissions {\r\n    [key:string]:IAndroidPermission\r\n}\r\nexport type AndroidPermissionStatusType = AndroidPermissionStatus.granted | AndroidPermissionStatus.denied | AndroidPermissionStatus.shouldAskAgain\r\n\r\nexport const androidPermissions:IAndroidPermissions = {\r\n    a11y:{\r\n        name:\"android.permission.ACCESS_NOTIFICATION_POLICY\",\r\n        status:AndroidPermissionStatus.shouldAskAgain,\r\n    }\r\n}\r\n\r\nexport function usePermissionStatus(status:AndroidPermissionStatus){\r\n    // console.log('usePermissionStatus_fn22', status, useTranslation)\r\n    const {t} = useTranslation('app-model/mc/android-permission/content') \r\n    return t(`androidPermission.${status}`)\r\n}","import { useState } from \"react\"\r\nimport { useEffect } from \"react\"\r\nimport { tabActivity } from \".\"\r\n\r\nexport function useTabActivity() {\r\n    const [isActive, setIsActive] = useState(tabActivity.isActive)\r\n    useEffect(() => {\r\n        tabActivity.listen((bl:boolean)=>{\r\n            setIsActive(bl)\r\n        })\r\n    }, [])\r\n    return isActive\r\n}\r\n","\r\n\"use client\"\r\nimport { a11yScript, autoWebViewJs, isInAndroid } from '@droid/android';\r\nimport { AndroidPermissionStatus, usePermissionStatus } from '@app/model';\r\nimport { useTabActivity } from '@fanfanlo';\r\nimport QuestionMarkIcon from '@mui/icons-material/QuestionMark';\r\nimport { Box, Button, ClickAwayListener, Tooltip } from '@mui/material';\r\nimport { useEffect, useState } from 'react';\r\n// import { useTranslation } from 'react-i18next';s\r\nimport { useTranslation } from '@fanfanlo';\r\nimport { useRouter } from 'next/router';\r\n\r\n\r\ninterface IA11yServiceLiveInfo {\r\n  hasPermission?: boolean\r\n  hasService?: boolean\r\n  isAlive?: boolean\r\n  pingTime?: number\r\n  crashed?: boolean\r\n}\r\nexport function AccessibilityInfo() {\r\n  const { t } = useTranslation('homepage/components/permissions/accessibility/content');\r\n  const [hasPermission, setHasPermission] = useState(a11yScript.hasPermission())\r\n  const status = usePermissionStatus(hasPermission ? AndroidPermissionStatus.granted : AndroidPermissionStatus.shouldAskAgain);\r\n  const [openTooltip, setOpenTooltip] = useState(false);\r\n  const isActive = useTabActivity()  \r\n  const router =useRouter();\r\n  function onSettingClick(){\r\n    // if(!isInAndroid())return;\r\n    autoWebViewJs.onCallOpenA11yPermission()\r\n  }\r\n  useEffect(()=>{\r\n    if(!isActive)return\r\n    setHasPermission(a11yScript.hasPermission())\r\n  }, [isActive])  \r\n  useEffect(()=>{\r\n    if(!isInAndroid()){\r\n      console.log('check a11y permission in webview,but not in android')\r\n      return;\r\n    }\r\n    let script = `var info =com.fanfanlo.droidlib.auto.components.webview.AutoWebViewJs.a11yModel.serviceLiveInfo;\\n var s = com.fanfanlo.lib.utils.companion.gson2.toJson(info);\\n s;`\r\n    script = `var info =com.fanfanlo.droidlib.auto.components.webview.AutoWebViewJs.a11yModel.serviceLiveInfo;\\n var s = com.fanfanlo.lib.utils.JsonUtil.gson2.toJson(info);\\n s;`\r\n    const info = autoWebViewJs.callScript<IA11yServiceLiveInfo>(script)\r\n    const bl = a11yScript.checkPermission()\r\n  }, []);\r\n\r\n  function onDangerPageButtonClick(){\r\n    router.push('/a11y-danger')\r\n  }\r\n  return (\r\n    <Box>\r\n      <Box>\r\n        <span>{t('AccessibilityInfo.name')}</span>\r\n        <span>:</span>\r\n        <button onClick={onSettingClick}\r\n         role='button' style={{marginLeft:\"0.5rem\", marginRight:\"0.5rem\"}}>{t('AccessibilityInfo.setting')}</button>\r\n        <span>{status}</span>\r\n        <span>{hasPermission ? 'ok' : 'no'}</span>\r\n        <span style={{ paddingLeft: '1rem' }}></span>\r\n        <ClickAwayListener onClickAway={() => setOpenTooltip(false)}>\r\n          <Tooltip\r\n            disableFocusListener\r\n            disableHoverListener\r\n            disableTouchListener\r\n            title={t(\"AccessibilityInfo.dangerDesc\")}\r\n            slotProps={{\r\n              popper: {\r\n                disablePortal: true,\r\n              },\r\n            }}\r\n            open={openTooltip}\r\n            onOpen={() => setOpenTooltip(true)}\r\n            onClose={() => setOpenTooltip(false)}>\r\n            <span onMouseDown={() => setOpenTooltip(true)}>\r\n              <span>{t('AccessibilityInfo.danger')}</span>\r\n              <span></span>\r\n              <span>\r\n                <QuestionMarkIcon fontSize=\"small\" sx={{ verticalAlign: 'sub' }} />\r\n              </span>\r\n              <span style={{color:\"red\"}}>\r\n                <Button onClick={onDangerPageButtonClick}>警告</Button>\r\n              </span>\r\n            </span>\r\n          </Tooltip>\r\n        </ClickAwayListener>\r\n      </Box>\r\n    </Box>\r\n  );\r\n}\r\n","import { PropsWithChildren, ReactNode, useState } from \"react\";\r\nimport { useTranslation } from '@fanfanlo';\r\nimport styles from './components.module.scss';\r\nimport { Tooltip } from \"@mui/material\";\r\nimport { ClickAwayListener } from \"@mui/material\";\r\nimport QuestionMarkIcon from '@mui/icons-material/QuestionMark';\r\nexport function PermissionCommonSetting(){\r\n    const {t} = useTranslation('homepage/components/permissions/components/content');\r\n    return <span className={styles.permissionComponentsSpanPadding}>\r\n        <button>\r\n        <span>{t('Components.setting')}</span>\r\n    </button>\r\n    </span>\r\n}\r\n\r\nexport function PermissionCommonNotPass(){\r\n    const {t} = useTranslation('homepage/components/permissions/components/content');\r\n    return <>\r\n        <span className={styles.permissionComponentsSpanPadding}>{t('Components.notPass')}</span>\r\n    </>\r\n}\r\n\r\nexport function PermissionCommonPass(){\r\n    const {t} = useTranslation('homepage/components/permissions/components/content');\r\n    return <>\r\n        <span className={styles.permissionComponentsSpanPadding}>{t('Components.pass')}</span>\r\n    </>\r\n}\r\n\r\n\r\nexport function PermissionCommonDanger({desc}:{desc:ReactNode}&PropsWithChildren){\r\n    const {t} = useTranslation('homepage/components/permissions/components/content');\r\n    \r\n  const [openTooltip, setOpenTooltip] = useState(false);\r\n    return(\r\n        <span className={styles.danger}>\r\n        <ClickAwayListener onClickAway={() => setOpenTooltip(false)}>\r\n          <Tooltip\r\n            disableFocusListener\r\n            disableHoverListener\r\n            disableTouchListener\r\n            title={desc}\r\n            slotProps={{\r\n              popper: {\r\n                disablePortal: true,\r\n              },\r\n            }}\r\n            open={openTooltip}\r\n            onOpen={() => setOpenTooltip(true)}\r\n            onClose={() => setOpenTooltip(false)}>\r\n            <span onMouseDown={() => setOpenTooltip(true)}>\r\n              \r\n        <span>{t('Components.danger')}</span>\r\n              <span></span>\r\n              <span>\r\n                <QuestionMarkIcon fontSize=\"small\" sx={{ verticalAlign: 'sub' }} />\r\n              </span>\r\n            </span>\r\n          </Tooltip>\r\n        </ClickAwayListener>\r\n        </span>\r\n    )\r\n}\r\n\r\nexport function PermissionCommonName({children}:PropsWithChildren){\r\n    return (\r\n        <span>{children}</span>\r\n    )\r\n}\r\n\r\nexport function PermissionCommonDesc({children}:PropsWithChildren){\r\n    return (\r\n        <span>{children}</span>\r\n    )\r\n}\r\n\r\n","import { autoWebViewJs } from \"../../AutoWebViewJs\"\r\n\r\n\r\nfunction hasPermission(){\r\n    let script = `var bl = com.fanfanlo.lib.permissions.FloatPermission.hasPermission();\\n bl;`\r\n    let res = autoWebViewJs.callScript<boolean>(script);\r\n    return res.javaResultData as boolean\r\n}\r\n\r\nfunction openPermission(){\r\n    let script = `var bl = com.fanfanlo.lib.permissions.FloatPermission.openPermission();\\n bl;`\r\n    let res = autoWebViewJs.callScript<boolean>(script);\r\n    return res.javaResultData as boolean\r\n}\r\n\r\nexport const floatingInfo = {\r\n    hasPermission,\r\n    openPermission\r\n}\r\n","import { useTranslation } from '@fanfanlo';\r\nimport { PermissionCommonDanger, PermissionCommonName, PermissionCommonNotPass, PermissionCommonPass, PermissionCommonSetting } from '../components/Components';\r\nimport { useEffect, useState } from 'react';\r\nimport { floatingInfo } from '@droid/android';\r\nimport { tabActivity } from '@fanfanlo';\r\nexport function FloatingInfo(){\r\n    const {t} = useTranslation('homepage/components/permissions/floating/content');\r\n    const [hasPermission, setHasPermission] = useState(floatingInfo.hasPermission());\r\n    useEffect(()=>{\r\n        const unlisten = tabActivity.listen((activity)=>{\r\n            setHasPermission(floatingInfo.hasPermission());\r\n        })  \r\n        return ()=>{\r\n            unlisten();\r\n        }\r\n    }, []);\r\n    return <div>\r\n        <PermissionCommonName>{t('FloatingInfo.name')}</PermissionCommonName>\r\n        <span onClick={()=>{\r\n            floatingInfo.openPermission();\r\n        }}>\r\n            <PermissionCommonSetting />\r\n        </span>\r\n        {hasPermission ? <PermissionCommonPass/> : <PermissionCommonNotPass/>}\r\n        <PermissionCommonDanger desc={t('FloatingInfo.dangerDesc')} />\r\n    </div>\r\n}\r\n","import { Box } from \"@mui/material\";\r\nimport { AccessibilityInfo } from \"../accessibility/AccessibilityInfo\";\r\nimport { FloatingInfo } from \"../floating/FloatingInfo\";\r\nexport function HomePagePermissions(){\r\n    return (<Box>\r\n        <AccessibilityInfo />   \r\n        <FloatingInfo />\r\n    </Box>)\r\n}","import { AppShell, TabbarContainer } from \"@app/ui\";\r\nimport { ProjectsUI } from \"@droid/project\";\r\nimport { i18nInit, IFrameReactContainer, toProxy, watchUpdates } from \"@fanfanlo\";\r\nimport { Box } from \"@mui/material\";\r\nimport { OpenA11yNodeButton } from \"@src/components/a11y/open-a11y-node-button\";\r\nimport { AndroidSettingsInfo } from \"@src/components/android-settings/AndroidSettingsInfo\";\r\nimport { KillSelf } from \"@src/components/app/kill-self/KillSelf\";\r\nimport { AddExternalMarketButton } from \"@src/components/markets/AddExternalMarketButton\";\r\nimport { MainPageAddButtons } from \"@src/components/markets/main-page-add-buttons/MainPageAddButtons\";\r\nimport { MarketsDevSettingsLineOpenLinkButton } from \"@src/components/page/markets-dev-settings/open-link-button/OpenLinkButton\";\r\nimport { SendSms } from \"@src/components/scripts/send-sms/SendSms\";\r\nimport { SmsScriptItemComponent } from \"@src/components/test/SmsScriptItemComponent\";\r\nimport { IMOpenPageLink } from \"@src/im/components/page-links/PageLinks\";\r\nimport { MeetingRoom } from \"@src/livekit-meeting/MeetingRoom.new\";\r\nimport { marketHtmlUtils } from \"@src/markets/market-html-utils\";\r\nimport { marketsScriptManager } from \"@src/markets/markets-script-manager\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { HomePagePermissions } from \"../../components/permissions/home-page-permissions/HomePagePermissions\";\r\nimport { TestScript } from \"./test-script\";\r\n\r\ni18nInit()\r\nexport default function Home() {\r\n   \r\n    return (\r\n        <AppShell>\r\n            <TabbarContainer titleConf={{ ns: \"homepage/pages/home/content\", key: \"home.title\" }}>\r\n                {/* {isDev ? <Content /> : <ProdContent />} */}\r\n                <Content />\r\n                {/* <EmergencyCallContent /> */}\r\n            </TabbarContainer>\r\n        </AppShell>\r\n    )\r\n}\r\n\r\n\r\nfunction EmergencyCallContent(){\r\n\r\n    return(\r\n        <Box>\r\n            \r\n            <MeetingRoom roomName=\"test-room\" userName={`user-${Math.random().toString(36).substring(2, 8)}`} />\r\n\r\n            <IMOpenPageLink />\r\n            <IFrameReactContainer url=\"/scripts/fanfanlo/scripts/emergency-alarm/index.js\" urlAsContent={true} htmlBuilder={marketHtmlUtils.createHtml} />\r\n        </Box>\r\n    )\r\n}\r\n\r\nfunction test() {\r\n    const s = `var script1=function(n){\"use strict\";return function(){function v(){return new Date().getTime()}var u={exports:{}},e={};/**\r\n * @license React\r\n * react-jsx-runtime.production.js\r\n *\r\n * Copyright (c) Meta Platforms, Inc. and affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */var c=Symbol.for(\"react.transitional.element\"),d=Symbol.for(\"react.fragment\");function s(T,t,r){var i=null;if(r!==void 0&&(i=\"\"+r),t.key!==void 0&&(i=\"\"+t.key),\"key\"in t){r={};for(var o in t)o!==\"key\"&&(r[o]=t[o])}else r=t;return t=r.ref,{$$typeof:c,type:T,key:i,ref:t!==void 0?t:null,props:r}}e.Fragment=d,e.jsx=s,e.jsxs=s,u.exports=e;var l=u.exports;function a(){return l.jsx(\"div\",{children:l.jsx(\"button\",{children:\"html生成的按钮\"})})}const x={UI:a};function E(){return v()}n.components=x,n.printA=E,Object.defineProperty(n,Symbol.toStringTag,{value:\"Module\"})}(),n}({}); return script1;`\r\n    const o = new Function(s)()\r\n    o.printA();\r\n    // console.log('cccccccccccccccomponents=', o.components)\r\n    return o;\r\n}\r\n\r\nfunction Content() {\r\n    const [ui, setUI] = useState(null)\r\n    useEffect(() => {\r\n        if (typeof window !== 'undefined') {\r\n            // console.log('has window', document.domain);\r\n            // document.domain = window.location.hostname;\r\n            // console.log('domain is', document.domain);\r\n            ; (window as any).sayHello = function (msg: string) {\r\n                alert('child' + msg)\r\n            }\r\n            console.log('window say=', (window as any).sayHello)\r\n        }\r\n        setTimeout(() => {\r\n            setUI(test().components.UI())\r\n        }, 1000 * 5)\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        marketsScriptManager.init();\r\n    }, []);\r\n    return (\r\n        <Box >\r\n            {/* <ProjectIFrame /> */}\r\n            <MeetingRoom roomName=\"test-room\" userName={`user-${Math.random().toString(36).substring(2, 8)}`} />\r\n\r\n            <IMOpenPageLink />\r\n            <SendSms />\r\n            <AndroidSettingsInfo />\r\n            <SmsScriptItemComponent />\r\n            <AddExternalMarketButton />\r\n            {/* {o.components.UI()} */}\r\n            {ui}\r\n            <HomePagePermissions />\r\n            <IFrameReactContainer url=\"/scripts/fanfanlo/scripts/emergency-alarm/index.js\" urlAsContent={true} htmlBuilder={marketHtmlUtils.createHtml} />\r\n            <IFrameReactContainer url=\"/scripts/fanfanlo/scripts/emergency-alarm/index.js\" urlAsContent={true} htmlBuilder={marketHtmlUtils.createHtml} />\r\n            {/* <IFrameReactContainer url=\"/scripts/fanfanlo/scripts/emergency-alarm/index.js\" urlAsContent={true} htmlBuilder={marketHtmlUtils.createHtml} />\r\n            <IFrameReactContainer url=\"/scripts/fanfanlo/scripts/emergency-alarm/index.js\" urlAsContent={true} htmlBuilder={marketHtmlUtils.createHtml} />\r\n            <IFrameReactContainer url=\"/scripts/fanfanlo/scripts/emergency-alarm/index.js\" urlAsContent={true} htmlBuilder={marketHtmlUtils.createHtml} />\r\n            <IFrameReactContainer url=\"/scripts/fanfanlo/scripts/emergency-alarm/index.js\" urlAsContent={true} htmlBuilder={marketHtmlUtils.createHtml} />\r\n            <IFrameReactContainer url=\"/scripts/fanfanlo/scripts/emergency-alarm/index.js\" urlAsContent={true} htmlBuilder={marketHtmlUtils.createHtml} />\r\n            <IFrameReactContainer url=\"/scripts/fanfanlo/scripts/emergency-alarm/index.js\" urlAsContent={true} htmlBuilder={marketHtmlUtils.createHtml} /> */}\r\n\r\n            {/* <IframeResizer offsetSize={3} bodyMargin=\"0px\" bodyPadding=\"0px\" style={{width:'100%'}}\r\n            src=\"http://192.168.177.180:3000/tools-test/webview-version.html\" /> */}\r\n\r\n            {/* <IframeResizer offsetSize={3} bodyMargin=\"0px\" bodyPadding=\"0px\" style={{width:'100%'}}\r\n            src=\"https://baidu.com\" /> */}\r\n            <Box>\r\n                <OpenA11yNodeButton />\r\n            </Box>\r\n            <TestScript />\r\n            <Box>\r\n                <KillSelf />\r\n            </Box>\r\n            <MarketsDevSettingsLineOpenLinkButton />    \r\n            <MainPageAddButtons />\r\n            {/* <IFrameReactContainer url=\"http://192.168.177.180:5173/pages/accessibility-pn-an-info/#\" /> */}\r\n            {/* <IFrameReactContainer url=\"http://192.168.177.180:5173/pages/market1/\" /> */}\r\n            <ProjectsUI />\r\n\r\n            {/* <div>isInAndroid:{isInAndroid().toString()}</div>\r\n            <div>count:{count}</div> */}\r\n            <div>\r\n            </div>\r\n        </Box>\r\n\r\n    )\r\n}\r\n\r\n","export enum ScriptType {\r\n    // 只有一个脚本执行文件，它只在脚本列表里显示。\r\n    // 如果要修改或者配置参数，它可以嵌入到自己的代码里\r\n    // 或者提供新的页面路径，用router的方式打开\r\n    // 例如router.go({url:'/script-setting', script:'function(){//code is here}', pagePath:'/all-script-setting/#your-namespace/script/script001'})\r\n    // all-script-setting所有第三方统一页面\r\n    // your-namespace 第三方自己的命名空间\r\n    // url 第三方自己的js文件url，它和script二选一，优先script。\r\n    // script 第三方自己纯代码的脚本\r\n    // url可以设置为实时更新版本，script可以作为stable版本使用。\r\n    // script001 第三方自己的脚本名称\r\n    // pagePath可以挂载到你指定的路径下\r\n    Script = 'script',\r\n    Market = 'market'\r\n}\r\nexport enum WatchResourceType {\r\n    // 这是一个js文件，加载后直接套在iframe里用即可\r\n    Js = 'js',\r\n    // 这是一个html文件，直接当html加载到iframe里即可.\r\n    Html = 'html'\r\n}\r\n\r\nexport enum IMarketDevConnectEventType{\r\n    getAllScripts = 'getAllScripts'\r\n}\r\n// client用socket向server发送的消息，也就是安卓端或者是安卓端的网页向server发送的消息\r\nexport enum IMarketDevClientEmitEventType{\r\n    init = 'init'\r\n}\r\n// server用socket向安卓端发送的消息（本地调试也可以认为是向安卓的网页发送消息）\r\nexport enum IMarketDevServerEventType{\r\n    update = 'update',\r\n}\r\n\r\n// export interface IMarketDevFileUpdateEventData{\r\n//     filePath:string,\r\n//     conf:IClientWatchFile\r\n// }\r\n\r\nexport interface IMarketDevFileUpdateEvent extends IMarketDevEvent<IAndroidWatchFile>{\r\n    type: IMarketDevServerEventType.update,\r\n    data:IAndroidWatchFile\r\n}\r\n\r\nexport interface IMarketDevGetAllEventData{\r\n    resources:IAndroidWatchFile[]\r\n    htmls:IAndroidWatchFile[]\r\n}\r\nexport interface IMarketDevGetAllEvent extends IMarketDevEvent<IMarketDevGetAllEventData>{\r\n    type: IMarketDevConnectEventType.getAllScripts,\r\n    data:IMarketDevGetAllEventData\r\n}\r\nexport type IMarketDevEventType = IMarketDevConnectEventType | IMarketDevClientEmitEventType | IMarketDevServerEventType;\r\nexport interface IMarketDevEvent<T>{\r\n    type: IMarketDevEventType,\r\n    data:T\r\n}\r\ntype NamespaceType = string;\r\nexport interface IScriptFile{\r\n\r\n    // 命名空间 用于识别唯一对象\r\n    // 每个用户用自己的用户名做命名空间\r\n    // 例如\r\n    // 0xFF336699/e-commerce\r\n    ns:NamespaceType\r\n    resourceType:WatchResourceType\r\n    scriptType:ScriptType\r\n    // 通过网络加载的路径\r\n    url?:string;\r\n}\r\n\r\nexport interface IClientWatchFile extends IScriptFile{\r\n    // 本地加载的路径\r\n    path:string;\r\n    //是否是ui模式输出，如果是ui模式输出则需要export {ScriptItem, MarketItem, MarketPage}当中之一或全部。\r\n    // isUi:boolean\r\n}\r\nexport interface IClientScriptConf extends IClientWatchFile{\r\n}\r\n\r\nexport interface IClientHtmlConf extends IClientWatchFile{\r\n    resourcesPath:string\r\n    resourcesUrl:string\r\n}\r\n\r\nexport interface IAndroidWatchFile{\r\n    client:IClientWatchFile\r\n    content:string\r\n}\r\n\r\n// 脚本文件map，这里是打散的，并没有按照开发者的ns分类，而是按照文件名分类\r\n// 也就是文件名当作分类了。开发者有个ns，但是一个开发者可以开发n个market\r\n// 所以用开发者的ns做限定是不够用的，现在想的是开发者ns+market or script做market的限定\r\n// 所以这个ns应该是：\r\n// `${developerNs}/markets/${market}`\r\n// `${developerNs}/markets/${market}/${script}`\r\n// `${developerNs}/scripts/${script}`\r\n// 这种格式，回头可以用分段的方式来截取对象\r\nexport type ScriptMap = Record<NamespaceType, IAndroidWatchFile>;","import to from \"await-to-js\";\r\nimport { Manifest } from \"../../android/components/Manifest\";\r\nimport { runPermissionGroup } from \"../../android/components/permissionGroupCreator\";\r\nimport { createWindowConfCopy } from \"../../android/win/WindowConf\";\r\nimport { WebViewJs } from \"../../android/WebViewJs\";\r\nimport { env } from \"../../confs/env\";\r\n\r\n\r\nfunction createCopy(callbackEventType:string, windowId:string){\r\n    let windowConf = {\r\n        htmlConf:{\r\n            url:`${env.htmlOrigin}pages/accessibility-info-buttons/#/`,\r\n            webViewJsParams:{\r\n                javaToJsDataString:JSON.stringify({event:callbackEventType})\r\n            }\r\n        },windowId\r\n    }\r\n    return createWindowConfCopy(windowConf)\r\n}\r\n\r\nfunction openWindow(callbackEventType:string, windowId:string){\r\n    let conf = createCopy(callbackEventType, windowId);\r\n    return WebViewJs.instance.createWindow(JSON.stringify(conf))\r\n}\r\nexport async function openHtmlShowA11yNodeInfoButton(callbackEventType:string, windowId:string){\r\n    let [err, group] = await to(runPermissionGroup(Manifest.Permission.SYSTEM_ALERT_WINDOW,\r\n        Manifest.Permission.BIND_ACCESSIBILITY_SERVICE))\r\n    if(err){\r\n        alert(err.toString())\r\n        WebViewJs.instance.toast(err.toString())\r\n        // showSimpleToast(err.toString())\r\n        return;\r\n    }\r\n    return openWindow(callbackEventType, windowId);\r\n}"],"names":["autoJsStoreUtils","storeUtils","toProxy","IMarketDevConnectEventType","IMarketDevServerEventType","WatchResourceType","marketsDevSocket","marketDevLibData","devLibInfo","getMarketScriptDataNsPrefix","createMarketScriptDataNsPath","ns","writeNsAllFiles","files","nsPath","oldFiles","read","name","Object","keys","index","indexOf","splice","content","write","removeFile","writeFile","readNsAllFiles","readFile","getAllMarkets","listenDev","dispatcher","addListener","getAllScripts","onGetAllScript","update","onFileUpdate","data","allMarketLibData","client","resourceType","Html","html","htmls","path","Js","resources","length","script","console","log","isInitialized","init","getNamespaceStoreWithData","defData","forceReset","marketsDevScriptLib","createDefSocketSettingData","keepConnect","url","res","getMarketDevSocketSettingData","Button","axios","parseUsedLib","s","reg","r","matchAll","a","push","beforeJavaLibCreateScript","TestScript","onClick","runProjectScriptDemo","get","scriptString","dependencies","concat","createHtml","opts","iframeId","mergeHtml","h","includes","replace","createHtmlByUrl","fetch","text","marketHtmlUtils","createContext","useContext","useEffect","useState","projectDataToUniqueId","StorePageContext","watchUpdates","_","ProjectContext","TriggerActionGroupContext","TriggerActionContext","TriggerGroupContext","TriggerListContext","TriggerContext","ActionGroupContext","ActionListContext","ActionContext","GroupContext","GroupCheckList2Context","GroupCheckList1Context","useProjectUniqueKeyValue","initProjectInfoFn","key","defValue","projectInfo","store","uniqueKey","value","_setValue","setValue","v","set","isObject","info","SocketConnectStatusEnum","Dispatcher","isValidWebSocketURL","socketConnectInfo","status","disconnected","retryCount","ws","connect","connecting","w","WebSocket","onopen","connected","toGetAllScripts","onclose","arguments","checkNeedRetry","onerror","close","onmessage","e","event","JSON","parse","type","dispatch","error","send","stringify","undefined","settingData","setTimeout","disconnect","createProjectDefultData","projectStore","useTranslation","useRouter","CreateProjectButton","t","router","onCreateProjectClick","project","addDraft","id","prefetch","span","data-id","data-typeof-create-project-id","projectUtils","getProjectName","localName","slice","ButtonConfirm","Box","DeleteProjectButton","projectId","handleDelete","deleteProject","style","textAlign","color","br","title","onConfirm","childToProjectDataUtils","Grid2","ProjectName","edit","shallow","container","spacing","sx","width","size","getProjectElementsId","data-listof-project-list-edit-btn-id","ProjectUI","Provider","backgroundColor","padding","List","ListItem","ProjectsTitle","div","h4","ProjectList","projects","map","Projects","setProjects","getListCopy","unsub","list","ProjectsUI","androidDispatchers","autoWebViewJs","openHtmlShowA11yNodeInfoButton","useProxyWatch","ulid","opened","eventType","selectEventIndex","shellListen","WebViewJsDispatcher","onSelectNode","clear","clipboardSetText","shellRemoveListen","Window","exitWindowIndex","exitWebviewJsIndex","removeListen","parseInt","windowId","et","javaResultString","errMsg","listen","Error","OpenA11yNodeButton","disabled","Modal","AndroidSettingsInfo","permissions","setPermissions","open","setOpen","onSettingClick","callScript","handleClose","javaResultData","onClose","bgcolor","p","ul","i","li","wordBreak","wordWrap","appKillSelf","toast","KillSelf","success","Promise","AddExternalMarketButton","React","Menu","MenuItem","AddIcon","MainPageAddButtons","anchorEl","setAnchorEl","Boolean","handleClick","currentTarget","menuItems","variant","startIcon","item","MarketsDevSettingsOpenLinkButton","bl","MarketsDevSettingsLineOpenLinkButton","mt","mb","Stack","TextField","Select","FormControl","InputLabel","isValidPhoneNumber","parsePhoneNumber","getCountryCallingCode","COUNTRY_LIST","code","runSendSmsScript","msg","targetNumber","senderNumber","simSlot","validatePhoneNumber","input","defaultCountry","number","trim","startsWith","phoneNumber","isValid","SendSms","setMsg","setTargetNumber","setSenderNumber","country","setCountry","targetNumberError","setTargetNumberError","senderNumberError","setSenderNumberError","handleTargetNumberChange","target","handleSenderNumberChange","sendSms","direction","className","labelId","label","onChange","helperText","multiline","rows","isRealInAndroid","Manifest","Dialog","v4","uuidv4","getScript","Permission","RECEIVE_SMS","READ_SMS","READ_PHONE_STATE","READ_PHONE_NUMBERS","localStorage","READ_CALL_LOG","getItem","nsMobilePathKey","nsSendSmsUrlKey","nsEmailKey","resendAipUrl","nsResendAuthKey","scriptId","isRunningScript","stopScript","getScriptConf","injects","onlyRunSingle","stopPrevIfOnlyRunSingle","runnerResult","testUrl","str","urlPattern","test","u","URL","parts","hostname","split","some","href","testResendAuth","auth","testEmail","email","nsResendUrlKey","readSmsUrl","defSendSmsUrl","setItem","resendUrl","defResendAuth","defEmail","defMobilePathKey","prefix","SmsScriptItemComponent","isRunning","setIsRunning","openSetting","setOpenSetting","sendSmsUrl","setSendSmsUrl","resendAuth","setResendAuth","setEmail","mobilePathKey","setMobilePathKey","callOpenSetting","reloadSmsUrl","reloadResendAuth","reloadEmail","onMobilePathKeyChange","onSendSmsUrlChange","removeItem","onResendAuthChange","onEmailChange","onRunScriptClick","callScriptByConf","checkIsRunning","onStopClick","isRun","onCfButtonClick","onUrlClick","onUpstashButtonClick","onResendClick","stopPropagation","preventDefault","onMobilePathKeyClick","testSendEmail","method","headers","body","sender","time","Date","now","receiver","slot","json","testSendSms","k","onTestSendClick","m","height","border","borderRadius","b","aria-label","required","fullWidth","placeholder","MessageIcon","IconButton","IMOpenPageLink","useCallback","useRef","forwardRef","Room","RoomEvent","RemoteParticipant","RemoteTrack","Track","createLocalAudioTrack","createLocalVideoTrack","Typography","Grid","Alert","CircularProgress","Mic","MicIcon","MicOff","MicOffIcon","Videocam","VideoIcon","VideocamOff","VideoOffIcon","CallEnd","CallEndIcon","Refresh","RefreshIcon","Log","mainModel","logger","uiLogger","sub","VIDEO_PRESET","frameRate","maxBitrate","getTokenEndpoint","appConfig","livekit","jwt","MeetingRoomComponent","ref","roomName","userName","onDisconnect","onError","globalMediaState","setGlobalMediaState","isAudioEnabled","isVideoEnabled","roomRef","localTracksRef","videoElements","audioElements","participantStates","setParticipantStates","isUnmountedRef","isConnecting","setIsConnecting","hasConnected","setHasConnected","setError","isMuted","setIsMuted","setIsVideoEnabled","participants","setParticipants","fetchToken","identity","response","room_name","ok","token","connectToRoom","audioTrack","videoTrack","createLocalTracks","current","room","adaptiveStream","dynacast","videoCaptureDefaults","resolution","publishDefaults","dtx","red","forceStereo","simulcast","setupRoomListeners","wsUrl","autoSubscribe","all","localParticipant","publishTrack","publishError","remoteParticipants","Array","from","values","updateParticipantState","forEach","participant","initParticipantState","getTrackPublications","publication","track","handleTrackSubscribed","cleanupTracks","echoCancellation","noiseSuppression","autoGainControl","tracks","stop","detach","trackElementsRef","videoElementsRef","audioElementsRef","state","prev","isAudioEnabledGlobal","isVideoEnabledGlobal","isVideoTrack","kind","Kind","Video","updateTrackState","stateUpdate","Audio","on","participantExists","off","eventHandlers","participantConnected","handleTrackPublished","once","trackPublications","participantDisconnected","newParticipants","filter","trackSubscribed","reason","reasonStr","toString","reconnecting","reconnected","Disconnected","Reconnecting","Reconnected","ParticipantConnected","ParticipantDisconnected","TrackSubscribed","leaveMeeting","el","remove","cleanup","isUnmounting","find","updateGlobalMediaState","audioEnabled","videoEnabled","toggleMute","newGlobalAudioState","unmute","mute","toggleVideo","newGlobalVideoState","handleLocalMuteToggle","newMutedState","handleLocalVideoToggle","newVideoState","getParticipantState","pub","handleToggleAudio","currentState","handleToggleVideo","getEffectiveMediaState","participantId","ParticipantVideo","memo","isLocal","videoRef","setVideoTrack","videoPublication","handleTrackUnsubscribed","TrackUnsubscribed","videoElement","firstChild","removeChild","attach","aspectRatio","display","alignItems","justifyContent","position","video","autoPlay","playsInline","muted","objectFit","top","left","right","bottom","fontSize","fontWeight","charAt","toUpperCase","ParticipantAudio","audioRef","setAudioTrack","audioPublication","audioElement","audio","renderParticipant","effectiveState","overflow","boxShadow","gap","flexDirection","severity","renderMainContent","flex","xs","md","borderTop","borderColor","gutterBottom","ml","action","MeetingRoom","displayName","libIndexInfo","createLocalStore","lib","marketsScriptLib","allMarktLibData","marketsScriptManager","AndroidPermissionStatus","a11yScript","isInAndroid","usePermissionStatus","useTabActivity","QuestionMarkIcon","ClickAwayListener","Tooltip","AccessibilityInfo","hasPermission","setHasPermission","granted","shouldAskAgain","openTooltip","setOpenTooltip","isActive","onCallOpenA11yPermission","checkPermission","onDangerPageButtonClick","button","role","marginLeft","marginRight","paddingLeft","onClickAway","disableFocusListener","disableHoverListener","disableTouchListener","slotProps","popper","disablePortal","onOpen","onMouseDown","verticalAlign","styles","PermissionCommonSetting","permissionComponentsSpanPadding","PermissionCommonNotPass","PermissionCommonPass","PermissionCommonDanger","desc","danger","PermissionCommonName","children","PermissionCommonDesc","floatingInfo","tabActivity","FloatingInfo","unlisten","activity","openPermission","HomePagePermissions","AppShell","TabbarContainer","i18nInit","IFrameReactContainer","Home","titleConf","Content","EmergencyCallContent","Math","random","substring","urlAsContent","htmlBuilder","o","Function","printA","ui","setUI","window","sayHello","alert","components","UI","ScriptType","IMarketDevClientEmitEventType"],"sourceRoot":"","ignoreList":[2]}